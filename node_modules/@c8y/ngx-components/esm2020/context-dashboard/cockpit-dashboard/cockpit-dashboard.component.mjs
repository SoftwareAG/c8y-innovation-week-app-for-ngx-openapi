import { Component, Inject, Optional } from '@angular/core';
import { AppStateService, gettext } from '@c8y/ngx-components';
import { COCKPIT_HOME_DASHBOARD_CONFIG, DEFAULT_COCKPIT_HOME_WIDGETS } from './cockpit-dashboard.model';
import * as i0 from "@angular/core";
import * as i1 from "@c8y/ngx-components";
import * as i2 from "../context-dashboard.component";
export class CockpitDashboardComponent {
    constructor(appState, homeDashboardConfig) {
        this.appState = appState;
        this.homeDashboardConfig = homeDashboardConfig;
        this.defaultWidgets = DEFAULT_COCKPIT_HOME_WIDGETS;
        this.dashboardName = 'home-cockpit1';
        this.pageTitle = gettext('Home');
        const config = {
            ...this.homeDashboardConfig,
            dashboardName: appState.currentApplication.value?.config?.homeDashboardName,
            userSpecific: appState.currentApplication.value?.config?.userSpecificHomeDashboard
        };
        this.applyDashboardConfig(config);
    }
    applyDashboardConfig(config) {
        if (!config) {
            return;
        }
        if (config.dashboardName) {
            this.dashboardName = config.dashboardName;
        }
        if (config.defaultWidgets) {
            this.defaultWidgets = config.defaultWidgets;
        }
        if (config.userSpecific && this.appState.currentUser.value) {
            this.dashboardName = `${this.appState.currentUser.value.userName.replace(/\./g, '__')}_${this.dashboardName}`;
        }
        if (config.pageTitle) {
            this.pageTitle = config.pageTitle;
        }
    }
}
CockpitDashboardComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.7", ngImport: i0, type: CockpitDashboardComponent, deps: [{ token: i1.AppStateService }, { token: COCKPIT_HOME_DASHBOARD_CONFIG, optional: true }], target: i0.ɵɵFactoryTarget.Component });
CockpitDashboardComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.7", type: CockpitDashboardComponent, selector: "c8y-cockpit-dashboard", ngImport: i0, template: "<c8y-title>\n  {{ pageTitle | translate }}\n</c8y-title>\n\n<c8y-context-dashboard\n  [name]=\"dashboardName\"\n  [defaultWidgets]=\"defaultWidgets\"\n  [canDelete]=\"false\"\n></c8y-context-dashboard>\n", dependencies: [{ kind: "component", type: i1.TitleComponent, selector: "c8y-title", inputs: ["pageTitleUpdate"] }, { kind: "component", type: i2.ContextDashboardComponent, selector: "c8y-context-dashboard", inputs: ["name", "childrenClasses", "context", "setTitle", "disabled", "defaultWidgets", "canCopy", "canDelete", "isLoading", "breadcrumbSettings", "showContextHelpButton", "translateWidgetTitle"] }, { kind: "pipe", type: i1.C8yTranslatePipe, name: "translate" }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.7", ngImport: i0, type: CockpitDashboardComponent, decorators: [{
            type: Component,
            args: [{ selector: 'c8y-cockpit-dashboard', template: "<c8y-title>\n  {{ pageTitle | translate }}\n</c8y-title>\n\n<c8y-context-dashboard\n  [name]=\"dashboardName\"\n  [defaultWidgets]=\"defaultWidgets\"\n  [canDelete]=\"false\"\n></c8y-context-dashboard>\n" }]
        }], ctorParameters: function () { return [{ type: i1.AppStateService }, { type: undefined, decorators: [{
                    type: Optional
                }, {
                    type: Inject,
                    args: [COCKPIT_HOME_DASHBOARD_CONFIG]
                }] }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29ja3BpdC1kYXNoYm9hcmQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vY29udGV4dC1kYXNoYm9hcmQvY29ja3BpdC1kYXNoYm9hcmQvY29ja3BpdC1kYXNoYm9hcmQuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vY29udGV4dC1kYXNoYm9hcmQvY29ja3BpdC1kYXNoYm9hcmQvY29ja3BpdC1kYXNoYm9hcmQuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzVELE9BQU8sRUFBRSxlQUFlLEVBQUUsT0FBTyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDL0QsT0FBTyxFQUVMLDZCQUE2QixFQUM3Qiw0QkFBNEIsRUFDN0IsTUFBTSwyQkFBMkIsQ0FBQzs7OztBQU1uQyxNQUFNLE9BQU8seUJBQXlCO0lBS3BDLFlBQ1UsUUFBeUIsRUFHekIsbUJBQTJDO1FBSDNDLGFBQVEsR0FBUixRQUFRLENBQWlCO1FBR3pCLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBd0I7UUFSckQsbUJBQWMsR0FBRyw0QkFBNEIsQ0FBQztRQUM5QyxrQkFBYSxHQUFHLGVBQWUsQ0FBQztRQUNoQyxjQUFTLEdBQVcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBUWxDLE1BQU0sTUFBTSxHQUFHO1lBQ2IsR0FBRyxJQUFJLENBQUMsbUJBQW1CO1lBQzNCLGFBQWEsRUFBRSxRQUFRLENBQUMsa0JBQWtCLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxpQkFBaUI7WUFDM0UsWUFBWSxFQUFFLFFBQVEsQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLEVBQUUsTUFBTSxFQUFFLHlCQUF5QjtTQUNuRixDQUFDO1FBQ0YsSUFBSSxDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFTyxvQkFBb0IsQ0FBQyxNQUE4QjtRQUN6RCxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ1gsT0FBTztTQUNSO1FBRUQsSUFBSSxNQUFNLENBQUMsYUFBYSxFQUFFO1lBQ3hCLElBQUksQ0FBQyxhQUFhLEdBQUcsTUFBTSxDQUFDLGFBQWEsQ0FBQztTQUMzQztRQUVELElBQUksTUFBTSxDQUFDLGNBQWMsRUFBRTtZQUN6QixJQUFJLENBQUMsY0FBYyxHQUFHLE1BQU0sQ0FBQyxjQUFjLENBQUM7U0FDN0M7UUFFRCxJQUFJLE1BQU0sQ0FBQyxZQUFZLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsS0FBSyxFQUFFO1lBQzFELElBQUksQ0FBQyxhQUFhLEdBQUcsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLElBQ25GLElBQUksQ0FBQyxhQUNQLEVBQUUsQ0FBQztTQUNKO1FBRUQsSUFBSSxNQUFNLENBQUMsU0FBUyxFQUFFO1lBQ3BCLElBQUksQ0FBQyxTQUFTLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQztTQUNuQztJQUNILENBQUM7O3NIQXpDVSx5QkFBeUIsaURBUTFCLDZCQUE2QjswR0FSNUIseUJBQXlCLDZEQ1p0Qyw2TUFTQTsyRkRHYSx5QkFBeUI7a0JBSnJDLFNBQVM7K0JBQ0UsdUJBQXVCOzswQkFVOUIsUUFBUTs7MEJBQ1IsTUFBTTsyQkFBQyw2QkFBNkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEluamVjdCwgT3B0aW9uYWwgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEFwcFN0YXRlU2VydmljZSwgZ2V0dGV4dCB9IGZyb20gJ0BjOHkvbmd4LWNvbXBvbmVudHMnO1xuaW1wb3J0IHtcbiAgQ29ja3BpdERhc2hib2FyZENvbmZpZyxcbiAgQ09DS1BJVF9IT01FX0RBU0hCT0FSRF9DT05GSUcsXG4gIERFRkFVTFRfQ09DS1BJVF9IT01FX1dJREdFVFNcbn0gZnJvbSAnLi9jb2NrcGl0LWRhc2hib2FyZC5tb2RlbCc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2M4eS1jb2NrcGl0LWRhc2hib2FyZCcsXG4gIHRlbXBsYXRlVXJsOiAnLi9jb2NrcGl0LWRhc2hib2FyZC5jb21wb25lbnQuaHRtbCdcbn0pXG5leHBvcnQgY2xhc3MgQ29ja3BpdERhc2hib2FyZENvbXBvbmVudCB7XG4gIGRlZmF1bHRXaWRnZXRzID0gREVGQVVMVF9DT0NLUElUX0hPTUVfV0lER0VUUztcbiAgZGFzaGJvYXJkTmFtZSA9ICdob21lLWNvY2twaXQxJztcbiAgcGFnZVRpdGxlOiBzdHJpbmcgPSBnZXR0ZXh0KCdIb21lJyk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBhcHBTdGF0ZTogQXBwU3RhdGVTZXJ2aWNlLFxuICAgIEBPcHRpb25hbCgpXG4gICAgQEluamVjdChDT0NLUElUX0hPTUVfREFTSEJPQVJEX0NPTkZJRylcbiAgICBwcml2YXRlIGhvbWVEYXNoYm9hcmRDb25maWc6IENvY2twaXREYXNoYm9hcmRDb25maWdcbiAgKSB7XG4gICAgY29uc3QgY29uZmlnID0ge1xuICAgICAgLi4udGhpcy5ob21lRGFzaGJvYXJkQ29uZmlnLFxuICAgICAgZGFzaGJvYXJkTmFtZTogYXBwU3RhdGUuY3VycmVudEFwcGxpY2F0aW9uLnZhbHVlPy5jb25maWc/LmhvbWVEYXNoYm9hcmROYW1lLFxuICAgICAgdXNlclNwZWNpZmljOiBhcHBTdGF0ZS5jdXJyZW50QXBwbGljYXRpb24udmFsdWU/LmNvbmZpZz8udXNlclNwZWNpZmljSG9tZURhc2hib2FyZFxuICAgIH07XG4gICAgdGhpcy5hcHBseURhc2hib2FyZENvbmZpZyhjb25maWcpO1xuICB9XG5cbiAgcHJpdmF0ZSBhcHBseURhc2hib2FyZENvbmZpZyhjb25maWc6IENvY2twaXREYXNoYm9hcmRDb25maWcpIHtcbiAgICBpZiAoIWNvbmZpZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChjb25maWcuZGFzaGJvYXJkTmFtZSkge1xuICAgICAgdGhpcy5kYXNoYm9hcmROYW1lID0gY29uZmlnLmRhc2hib2FyZE5hbWU7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy5kZWZhdWx0V2lkZ2V0cykge1xuICAgICAgdGhpcy5kZWZhdWx0V2lkZ2V0cyA9IGNvbmZpZy5kZWZhdWx0V2lkZ2V0cztcbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLnVzZXJTcGVjaWZpYyAmJiB0aGlzLmFwcFN0YXRlLmN1cnJlbnRVc2VyLnZhbHVlKSB7XG4gICAgICB0aGlzLmRhc2hib2FyZE5hbWUgPSBgJHt0aGlzLmFwcFN0YXRlLmN1cnJlbnRVc2VyLnZhbHVlLnVzZXJOYW1lLnJlcGxhY2UoL1xcLi9nLCAnX18nKX1fJHtcbiAgICAgICAgdGhpcy5kYXNoYm9hcmROYW1lXG4gICAgICB9YDtcbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLnBhZ2VUaXRsZSkge1xuICAgICAgdGhpcy5wYWdlVGl0bGUgPSBjb25maWcucGFnZVRpdGxlO1xuICAgIH1cbiAgfVxufVxuIiwiPGM4eS10aXRsZT5cbiAge3sgcGFnZVRpdGxlIHwgdHJhbnNsYXRlIH19XG48L2M4eS10aXRsZT5cblxuPGM4eS1jb250ZXh0LWRhc2hib2FyZFxuICBbbmFtZV09XCJkYXNoYm9hcmROYW1lXCJcbiAgW2RlZmF1bHRXaWRnZXRzXT1cImRlZmF1bHRXaWRnZXRzXCJcbiAgW2NhbkRlbGV0ZV09XCJmYWxzZVwiXG4+PC9jOHktY29udGV4dC1kYXNoYm9hcmQ+XG4iXX0=
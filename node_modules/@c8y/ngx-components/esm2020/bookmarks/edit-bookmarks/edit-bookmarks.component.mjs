import { moveItemInArray } from '@angular/cdk/drag-drop';
import { Component, HostListener, Input } from '@angular/core';
import { AlertService, gettext } from '@c8y/ngx-components';
import { IconSelectorService } from '@c8y/ngx-components/icon-selector';
import { cloneDeep } from 'lodash-es';
import { BsModalRef } from 'ngx-bootstrap/modal';
import { BookmarkService } from '../bookmarks.service';
import * as i0 from "@angular/core";
import * as i1 from "ngx-bootstrap/modal";
import * as i2 from "@c8y/ngx-components";
import * as i3 from "../bookmarks.service";
import * as i4 from "@c8y/ngx-components/icon-selector";
import * as i5 from "@angular/common";
import * as i6 from "@angular/forms";
import * as i7 from "@angular/cdk/drag-drop";
import * as i8 from "ngx-bootstrap/tooltip";
export class EditBookmarksComponent {
    constructor(bsModalRef, alertService, bookmarkService, iconSelector) {
        this.bsModalRef = bsModalRef;
        this.alertService = alertService;
        this.bookmarkService = bookmarkService;
        this.iconSelector = iconSelector;
        this.confirmRemoveColumnButtons = [
            {
                label: gettext('Cancel'),
                action: () => Promise.resolve(false)
            },
            {
                label: gettext('Delete'),
                status: 'danger',
                action: () => Promise.resolve(true)
            }
        ];
        this.result = new Promise(resolve => {
            this._close = resolve;
        });
    }
    ngOnInit() {
        this.bookmarksToUpdate = cloneDeep(this.bookmarks);
    }
    handleKeyboardEvent(event) {
        if (event.key === 'Escape') {
            this.close();
        }
    }
    close() {
        if (this.bookmarkService.updatedBookmarks) {
            this._close(this.bookmarkService.updatedBookmarks);
        }
        this.bsModalRef.hide();
    }
    async drop(event) {
        try {
            moveItemInArray(this.bookmarks, event.previousIndex, event.currentIndex);
            moveItemInArray(this.bookmarksToUpdate, event.previousIndex, event.currentIndex);
            await this.bookmarkService.updateBookmarksInStorage(this.bookmarksToUpdate);
            this.alertService.success(gettext('Bookmarks order updated.'));
        }
        catch {
            this.alertService.success(gettext('Bookmarks order failed to update.'));
        }
    }
    async updateBookmark(updatedBookmark, type) {
        try {
            this.bookmarksToUpdate = this.updateBookmarkProperty(updatedBookmark, type);
            await this.bookmarkService.updateBookmarksInStorage(this.bookmarksToUpdate);
            if (type !== 'markToRemove') {
                this.alertService.success(gettext('Bookmark updated.'));
            }
        }
        catch {
            if (type !== 'markToRemove') {
                this.alertService.warning(gettext('Bookmark update failed'));
            }
        }
    }
    updateBookmarkProperty(updatedBookmark, type) {
        const update = {
            icon: (bookmark) => ({ ...bookmark, icon: updatedBookmark.icon }),
            label: (bookmark) => ({ ...bookmark, label: updatedBookmark.label }),
            markToRemove: (bookmark) => ({ ...bookmark, markToRemove: true })
        }[type];
        return this.bookmarksToUpdate.map(bookmark => bookmark.id === updatedBookmark.id ? update(bookmark) : bookmark);
    }
    async changeBookmarkIcon(updatedBookmark) {
        try {
            const newIcon = await this.iconSelector.selectIcon();
            updatedBookmark.icon = newIcon;
            await this.updateBookmark(updatedBookmark, 'icon');
        }
        catch {
            // nothing to do
        }
    }
    async removeBookmark(poConfirm, bookmarkToDelete) {
        poConfirm.message = gettext('This action is irreversible.');
        try {
            const remove = await poConfirm.show(this.confirmRemoveColumnButtons);
            if (!remove) {
                return;
            }
            await this.updateBookmark(bookmarkToDelete, 'markToRemove');
            const bookmarkIndex = this.bookmarks.findIndex(bookmark => bookmark.id === bookmarkToDelete.id);
            if (bookmarkIndex === -1) {
                return;
            }
            this.bookmarks.splice(bookmarkIndex, 1);
            this.alertService.success(gettext('Bookmark removed.'));
        }
        catch {
            this.alertService.warning(gettext('Bookmarks deletion failed.'));
        }
    }
}
EditBookmarksComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.7", ngImport: i0, type: EditBookmarksComponent, deps: [{ token: i1.BsModalRef }, { token: i2.AlertService }, { token: i3.BookmarkService }, { token: i4.IconSelectorService }], target: i0.ɵɵFactoryTarget.Component });
EditBookmarksComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.7", type: EditBookmarksComponent, selector: "c8y-edit-bookmarks", inputs: { bookmarks: "bookmarks" }, host: { listeners: { "document:keydown": "handleKeyboardEvent($event)" } }, ngImport: i0, template: "<div class=\"viewport-modal\">\n  <div class=\"modal-header dialog-header\">\n    <i [c8yIcon]=\"'bookmark'\"></i>\n    <div\n      class=\"h4\"\n      id=\"modal-title\"\n      translate\n    >\n      Bookmarks\n    </div>\n  </div>\n  <div\n    class=\"inner-scroll\"\n    id=\"modal-body\"\n  >\n    <div class=\"p-16 text-center separator-bottom sticky-top bg-component\">\n      <p class=\"text-medium text-16\">\n        {{ 'Reorder, edit or delete bookmarks.' | translate }}\n      </p>\n    </div>\n    <c8y-list-group\n      class=\"cdk-droplist no-border-last\"\n      *ngIf=\"bookmarks.length; else emptyList\"\n      cdkDropList\n      (cdkDropListDropped)=\"drop($event)\"\n      [cdkDropListDisabled]=\"bookmarks?.length < 2\"\n    >\n      <c8y-li\n        *ngFor=\"let bookmark of bookmarks\"\n        cdkDrag\n      >\n        <c8y-li-drag-handle\n          title=\"{{ 'Drag to reorder' | translate }}\"\n          cdkDragHandle\n        >\n          <i c8yIcon=\"drag-reorder\"></i>\n        </c8y-li-drag-handle>\n        <c8y-li-icon\n          class=\"icon-24 p-relative changeIcon a-s-stretch\"\n          style=\"{{ bookmarks?.length < 2 ? 'padding-left: 16px!important' : '' }}\"\n          *ngIf=\"bookmark.icon\"\n        >\n          <i [c8yIcon]=\"bookmark.icon\"></i>\n          <button\n            class=\"btn btn-default btn-xs\"\n            [attr.aria-label]=\"'Change icon' | translate\"\n            tooltip=\"{{ 'Change icon' | translate }}\"\n            placement=\"top\"\n            container=\"body\"\n            type=\"button\"\n            [delay]=\"500\"\n            [adaptivePosition]=\"false\"\n            (click)=\"changeBookmarkIcon(bookmark)\"\n          >\n            <i c8yIcon=\"replace\"></i>\n          </button>\n        </c8y-li-icon>\n\n        <div class=\"d-flex gap-8 a-i-center\">\n          <form\n            class=\"d-flex flex-grow\"\n            name=\"bookmarksForm\"\n            #bookmarksForm=\"ngForm\"\n          >\n            <div class=\"input-group input-group-editable\">\n              <input\n                class=\"form-control fit-w\"\n                title=\"{{ bookmark.label }}\"\n                id=\"label\"\n                name=\"label\"\n                type=\"text\"\n                [(ngModel)]=\"bookmark.label\"\n                #label=\"ngModel\"\n                maxlength=\"50\"\n                [placeholder]=\"'e.g. My bookmark' | translate\"\n              />\n              <span></span>\n              <div class=\"input-group-btn\">\n                <button\n                  class=\"btn btn-primary\"\n                  title=\"{{ 'Save' | translate }}\"\n                  type=\"submit\"\n                  (click)=\"updateBookmark(bookmark, 'label'); label.control.markAsPristine()\"\n                  [disabled]=\"label.invalid\"\n                >\n                  {{ 'Save' | translate }}\n                </button>\n              </div>\n            </div>\n          </form>\n          <button\n            class=\"btn btn-dot btn-dot--danger m-l-auto\"\n            title=\"{{ 'Delete' | translate }}\"\n            container=\"body\"\n            type=\"button\"\n            (click)=\"removeBookmark(poConfirm, bookmark)\"\n          >\n            <c8y-popover-confirm\n              [title]=\"'Delete bookmark' | translate\"\n              [placement]=\"'left'\"\n              [outsideClick]=\"true\"\n              #poConfirm\n            ></c8y-popover-confirm>\n            <i c8yIcon=\"minus-circle\"></i>\n          </button>\n        </div>\n      </c8y-li>\n    </c8y-list-group>\n  </div>\n  <div class=\"modal-footer\">\n    <button\n      class=\"btn btn-default\"\n      title=\"{{ 'Cancel' | translate }}\"\n      type=\"button\"\n      (click)=\"close()\"\n    >\n      {{ 'Close' | translate }}\n    </button>\n  </div>\n</div>\n<ng-template #emptyList>\n  <c8y-ui-empty-state\n    [icon]=\"'bookmark'\"\n    [title]=\"'No bookmarks available' | translate\"\n    [subtitle]=\"\n      'Navigate to the desired page, open the right drawer and click the &quot;Add current page&quot; button.'\n        | translate\n    \"\n    [horizontal]=\"true\"\n  ></c8y-ui-empty-state>\n</ng-template>\n", dependencies: [{ kind: "component", type: i2.EmptyStateComponent, selector: "c8y-ui-empty-state", inputs: ["icon", "title", "subtitle", "horizontal"] }, { kind: "directive", type: i2.IconDirective, selector: "[c8yIcon]", inputs: ["c8yIcon"] }, { kind: "directive", type: i2.C8yTranslateDirective, selector: "[translate],[ngx-translate]" }, { kind: "directive", type: i5.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i5.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: i2.PopoverConfirmComponent, selector: "c8y-popover-confirm", inputs: ["buttons", "message", "title", "isOpen", "containerClass", "placement", "outsideClick"] }, { kind: "directive", type: i6.ɵNgNoValidate, selector: "form:not([ngNoForm]):not([ngNativeValidate])" }, { kind: "directive", type: i6.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i6.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i6.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { kind: "directive", type: i6.MaxLengthValidator, selector: "[maxlength][formControlName],[maxlength][formControl],[maxlength][ngModel]", inputs: ["maxlength"] }, { kind: "directive", type: i6.NgModel, selector: "[ngModel]:not([formControlName]):not([formControl])", inputs: ["name", "disabled", "ngModel", "ngModelOptions"], outputs: ["ngModelChange"], exportAs: ["ngModel"] }, { kind: "directive", type: i6.NgForm, selector: "form:not([ngNoForm]):not([formGroup]),ng-form,[ngForm]", inputs: ["ngFormOptions"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { kind: "component", type: i2.ListGroupComponent, selector: "c8y-list-group" }, { kind: "component", type: i2.ListItemComponent, selector: "c8y-list-item, c8y-li", inputs: ["active", "emptyActions", "collapsed", "selectable"], outputs: ["collapsedChange"] }, { kind: "component", type: i2.ListItemIconComponent, selector: "c8y-list-item-icon, c8y-li-icon", inputs: ["icon", "status"] }, { kind: "component", type: i2.ListItemDragHandleComponent, selector: "c8y-list-item-drag-handle, c8y-li-drag-handle" }, { kind: "directive", type: i7.CdkDropList, selector: "[cdkDropList], cdk-drop-list", inputs: ["cdkDropListConnectedTo", "cdkDropListData", "cdkDropListOrientation", "id", "cdkDropListLockAxis", "cdkDropListDisabled", "cdkDropListSortingDisabled", "cdkDropListEnterPredicate", "cdkDropListSortPredicate", "cdkDropListAutoScrollDisabled", "cdkDropListAutoScrollStep"], outputs: ["cdkDropListDropped", "cdkDropListEntered", "cdkDropListExited", "cdkDropListSorted"], exportAs: ["cdkDropList"] }, { kind: "directive", type: i7.CdkDrag, selector: "[cdkDrag]", inputs: ["cdkDragData", "cdkDragLockAxis", "cdkDragRootElement", "cdkDragBoundary", "cdkDragStartDelay", "cdkDragFreeDragPosition", "cdkDragDisabled", "cdkDragConstrainPosition", "cdkDragPreviewClass", "cdkDragPreviewContainer"], outputs: ["cdkDragStarted", "cdkDragReleased", "cdkDragEnded", "cdkDragEntered", "cdkDragExited", "cdkDragDropped", "cdkDragMoved"], exportAs: ["cdkDrag"] }, { kind: "directive", type: i7.CdkDragHandle, selector: "[cdkDragHandle]", inputs: ["cdkDragHandleDisabled"] }, { kind: "directive", type: i8.TooltipDirective, selector: "[tooltip], [tooltipHtml]", inputs: ["adaptivePosition", "tooltip", "placement", "triggers", "container", "containerClass", "boundariesElement", "isOpen", "isDisabled", "delay", "tooltipHtml", "tooltipPlacement", "tooltipIsOpen", "tooltipEnable", "tooltipAppendToBody", "tooltipAnimation", "tooltipClass", "tooltipContext", "tooltipPopupDelay", "tooltipFadeDuration", "tooltipTrigger"], outputs: ["tooltipChange", "onShown", "onHidden", "tooltipStateChanged"], exportAs: ["bs-tooltip"] }, { kind: "pipe", type: i2.C8yTranslatePipe, name: "translate" }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.7", ngImport: i0, type: EditBookmarksComponent, decorators: [{
            type: Component,
            args: [{ selector: 'c8y-edit-bookmarks', template: "<div class=\"viewport-modal\">\n  <div class=\"modal-header dialog-header\">\n    <i [c8yIcon]=\"'bookmark'\"></i>\n    <div\n      class=\"h4\"\n      id=\"modal-title\"\n      translate\n    >\n      Bookmarks\n    </div>\n  </div>\n  <div\n    class=\"inner-scroll\"\n    id=\"modal-body\"\n  >\n    <div class=\"p-16 text-center separator-bottom sticky-top bg-component\">\n      <p class=\"text-medium text-16\">\n        {{ 'Reorder, edit or delete bookmarks.' | translate }}\n      </p>\n    </div>\n    <c8y-list-group\n      class=\"cdk-droplist no-border-last\"\n      *ngIf=\"bookmarks.length; else emptyList\"\n      cdkDropList\n      (cdkDropListDropped)=\"drop($event)\"\n      [cdkDropListDisabled]=\"bookmarks?.length < 2\"\n    >\n      <c8y-li\n        *ngFor=\"let bookmark of bookmarks\"\n        cdkDrag\n      >\n        <c8y-li-drag-handle\n          title=\"{{ 'Drag to reorder' | translate }}\"\n          cdkDragHandle\n        >\n          <i c8yIcon=\"drag-reorder\"></i>\n        </c8y-li-drag-handle>\n        <c8y-li-icon\n          class=\"icon-24 p-relative changeIcon a-s-stretch\"\n          style=\"{{ bookmarks?.length < 2 ? 'padding-left: 16px!important' : '' }}\"\n          *ngIf=\"bookmark.icon\"\n        >\n          <i [c8yIcon]=\"bookmark.icon\"></i>\n          <button\n            class=\"btn btn-default btn-xs\"\n            [attr.aria-label]=\"'Change icon' | translate\"\n            tooltip=\"{{ 'Change icon' | translate }}\"\n            placement=\"top\"\n            container=\"body\"\n            type=\"button\"\n            [delay]=\"500\"\n            [adaptivePosition]=\"false\"\n            (click)=\"changeBookmarkIcon(bookmark)\"\n          >\n            <i c8yIcon=\"replace\"></i>\n          </button>\n        </c8y-li-icon>\n\n        <div class=\"d-flex gap-8 a-i-center\">\n          <form\n            class=\"d-flex flex-grow\"\n            name=\"bookmarksForm\"\n            #bookmarksForm=\"ngForm\"\n          >\n            <div class=\"input-group input-group-editable\">\n              <input\n                class=\"form-control fit-w\"\n                title=\"{{ bookmark.label }}\"\n                id=\"label\"\n                name=\"label\"\n                type=\"text\"\n                [(ngModel)]=\"bookmark.label\"\n                #label=\"ngModel\"\n                maxlength=\"50\"\n                [placeholder]=\"'e.g. My bookmark' | translate\"\n              />\n              <span></span>\n              <div class=\"input-group-btn\">\n                <button\n                  class=\"btn btn-primary\"\n                  title=\"{{ 'Save' | translate }}\"\n                  type=\"submit\"\n                  (click)=\"updateBookmark(bookmark, 'label'); label.control.markAsPristine()\"\n                  [disabled]=\"label.invalid\"\n                >\n                  {{ 'Save' | translate }}\n                </button>\n              </div>\n            </div>\n          </form>\n          <button\n            class=\"btn btn-dot btn-dot--danger m-l-auto\"\n            title=\"{{ 'Delete' | translate }}\"\n            container=\"body\"\n            type=\"button\"\n            (click)=\"removeBookmark(poConfirm, bookmark)\"\n          >\n            <c8y-popover-confirm\n              [title]=\"'Delete bookmark' | translate\"\n              [placement]=\"'left'\"\n              [outsideClick]=\"true\"\n              #poConfirm\n            ></c8y-popover-confirm>\n            <i c8yIcon=\"minus-circle\"></i>\n          </button>\n        </div>\n      </c8y-li>\n    </c8y-list-group>\n  </div>\n  <div class=\"modal-footer\">\n    <button\n      class=\"btn btn-default\"\n      title=\"{{ 'Cancel' | translate }}\"\n      type=\"button\"\n      (click)=\"close()\"\n    >\n      {{ 'Close' | translate }}\n    </button>\n  </div>\n</div>\n<ng-template #emptyList>\n  <c8y-ui-empty-state\n    [icon]=\"'bookmark'\"\n    [title]=\"'No bookmarks available' | translate\"\n    [subtitle]=\"\n      'Navigate to the desired page, open the right drawer and click the &quot;Add current page&quot; button.'\n        | translate\n    \"\n    [horizontal]=\"true\"\n  ></c8y-ui-empty-state>\n</ng-template>\n" }]
        }], ctorParameters: function () { return [{ type: i1.BsModalRef }, { type: i2.AlertService }, { type: i3.BookmarkService }, { type: i4.IconSelectorService }]; }, propDecorators: { bookmarks: [{
                type: Input
            }], handleKeyboardEvent: [{
                type: HostListener,
                args: ['document:keydown', ['$event']]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWRpdC1ib29rbWFya3MuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vYm9va21hcmtzL2VkaXQtYm9va21hcmtzL2VkaXQtYm9va21hcmtzLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uL2Jvb2ttYXJrcy9lZGl0LWJvb2ttYXJrcy9lZGl0LWJvb2ttYXJrcy5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQWUsZUFBZSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDdEUsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ3ZFLE9BQU8sRUFDTCxZQUFZLEVBQ1osT0FBTyxFQUdSLE1BQU0scUJBQXFCLENBQUM7QUFDN0IsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFDeEUsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUN0QyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFFakQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHNCQUFzQixDQUFDOzs7Ozs7Ozs7O0FBTXZELE1BQU0sT0FBTyxzQkFBc0I7SUFzQmpDLFlBQ1UsVUFBc0IsRUFDdEIsWUFBMEIsRUFDMUIsZUFBZ0MsRUFDaEMsWUFBaUM7UUFIakMsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixpQkFBWSxHQUFaLFlBQVksQ0FBYztRQUMxQixvQkFBZSxHQUFmLGVBQWUsQ0FBaUI7UUFDaEMsaUJBQVksR0FBWixZQUFZLENBQXFCO1FBdEIzQywrQkFBMEIsR0FBNEI7WUFDcEQ7Z0JBQ0UsS0FBSyxFQUFFLE9BQU8sQ0FBQyxRQUFRLENBQUM7Z0JBQ3hCLE1BQU0sRUFBRSxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQzthQUNyQztZQUNEO2dCQUNFLEtBQUssRUFBRSxPQUFPLENBQUMsUUFBUSxDQUFDO2dCQUN4QixNQUFNLEVBQUUsUUFBUTtnQkFDaEIsTUFBTSxFQUFFLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDO2FBQ3BDO1NBQ0YsQ0FBQztRQUVGLFdBQU0sR0FBd0IsSUFBSSxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDbEQsSUFBSSxDQUFDLE1BQU0sR0FBRyxPQUFPLENBQUM7UUFDeEIsQ0FBQyxDQUFDLENBQUM7SUFTQSxDQUFDO0lBRUosUUFBUTtRQUNOLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ3JELENBQUM7SUFHRCxtQkFBbUIsQ0FBQyxLQUFvQjtRQUN0QyxJQUFJLEtBQUssQ0FBQyxHQUFHLEtBQUssUUFBUSxFQUFFO1lBQzFCLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztTQUNkO0lBQ0gsQ0FBQztJQUVELEtBQUs7UUFDSCxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsZ0JBQWdCLEVBQUU7WUFDekMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLGdCQUFnQixDQUFDLENBQUM7U0FDcEQ7UUFDRCxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ3pCLENBQUM7SUFFRCxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQThCO1FBQ3ZDLElBQUk7WUFDRixlQUFlLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxLQUFLLENBQUMsYUFBYSxFQUFFLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUN6RSxlQUFlLENBQUMsSUFBSSxDQUFDLGlCQUFpQixFQUFFLEtBQUssQ0FBQyxhQUFhLEVBQUUsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBRWpGLE1BQU0sSUFBSSxDQUFDLGVBQWUsQ0FBQyx3QkFBd0IsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQztZQUM1RSxJQUFJLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsMEJBQTBCLENBQUMsQ0FBQyxDQUFDO1NBQ2hFO1FBQUMsTUFBTTtZQUNOLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxtQ0FBbUMsQ0FBQyxDQUFDLENBQUM7U0FDekU7SUFDSCxDQUFDO0lBRUQsS0FBSyxDQUFDLGNBQWMsQ0FDbEIsZUFBeUIsRUFDekIsSUFBNkQ7UUFFN0QsSUFBSTtZQUNGLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUMsc0JBQXNCLENBQUMsZUFBZSxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQzVFLE1BQU0sSUFBSSxDQUFDLGVBQWUsQ0FBQyx3QkFBd0IsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQztZQUM1RSxJQUFJLElBQUksS0FBSyxjQUFjLEVBQUU7Z0JBQzNCLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLENBQUM7YUFDekQ7U0FDRjtRQUFDLE1BQU07WUFDTixJQUFJLElBQUksS0FBSyxjQUFjLEVBQUU7Z0JBQzNCLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLENBQUM7YUFDOUQ7U0FDRjtJQUNILENBQUM7SUFFRCxzQkFBc0IsQ0FDcEIsZUFBeUIsRUFDekIsSUFBNkQ7UUFFN0QsTUFBTSxNQUFNLEdBQUc7WUFDYixJQUFJLEVBQUUsQ0FBQyxRQUFrQixFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsR0FBRyxRQUFRLEVBQUUsSUFBSSxFQUFFLGVBQWUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUMzRSxLQUFLLEVBQUUsQ0FBQyxRQUFrQixFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsR0FBRyxRQUFRLEVBQUUsS0FBSyxFQUFFLGVBQWUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUM5RSxZQUFZLEVBQUUsQ0FBQyxRQUFrQixFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsR0FBRyxRQUFRLEVBQUUsWUFBWSxFQUFFLElBQUksRUFBRSxDQUFDO1NBQzVFLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFUixPQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FDM0MsUUFBUSxDQUFDLEVBQUUsS0FBSyxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FDakUsQ0FBQztJQUNKLENBQUM7SUFFRCxLQUFLLENBQUMsa0JBQWtCLENBQUMsZUFBeUI7UUFDaEQsSUFBSTtZQUNGLE1BQU0sT0FBTyxHQUFHLE1BQU0sSUFBSSxDQUFDLFlBQVksQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUNyRCxlQUFlLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQztZQUMvQixNQUFNLElBQUksQ0FBQyxjQUFjLENBQUMsZUFBZSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1NBQ3BEO1FBQUMsTUFBTTtZQUNOLGdCQUFnQjtTQUNqQjtJQUNILENBQUM7SUFFRCxLQUFLLENBQUMsY0FBYyxDQUNsQixTQUFrQyxFQUNsQyxnQkFBMEI7UUFFMUIsU0FBUyxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMsOEJBQThCLENBQUMsQ0FBQztRQUU1RCxJQUFJO1lBQ0YsTUFBTSxNQUFNLEdBQUcsTUFBTSxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO1lBQ3JFLElBQUksQ0FBQyxNQUFNLEVBQUU7Z0JBQ1gsT0FBTzthQUNSO1lBRUQsTUFBTSxJQUFJLENBQUMsY0FBYyxDQUFDLGdCQUFnQixFQUFFLGNBQWMsQ0FBQyxDQUFDO1lBRTVELE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUM1QyxRQUFRLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxFQUFFLEtBQUssZ0JBQWdCLENBQUMsRUFBRSxDQUNoRCxDQUFDO1lBRUYsSUFBSSxhQUFhLEtBQUssQ0FBQyxDQUFDLEVBQUU7Z0JBQ3hCLE9BQU87YUFDUjtZQUVELElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUN4QyxJQUFJLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDO1NBQ3pEO1FBQUMsTUFBTTtZQUNOLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDLENBQUM7U0FDbEU7SUFDSCxDQUFDOzttSEFoSVUsc0JBQXNCO3VHQUF0QixzQkFBc0IsMEtDbEJuQyx1b0lBbUlBOzJGRGpIYSxzQkFBc0I7a0JBSmxDLFNBQVM7K0JBQ0Usb0JBQW9COzRMQUlyQixTQUFTO3NCQUFqQixLQUFLO2dCQWlDTixtQkFBbUI7c0JBRGxCLFlBQVk7dUJBQUMsa0JBQWtCLEVBQUUsQ0FBQyxRQUFRLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDZGtEcmFnRHJvcCwgbW92ZUl0ZW1JbkFycmF5IH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2RyYWctZHJvcCc7XG5pbXBvcnQgeyBDb21wb25lbnQsIEhvc3RMaXN0ZW5lciwgSW5wdXQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtcbiAgQWxlcnRTZXJ2aWNlLFxuICBnZXR0ZXh0LFxuICBQb3BvdmVyQ29uZmlybUJ1dHRvbnMsXG4gIFBvcG92ZXJDb25maXJtQ29tcG9uZW50XG59IGZyb20gJ0BjOHkvbmd4LWNvbXBvbmVudHMnO1xuaW1wb3J0IHsgSWNvblNlbGVjdG9yU2VydmljZSB9IGZyb20gJ0BjOHkvbmd4LWNvbXBvbmVudHMvaWNvbi1zZWxlY3Rvcic7XG5pbXBvcnQgeyBjbG9uZURlZXAgfSBmcm9tICdsb2Rhc2gtZXMnO1xuaW1wb3J0IHsgQnNNb2RhbFJlZiB9IGZyb20gJ25neC1ib290c3RyYXAvbW9kYWwnO1xuaW1wb3J0IHsgQm9va21hcmsgfSBmcm9tICcuLi9ib29rbWFyay5tb2RlbCc7XG5pbXBvcnQgeyBCb29rbWFya1NlcnZpY2UgfSBmcm9tICcuLi9ib29rbWFya3Muc2VydmljZSc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2M4eS1lZGl0LWJvb2ttYXJrcycsXG4gIHRlbXBsYXRlVXJsOiAnLi9lZGl0LWJvb2ttYXJrcy5jb21wb25lbnQuaHRtbCdcbn0pXG5leHBvcnQgY2xhc3MgRWRpdEJvb2ttYXJrc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIEBJbnB1dCgpIGJvb2ttYXJrczogQm9va21hcmtbXTtcbiAgcHJpdmF0ZSBib29rbWFya3NUb1VwZGF0ZTogQm9va21hcmtbXTtcblxuICBjb25maXJtUmVtb3ZlQ29sdW1uQnV0dG9uczogUG9wb3ZlckNvbmZpcm1CdXR0b25zW10gPSBbXG4gICAge1xuICAgICAgbGFiZWw6IGdldHRleHQoJ0NhbmNlbCcpLFxuICAgICAgYWN0aW9uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoZmFsc2UpXG4gICAgfSxcbiAgICB7XG4gICAgICBsYWJlbDogZ2V0dGV4dCgnRGVsZXRlJyksXG4gICAgICBzdGF0dXM6ICdkYW5nZXInLFxuICAgICAgYWN0aW9uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUodHJ1ZSlcbiAgICB9XG4gIF07XG5cbiAgcmVzdWx0OiBQcm9taXNlPEJvb2ttYXJrW10+ID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgdGhpcy5fY2xvc2UgPSByZXNvbHZlO1xuICB9KTtcblxuICBwcml2YXRlIF9jbG9zZTogKHZhbHVlOiBCb29rbWFya1tdKSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgYnNNb2RhbFJlZjogQnNNb2RhbFJlZixcbiAgICBwcml2YXRlIGFsZXJ0U2VydmljZTogQWxlcnRTZXJ2aWNlLFxuICAgIHByaXZhdGUgYm9va21hcmtTZXJ2aWNlOiBCb29rbWFya1NlcnZpY2UsXG4gICAgcHJpdmF0ZSBpY29uU2VsZWN0b3I6IEljb25TZWxlY3RvclNlcnZpY2VcbiAgKSB7fVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMuYm9va21hcmtzVG9VcGRhdGUgPSBjbG9uZURlZXAodGhpcy5ib29rbWFya3MpO1xuICB9XG5cbiAgQEhvc3RMaXN0ZW5lcignZG9jdW1lbnQ6a2V5ZG93bicsIFsnJGV2ZW50J10pXG4gIGhhbmRsZUtleWJvYXJkRXZlbnQoZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcbiAgICBpZiAoZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIGNsb3NlKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmJvb2ttYXJrU2VydmljZS51cGRhdGVkQm9va21hcmtzKSB7XG4gICAgICB0aGlzLl9jbG9zZSh0aGlzLmJvb2ttYXJrU2VydmljZS51cGRhdGVkQm9va21hcmtzKTtcbiAgICB9XG4gICAgdGhpcy5ic01vZGFsUmVmLmhpZGUoKTtcbiAgfVxuXG4gIGFzeW5jIGRyb3AoZXZlbnQ6IENka0RyYWdEcm9wPEJvb2ttYXJrW10+KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIG1vdmVJdGVtSW5BcnJheSh0aGlzLmJvb2ttYXJrcywgZXZlbnQucHJldmlvdXNJbmRleCwgZXZlbnQuY3VycmVudEluZGV4KTtcbiAgICAgIG1vdmVJdGVtSW5BcnJheSh0aGlzLmJvb2ttYXJrc1RvVXBkYXRlLCBldmVudC5wcmV2aW91c0luZGV4LCBldmVudC5jdXJyZW50SW5kZXgpO1xuXG4gICAgICBhd2FpdCB0aGlzLmJvb2ttYXJrU2VydmljZS51cGRhdGVCb29rbWFya3NJblN0b3JhZ2UodGhpcy5ib29rbWFya3NUb1VwZGF0ZSk7XG4gICAgICB0aGlzLmFsZXJ0U2VydmljZS5zdWNjZXNzKGdldHRleHQoJ0Jvb2ttYXJrcyBvcmRlciB1cGRhdGVkLicpKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHRoaXMuYWxlcnRTZXJ2aWNlLnN1Y2Nlc3MoZ2V0dGV4dCgnQm9va21hcmtzIG9yZGVyIGZhaWxlZCB0byB1cGRhdGUuJykpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZUJvb2ttYXJrKFxuICAgIHVwZGF0ZWRCb29rbWFyazogQm9va21hcmssXG4gICAgdHlwZToga2V5b2YgUGljazxCb29rbWFyaywgJ2ljb24nIHwgJ2xhYmVsJyB8ICdtYXJrVG9SZW1vdmUnPlxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5ib29rbWFya3NUb1VwZGF0ZSA9IHRoaXMudXBkYXRlQm9va21hcmtQcm9wZXJ0eSh1cGRhdGVkQm9va21hcmssIHR5cGUpO1xuICAgICAgYXdhaXQgdGhpcy5ib29rbWFya1NlcnZpY2UudXBkYXRlQm9va21hcmtzSW5TdG9yYWdlKHRoaXMuYm9va21hcmtzVG9VcGRhdGUpO1xuICAgICAgaWYgKHR5cGUgIT09ICdtYXJrVG9SZW1vdmUnKSB7XG4gICAgICAgIHRoaXMuYWxlcnRTZXJ2aWNlLnN1Y2Nlc3MoZ2V0dGV4dCgnQm9va21hcmsgdXBkYXRlZC4nKSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCB7XG4gICAgICBpZiAodHlwZSAhPT0gJ21hcmtUb1JlbW92ZScpIHtcbiAgICAgICAgdGhpcy5hbGVydFNlcnZpY2Uud2FybmluZyhnZXR0ZXh0KCdCb29rbWFyayB1cGRhdGUgZmFpbGVkJykpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZUJvb2ttYXJrUHJvcGVydHkoXG4gICAgdXBkYXRlZEJvb2ttYXJrOiBCb29rbWFyayxcbiAgICB0eXBlOiBrZXlvZiBQaWNrPEJvb2ttYXJrLCAnaWNvbicgfCAnbGFiZWwnIHwgJ21hcmtUb1JlbW92ZSc+XG4gICk6IEJvb2ttYXJrW10ge1xuICAgIGNvbnN0IHVwZGF0ZSA9IHtcbiAgICAgIGljb246IChib29rbWFyazogQm9va21hcmspID0+ICh7IC4uLmJvb2ttYXJrLCBpY29uOiB1cGRhdGVkQm9va21hcmsuaWNvbiB9KSxcbiAgICAgIGxhYmVsOiAoYm9va21hcms6IEJvb2ttYXJrKSA9PiAoeyAuLi5ib29rbWFyaywgbGFiZWw6IHVwZGF0ZWRCb29rbWFyay5sYWJlbCB9KSxcbiAgICAgIG1hcmtUb1JlbW92ZTogKGJvb2ttYXJrOiBCb29rbWFyaykgPT4gKHsgLi4uYm9va21hcmssIG1hcmtUb1JlbW92ZTogdHJ1ZSB9KVxuICAgIH1bdHlwZV07XG5cbiAgICByZXR1cm4gdGhpcy5ib29rbWFya3NUb1VwZGF0ZS5tYXAoYm9va21hcmsgPT5cbiAgICAgIGJvb2ttYXJrLmlkID09PSB1cGRhdGVkQm9va21hcmsuaWQgPyB1cGRhdGUoYm9va21hcmspIDogYm9va21hcmtcbiAgICApO1xuICB9XG5cbiAgYXN5bmMgY2hhbmdlQm9va21hcmtJY29uKHVwZGF0ZWRCb29rbWFyazogQm9va21hcmspOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbmV3SWNvbiA9IGF3YWl0IHRoaXMuaWNvblNlbGVjdG9yLnNlbGVjdEljb24oKTtcbiAgICAgIHVwZGF0ZWRCb29rbWFyay5pY29uID0gbmV3SWNvbjtcbiAgICAgIGF3YWl0IHRoaXMudXBkYXRlQm9va21hcmsodXBkYXRlZEJvb2ttYXJrLCAnaWNvbicpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgLy8gbm90aGluZyB0byBkb1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlbW92ZUJvb2ttYXJrKFxuICAgIHBvQ29uZmlybTogUG9wb3ZlckNvbmZpcm1Db21wb25lbnQsXG4gICAgYm9va21hcmtUb0RlbGV0ZTogQm9va21hcmtcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcG9Db25maXJtLm1lc3NhZ2UgPSBnZXR0ZXh0KCdUaGlzIGFjdGlvbiBpcyBpcnJldmVyc2libGUuJyk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVtb3ZlID0gYXdhaXQgcG9Db25maXJtLnNob3codGhpcy5jb25maXJtUmVtb3ZlQ29sdW1uQnV0dG9ucyk7XG4gICAgICBpZiAoIXJlbW92ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IHRoaXMudXBkYXRlQm9va21hcmsoYm9va21hcmtUb0RlbGV0ZSwgJ21hcmtUb1JlbW92ZScpO1xuXG4gICAgICBjb25zdCBib29rbWFya0luZGV4ID0gdGhpcy5ib29rbWFya3MuZmluZEluZGV4KFxuICAgICAgICBib29rbWFyayA9PiBib29rbWFyay5pZCA9PT0gYm9va21hcmtUb0RlbGV0ZS5pZFxuICAgICAgKTtcblxuICAgICAgaWYgKGJvb2ttYXJrSW5kZXggPT09IC0xKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5ib29rbWFya3Muc3BsaWNlKGJvb2ttYXJrSW5kZXgsIDEpO1xuICAgICAgdGhpcy5hbGVydFNlcnZpY2Uuc3VjY2VzcyhnZXR0ZXh0KCdCb29rbWFyayByZW1vdmVkLicpKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHRoaXMuYWxlcnRTZXJ2aWNlLndhcm5pbmcoZ2V0dGV4dCgnQm9va21hcmtzIGRlbGV0aW9uIGZhaWxlZC4nKSk7XG4gICAgfVxuICB9XG59XG4iLCI8ZGl2IGNsYXNzPVwidmlld3BvcnQtbW9kYWxcIj5cbiAgPGRpdiBjbGFzcz1cIm1vZGFsLWhlYWRlciBkaWFsb2ctaGVhZGVyXCI+XG4gICAgPGkgW2M4eUljb25dPVwiJ2Jvb2ttYXJrJ1wiPjwvaT5cbiAgICA8ZGl2XG4gICAgICBjbGFzcz1cImg0XCJcbiAgICAgIGlkPVwibW9kYWwtdGl0bGVcIlxuICAgICAgdHJhbnNsYXRlXG4gICAgPlxuICAgICAgQm9va21hcmtzXG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuICA8ZGl2XG4gICAgY2xhc3M9XCJpbm5lci1zY3JvbGxcIlxuICAgIGlkPVwibW9kYWwtYm9keVwiXG4gID5cbiAgICA8ZGl2IGNsYXNzPVwicC0xNiB0ZXh0LWNlbnRlciBzZXBhcmF0b3ItYm90dG9tIHN0aWNreS10b3AgYmctY29tcG9uZW50XCI+XG4gICAgICA8cCBjbGFzcz1cInRleHQtbWVkaXVtIHRleHQtMTZcIj5cbiAgICAgICAge3sgJ1Jlb3JkZXIsIGVkaXQgb3IgZGVsZXRlIGJvb2ttYXJrcy4nIHwgdHJhbnNsYXRlIH19XG4gICAgICA8L3A+XG4gICAgPC9kaXY+XG4gICAgPGM4eS1saXN0LWdyb3VwXG4gICAgICBjbGFzcz1cImNkay1kcm9wbGlzdCBuby1ib3JkZXItbGFzdFwiXG4gICAgICAqbmdJZj1cImJvb2ttYXJrcy5sZW5ndGg7IGVsc2UgZW1wdHlMaXN0XCJcbiAgICAgIGNka0Ryb3BMaXN0XG4gICAgICAoY2RrRHJvcExpc3REcm9wcGVkKT1cImRyb3AoJGV2ZW50KVwiXG4gICAgICBbY2RrRHJvcExpc3REaXNhYmxlZF09XCJib29rbWFya3M/Lmxlbmd0aCA8IDJcIlxuICAgID5cbiAgICAgIDxjOHktbGlcbiAgICAgICAgKm5nRm9yPVwibGV0IGJvb2ttYXJrIG9mIGJvb2ttYXJrc1wiXG4gICAgICAgIGNka0RyYWdcbiAgICAgID5cbiAgICAgICAgPGM4eS1saS1kcmFnLWhhbmRsZVxuICAgICAgICAgIHRpdGxlPVwie3sgJ0RyYWcgdG8gcmVvcmRlcicgfCB0cmFuc2xhdGUgfX1cIlxuICAgICAgICAgIGNka0RyYWdIYW5kbGVcbiAgICAgICAgPlxuICAgICAgICAgIDxpIGM4eUljb249XCJkcmFnLXJlb3JkZXJcIj48L2k+XG4gICAgICAgIDwvYzh5LWxpLWRyYWctaGFuZGxlPlxuICAgICAgICA8Yzh5LWxpLWljb25cbiAgICAgICAgICBjbGFzcz1cImljb24tMjQgcC1yZWxhdGl2ZSBjaGFuZ2VJY29uIGEtcy1zdHJldGNoXCJcbiAgICAgICAgICBzdHlsZT1cInt7IGJvb2ttYXJrcz8ubGVuZ3RoIDwgMiA/ICdwYWRkaW5nLWxlZnQ6IDE2cHghaW1wb3J0YW50JyA6ICcnIH19XCJcbiAgICAgICAgICAqbmdJZj1cImJvb2ttYXJrLmljb25cIlxuICAgICAgICA+XG4gICAgICAgICAgPGkgW2M4eUljb25dPVwiYm9va21hcmsuaWNvblwiPjwvaT5cbiAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBidG4teHNcIlxuICAgICAgICAgICAgW2F0dHIuYXJpYS1sYWJlbF09XCInQ2hhbmdlIGljb24nIHwgdHJhbnNsYXRlXCJcbiAgICAgICAgICAgIHRvb2x0aXA9XCJ7eyAnQ2hhbmdlIGljb24nIHwgdHJhbnNsYXRlIH19XCJcbiAgICAgICAgICAgIHBsYWNlbWVudD1cInRvcFwiXG4gICAgICAgICAgICBjb250YWluZXI9XCJib2R5XCJcbiAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgW2RlbGF5XT1cIjUwMFwiXG4gICAgICAgICAgICBbYWRhcHRpdmVQb3NpdGlvbl09XCJmYWxzZVwiXG4gICAgICAgICAgICAoY2xpY2spPVwiY2hhbmdlQm9va21hcmtJY29uKGJvb2ttYXJrKVwiXG4gICAgICAgICAgPlxuICAgICAgICAgICAgPGkgYzh5SWNvbj1cInJlcGxhY2VcIj48L2k+XG4gICAgICAgICAgPC9idXR0b24+XG4gICAgICAgIDwvYzh5LWxpLWljb24+XG5cbiAgICAgICAgPGRpdiBjbGFzcz1cImQtZmxleCBnYXAtOCBhLWktY2VudGVyXCI+XG4gICAgICAgICAgPGZvcm1cbiAgICAgICAgICAgIGNsYXNzPVwiZC1mbGV4IGZsZXgtZ3Jvd1wiXG4gICAgICAgICAgICBuYW1lPVwiYm9va21hcmtzRm9ybVwiXG4gICAgICAgICAgICAjYm9va21hcmtzRm9ybT1cIm5nRm9ybVwiXG4gICAgICAgICAgPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImlucHV0LWdyb3VwIGlucHV0LWdyb3VwLWVkaXRhYmxlXCI+XG4gICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sIGZpdC13XCJcbiAgICAgICAgICAgICAgICB0aXRsZT1cInt7IGJvb2ttYXJrLmxhYmVsIH19XCJcbiAgICAgICAgICAgICAgICBpZD1cImxhYmVsXCJcbiAgICAgICAgICAgICAgICBuYW1lPVwibGFiZWxcIlxuICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICBbKG5nTW9kZWwpXT1cImJvb2ttYXJrLmxhYmVsXCJcbiAgICAgICAgICAgICAgICAjbGFiZWw9XCJuZ01vZGVsXCJcbiAgICAgICAgICAgICAgICBtYXhsZW5ndGg9XCI1MFwiXG4gICAgICAgICAgICAgICAgW3BsYWNlaG9sZGVyXT1cIidlLmcuIE15IGJvb2ttYXJrJyB8IHRyYW5zbGF0ZVwiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxzcGFuPjwvc3Bhbj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImlucHV0LWdyb3VwLWJ0blwiPlxuICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5XCJcbiAgICAgICAgICAgICAgICAgIHRpdGxlPVwie3sgJ1NhdmUnIHwgdHJhbnNsYXRlIH19XCJcbiAgICAgICAgICAgICAgICAgIHR5cGU9XCJzdWJtaXRcIlxuICAgICAgICAgICAgICAgICAgKGNsaWNrKT1cInVwZGF0ZUJvb2ttYXJrKGJvb2ttYXJrLCAnbGFiZWwnKTsgbGFiZWwuY29udHJvbC5tYXJrQXNQcmlzdGluZSgpXCJcbiAgICAgICAgICAgICAgICAgIFtkaXNhYmxlZF09XCJsYWJlbC5pbnZhbGlkXCJcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICB7eyAnU2F2ZScgfCB0cmFuc2xhdGUgfX1cbiAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgY2xhc3M9XCJidG4gYnRuLWRvdCBidG4tZG90LS1kYW5nZXIgbS1sLWF1dG9cIlxuICAgICAgICAgICAgdGl0bGU9XCJ7eyAnRGVsZXRlJyB8IHRyYW5zbGF0ZSB9fVwiXG4gICAgICAgICAgICBjb250YWluZXI9XCJib2R5XCJcbiAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgKGNsaWNrKT1cInJlbW92ZUJvb2ttYXJrKHBvQ29uZmlybSwgYm9va21hcmspXCJcbiAgICAgICAgICA+XG4gICAgICAgICAgICA8Yzh5LXBvcG92ZXItY29uZmlybVxuICAgICAgICAgICAgICBbdGl0bGVdPVwiJ0RlbGV0ZSBib29rbWFyaycgfCB0cmFuc2xhdGVcIlxuICAgICAgICAgICAgICBbcGxhY2VtZW50XT1cIidsZWZ0J1wiXG4gICAgICAgICAgICAgIFtvdXRzaWRlQ2xpY2tdPVwidHJ1ZVwiXG4gICAgICAgICAgICAgICNwb0NvbmZpcm1cbiAgICAgICAgICAgID48L2M4eS1wb3BvdmVyLWNvbmZpcm0+XG4gICAgICAgICAgICA8aSBjOHlJY29uPVwibWludXMtY2lyY2xlXCI+PC9pPlxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvYzh5LWxpPlxuICAgIDwvYzh5LWxpc3QtZ3JvdXA+XG4gIDwvZGl2PlxuICA8ZGl2IGNsYXNzPVwibW9kYWwtZm9vdGVyXCI+XG4gICAgPGJ1dHRvblxuICAgICAgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHRcIlxuICAgICAgdGl0bGU9XCJ7eyAnQ2FuY2VsJyB8IHRyYW5zbGF0ZSB9fVwiXG4gICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgIChjbGljayk9XCJjbG9zZSgpXCJcbiAgICA+XG4gICAgICB7eyAnQ2xvc2UnIHwgdHJhbnNsYXRlIH19XG4gICAgPC9idXR0b24+XG4gIDwvZGl2PlxuPC9kaXY+XG48bmctdGVtcGxhdGUgI2VtcHR5TGlzdD5cbiAgPGM4eS11aS1lbXB0eS1zdGF0ZVxuICAgIFtpY29uXT1cIidib29rbWFyaydcIlxuICAgIFt0aXRsZV09XCInTm8gYm9va21hcmtzIGF2YWlsYWJsZScgfCB0cmFuc2xhdGVcIlxuICAgIFtzdWJ0aXRsZV09XCJcbiAgICAgICdOYXZpZ2F0ZSB0byB0aGUgZGVzaXJlZCBwYWdlLCBvcGVuIHRoZSByaWdodCBkcmF3ZXIgYW5kIGNsaWNrIHRoZSAmcXVvdDtBZGQgY3VycmVudCBwYWdlJnF1b3Q7IGJ1dHRvbi4nXG4gICAgICAgIHwgdHJhbnNsYXRlXG4gICAgXCJcbiAgICBbaG9yaXpvbnRhbF09XCJ0cnVlXCJcbiAgPjwvYzh5LXVpLWVtcHR5LXN0YXRlPlxuPC9uZy10ZW1wbGF0ZT5cbiJdfQ==
import { ChangeDetectorRef, Component, EventEmitter, Input, Output } from '@angular/core';
import { gettext } from '@c8y/ngx-components';
import { TranslateService } from '@ngx-translate/core';
import { Subject } from 'rxjs';
import { filter, takeUntil } from 'rxjs/operators';
import { Action } from '../action.enum';
import { AssetSelectorService } from './asset-selector.service';
import { GroupNode } from './group-node';
import * as i0 from "@angular/core";
import * as i1 from "@ngx-translate/core";
import * as i2 from "./asset-selector.service";
import * as i3 from "@c8y/ngx-components";
import * as i4 from "@angular/common";
import * as i5 from "ngx-bootstrap/collapse";
export class AssetSelectorNodeComponent {
    /**
     * @ignore
     */
    get expandTitle() {
        return !this.node.open ? gettext('Expand') : gettext('Collapse');
    }
    /**
     * @ignore only di
     */
    constructor(translateService, cd, assetSelectorService) {
        this.translateService = translateService;
        this.cd = cd;
        this.assetSelectorService = assetSelectorService;
        /**
         * All preselected items.
         */
        this.preselected = [];
        /**
         * Should the path be shown.
         */
        this.showPath = false;
        /**
         * Can the user select multiple assets.
         */
        this.multi = false;
        /**
         * The current path to the node.
         */
        this.view = 'tree';
        /**
         * All currently selected assets.
         */
        this.selectedItems = [];
        /**
         * Event, which indicates whether the loading of the node has completed.
         */
        this.isLoadingState = new EventEmitter();
        /**
         * Event that emits when a node is selected.
         */
        this.onSelect = new EventEmitter();
        /**
         * Event that emits when a node is deselected.
         */
        this.onDeselect = new EventEmitter();
        /**
         * @ignore
         */
        this.level = 0;
        /**
         * @ignore
         */
        this.unsubscribe$ = new Subject();
        /** sets the `btn-pending` class in the load more button */
        this.isLoading = false;
    }
    /**
     * @ignore
     */
    async ngOnInit() {
        this.breadcrumb = this.node.label;
        this.setupBreadcrumbsAndLevel(this.node);
        if (this.node instanceof GroupNode) {
            this.node.hookEvents();
        }
        // open on startup
        if (this.node.root) {
            this.click();
        }
        // used for loading and to trigger change detection when the node is no longer loading.
        if (this.node.events) {
            this.node.events
                .pipe(takeUntil(this.unsubscribe$), filter((a) => a === Action.LOADING_DONE))
                .subscribe(() => {
                this.isLoadingState.emit(false);
                this.cd.markForCheck();
            });
        }
    }
    /**
     * Opens a node.
     */
    click() {
        this.node.open = !this.node.open;
        this.node.click({ open: this.node.open });
    }
    setupBreadcrumbsAndLevel(node) {
        if (node.parents && node.parents.length) {
            const parent = node.parents[0];
            this.breadcrumb =
                this.translateService.instant(parent.label) +
                    ' > ' +
                    this.translateService.instant(this.breadcrumb);
            this.level++;
            this.setupBreadcrumbsAndLevel(parent);
        }
    }
    /**
     * Selects the node and emits a change on the parent component.
     * @param node The node to select.
     */
    selected(node) {
        if (node.mo) {
            this.updateSelection(node.mo);
            return;
        }
        this.click();
    }
    /**
     * Handles clicks on a item in Miller View.
     * @param node The node that was clicked.
     */
    millerViewClick(node) {
        node.breadcrumb = this.breadcrumb;
        if (!this.handleNextMillerViewColumn) {
            return;
        }
        const shouldHandleDefault = this.handleNextMillerViewColumn(node, this.index);
        if (shouldHandleDefault) {
            this.selected(node);
        }
    }
    /**
     * @ignore
     */
    ngOnDestroy() {
        this.unsubscribe$.next(true);
        this.unsubscribe$.complete();
    }
    isSelected() {
        if (!this.node.mo) {
            return false;
        }
        return this.assetSelectorService.getIndexOfSelected(this.preselected, this.node.mo) > -1;
    }
    isActive() {
        if (this.active && this.node.mo) {
            return this.active.mo?.id === this.node.mo.id;
        }
        return false;
    }
    isGroupSelected() {
        if (this.selectedItems.some(selectedNode => selectedNode.id === this.node.mo?.id)) {
            return true;
        }
        return false;
    }
    updateSelection(selectedMo) {
        if (!this.multi) {
            this.onDeselect.emit({ deselectMode: 'all', mo: selectedMo });
            return;
        }
        if (this.isSelected()) {
            this.onDeselect.emit({ deselectMode: 'single', mo: selectedMo });
            return;
        }
        this.onSelect.emit(selectedMo);
        this.cd.markForCheck();
    }
}
AssetSelectorNodeComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.7", ngImport: i0, type: AssetSelectorNodeComponent, deps: [{ token: i1.TranslateService }, { token: i0.ChangeDetectorRef }, { token: i2.AssetSelectorService }], target: i0.ɵɵFactoryTarget.Component });
AssetSelectorNodeComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.7", type: AssetSelectorNodeComponent, selector: "c8y-asset-selector-node", inputs: { node: "node", rootNode: "rootNode", preselected: "preselected", showPath: "showPath", multi: "multi", view: "view", index: "index", active: "active", selectedItems: "selectedItems", handleNextMillerViewColumn: "handleNextMillerViewColumn" }, outputs: { isLoadingState: "isLoadingState", onSelect: "onSelect", onDeselect: "onDeselect" }, ngImport: i0, template: "<!-- Hierarchy tree -->\n<div\n  class=\"c8y-asset-selector__item\"\n  [ngStyle]=\"{\n    'margin-left': level > 1 ? 16 + 'px' : '0'\n  }\"\n  *ngIf=\"view === 'tree'\"\n  [attr.role]=\"view === 'tree' ? 'tree' : 'list'\"\n  [ngClass]=\"{\n    'c8y-asset-selector__item--more': node?.icon === 'plus',\n    'c8y-asset-selector__item--start': level === 0\n  }\"\n>\n  <div\n    class=\"c8y-asset-selector__node\"\n    title=\"{{ breadcrumb | translate }}\"\n    *ngIf=\"node && !node.root && !node.hidden\"\n    [attr.role]=\"view === 'tree' ? 'treeitem' : 'listitem'\"\n    [ngClass]=\"{ 'c8y-asset-selector__node--open': node?.open }\"\n  >\n    <div\n      class=\"d-flex a-i-center p-t-4 p-b-4 m-r-8\"\n      *ngIf=\"node.toString() !== 'LoadMoreNode'\"\n    >\n      <label [ngClass]=\"{ 'c8y-checkbox': multi, 'c8y-radio': !multi }\">\n        <input\n          id=\"nodeLabel\"\n          [type]=\"multi ? 'checkbox' : 'radio'\"\n          (change)=\"selected(node)\"\n          [checked]=\"isSelected()\"\n          [disabled]=\"!node.groupsSelectable && node.isGroup()\"\n        />\n        <span></span>\n        <span\n          class=\"sr-only\"\n          for=\"nodeLabel\"\n          translate\n        >\n          Node label\n        </span>\n      </label>\n    </div>\n\n    <!-- group button -->\n    <button\n      class=\"c8y-asset-selector__btn text-truncate\"\n      [attr.aria-expanded]=\"!node.open\"\n      *ngIf=\"node.isGroup() || node.hasChildDevices()\"\n      (click)=\"click()\"\n    >\n      <i\n        class=\"c8y-icon c8y-icon-duocolor m-r-4 text-16\"\n        [c8yIcon]=\"node.icon\"\n        [title]=\"'Smart group' | translate\"\n        *ngIf=\"node.icon === 'c8y-group-smart'\"\n      ></i>\n      <i\n        class=\"c8y-icon c8y-icon-duocolor m-r-4 text-16\"\n        [c8yIcon]=\"node.icon\"\n        [title]=\"'Group' | translate\"\n        *ngIf=\"node.icon !== 'c8y-group-smart'\"\n      ></i>\n      <span title=\"{{ breadcrumb }}\">\n        {{ node.translateLabel ? (node.label | translate) : node.label }}\n        <!-- use just for search results to display the path -->\n        <p\n          class=\"text-truncate\"\n          *ngIf=\"showPath\"\n        >\n          <small\n            class=\"text-muted\"\n            title=\"{{ breadcrumb }}\"\n          >\n            <em>{{ breadcrumb }}</em>\n          </small>\n        </p>\n        <!-- up to here -->\n      </span>\n    </button>\n    <!-- not a group button -->\n    <button\n      class=\"flex-grow\"\n      title=\"{{ breadcrumb }}\"\n      type=\"button\"\n      *ngIf=\"!node.isGroup() && !node.hasChildDevices()\"\n      [ngClass]=\"{\n        'btn btn-default btn-sm m-b-8 d-flex j-c-center': node.icon === 'plus',\n        'c8y-asset-selector__btn text-truncate': node.icon != 'plus'\n      }\"\n      (click)=\"selected(node)\"\n    >\n      <i\n        class=\"c8y-icon c8y-icon-duocolor m-r-4 text-16\"\n        [c8yIcon]=\"node.icon\"\n        [title]=\"'Smart group' | translate\"\n        *ngIf=\"node.icon === 'c8y-group-smart'\"\n      ></i>\n      <i\n        class=\"c8y-icon m-r-4\"\n        [c8yIcon]=\"node.icon\"\n        [title]=\"'Group' | translate\"\n        *ngIf=\"node.icon !== 'c8y-group-smart'\"\n        [ngClass]=\"{ 'c8y-icon-duocolor text-16 ': node.icon != 'plus' }\"\n      ></i>\n      <span title=\"{{ breadcrumb }}\">\n        {{ node.translateLabel ? (node.label | translate) : node.label }}\n        <!-- use just for search results to display the path -->\n        <p\n          class=\"text-truncate text-muted small\"\n          *ngIf=\"showPath\"\n        >\n          <em>{{ breadcrumb }}</em>\n        </p>\n        <!-- up to here -->\n      </span>\n    </button>\n    <!-- expand button (only for groups) -->\n    <div *ngIf=\"node.isGroup() || node.hasChildDevices()\">\n      <button\n        class=\"collapse-btn btn\"\n        [title]=\"expandTitle\"\n        [attr.aria-expanded]=\"node.open\"\n        (click)=\"click()\"\n      >\n        <i c8yIcon=\"angle-down\"></i>\n      </button>\n    </div>\n  </div>\n  <div\n    class=\"collapse\"\n    *ngIf=\"node.countChildren()\"\n    [collapse]=\"!node.open\"\n    [isAnimated]=\"true\"\n    [attr.role]=\"'group'\"\n  >\n    <c8y-asset-selector-node\n      *ngFor=\"let childNode of node.children\"\n      [node]=\"childNode\"\n      [preselected]=\"preselected || []\"\n      [multi]=\"multi\"\n      [active]=\"active\"\n      [attr.role]=\"view === 'tree' ? 'treeitem' : 'listitem'\"\n      (onSelect)=\"onSelect.emit($event)\"\n      (onDeselect)=\"onDeselect.emit($event)\"\n    ></c8y-asset-selector-node>\n  </div>\n</div>\n\n<!-- Miller columns -->\n<div *ngIf=\"view === 'miller'\">\n  <div\n    class=\"miller-column__item bg-inherit\"\n    title=\"{{ breadcrumb | translate }}\"\n    *ngIf=\"node && !node.root && !node.hidden && node !== rootNode\"\n    [ngClass]=\"{\n      active: isActive(),\n      'miller-column__item--more': node.toString() === 'LoadMoreNode'\n    }\"\n  >\n    <div\n      class=\"m-l-4 m-r-4 miller-column__item__checkbox\"\n      *ngIf=\"node.toString() !== 'LoadMoreNode'\"\n    >\n      <label [ngClass]=\"{ 'c8y-radio': !multi, 'c8y-checkbox': multi }\">\n        <input\n          id=\"nodeLabel2\"\n          [type]=\"multi ? 'checkbox' : 'radio'\"\n          (change)=\"selected(node)\"\n          [checked]=\"isGroupSelected()\"\n          [disabled]=\"!node.groupsSelectable && node.isGroup()\"\n        />\n        <span></span>\n        <span\n          class=\"sr-only\"\n          for=\"nodeLabel2\"\n          translate\n        >\n          Node label\n        </span>\n      </label>\n    </div>\n\n    <button\n      title=\"{{ breadcrumb | translate }}\"\n      type=\"button\"\n      [ngClass]=\"{\n        'btn btn-default btn-sm d-flex flex-grow j-c-center m-l-16 m-r-16 m-b-8':\n          node.toString() === 'LoadMoreNode',\n        'miller-column__item__btn': node.toString() !== 'LoadMoreNode',\n        'btn-pending': node.loading && node.toString() === 'LoadMoreNode'\n      }\"\n      (click)=\"millerViewClick(node)\"\n    >\n      <i\n        class=\"c8y-icon m-r-4\"\n        [c8yIcon]=\"node.icon\"\n        [ngClass]=\"{ 'c8y-icon-duocolor text-16': node.toString() !== 'LoadMoreNode' }\"\n      ></i>\n      <div class=\"text-left text-truncate\">\n        <p\n          class=\"text-truncate\"\n          title=\"{{ node.translateLabel ? (node.label | translate) : node.label }}\"\n        >\n          {{ node.translateLabel ? (node.label | translate) : node.label }}\n        </p>\n        <!-- use just for search results to display the path -->\n        <small\n          class=\"text-muted text-truncate\"\n          title=\"{{ breadcrumb }}\"\n          *ngIf=\"showPath\"\n        >\n          <em>{{ breadcrumb }}</em>\n        </small>\n        <!-- up to here -->\n      </div>\n      <span\n        class=\"p-l-4 m-l-auto\"\n        *ngIf=\"node.isGroup() || node.hasChildDevices()\"\n      >\n        <i c8yIcon=\"angle-right\"></i>\n      </span>\n    </button>\n  </div>\n\n  <div\n    role=\"list\"\n    *ngIf=\"node\"\n    [ngClass]=\"{ hidden: node !== rootNode }\"\n  >\n    <c8y-asset-selector-node\n      role=\"listitem\"\n      *ngFor=\"let childNode of node.children\"\n      [node]=\"childNode\"\n      [rootNode]=\"rootNode\"\n      [preselected]=\"preselected || []\"\n      [multi]=\"multi\"\n      [view]=\"view\"\n      [index]=\"index\"\n      [selectedItems]=\"selectedItems\"\n      [active]=\"active\"\n      [handleNextMillerViewColumn]=\"handleNextMillerViewColumn\"\n      (onSelect)=\"onSelect.emit($event)\"\n      (onDeselect)=\"onDeselect.emit($event)\"\n    ></c8y-asset-selector-node>\n  </div>\n</div>\n", dependencies: [{ kind: "directive", type: i3.IconDirective, selector: "[c8yIcon]", inputs: ["c8yIcon"] }, { kind: "directive", type: i3.C8yTranslateDirective, selector: "[translate],[ngx-translate]" }, { kind: "directive", type: i4.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i4.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i4.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i4.NgStyle, selector: "[ngStyle]", inputs: ["ngStyle"] }, { kind: "directive", type: i5.CollapseDirective, selector: "[collapse]", inputs: ["display", "isAnimated", "collapse"], outputs: ["collapsed", "collapses", "expanded", "expands"], exportAs: ["bs-collapse"] }, { kind: "component", type: AssetSelectorNodeComponent, selector: "c8y-asset-selector-node", inputs: ["node", "rootNode", "preselected", "showPath", "multi", "view", "index", "active", "selectedItems", "handleNextMillerViewColumn"], outputs: ["isLoadingState", "onSelect", "onDeselect"] }, { kind: "pipe", type: i3.C8yTranslatePipe, name: "translate" }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.7", ngImport: i0, type: AssetSelectorNodeComponent, decorators: [{
            type: Component,
            args: [{ selector: 'c8y-asset-selector-node', template: "<!-- Hierarchy tree -->\n<div\n  class=\"c8y-asset-selector__item\"\n  [ngStyle]=\"{\n    'margin-left': level > 1 ? 16 + 'px' : '0'\n  }\"\n  *ngIf=\"view === 'tree'\"\n  [attr.role]=\"view === 'tree' ? 'tree' : 'list'\"\n  [ngClass]=\"{\n    'c8y-asset-selector__item--more': node?.icon === 'plus',\n    'c8y-asset-selector__item--start': level === 0\n  }\"\n>\n  <div\n    class=\"c8y-asset-selector__node\"\n    title=\"{{ breadcrumb | translate }}\"\n    *ngIf=\"node && !node.root && !node.hidden\"\n    [attr.role]=\"view === 'tree' ? 'treeitem' : 'listitem'\"\n    [ngClass]=\"{ 'c8y-asset-selector__node--open': node?.open }\"\n  >\n    <div\n      class=\"d-flex a-i-center p-t-4 p-b-4 m-r-8\"\n      *ngIf=\"node.toString() !== 'LoadMoreNode'\"\n    >\n      <label [ngClass]=\"{ 'c8y-checkbox': multi, 'c8y-radio': !multi }\">\n        <input\n          id=\"nodeLabel\"\n          [type]=\"multi ? 'checkbox' : 'radio'\"\n          (change)=\"selected(node)\"\n          [checked]=\"isSelected()\"\n          [disabled]=\"!node.groupsSelectable && node.isGroup()\"\n        />\n        <span></span>\n        <span\n          class=\"sr-only\"\n          for=\"nodeLabel\"\n          translate\n        >\n          Node label\n        </span>\n      </label>\n    </div>\n\n    <!-- group button -->\n    <button\n      class=\"c8y-asset-selector__btn text-truncate\"\n      [attr.aria-expanded]=\"!node.open\"\n      *ngIf=\"node.isGroup() || node.hasChildDevices()\"\n      (click)=\"click()\"\n    >\n      <i\n        class=\"c8y-icon c8y-icon-duocolor m-r-4 text-16\"\n        [c8yIcon]=\"node.icon\"\n        [title]=\"'Smart group' | translate\"\n        *ngIf=\"node.icon === 'c8y-group-smart'\"\n      ></i>\n      <i\n        class=\"c8y-icon c8y-icon-duocolor m-r-4 text-16\"\n        [c8yIcon]=\"node.icon\"\n        [title]=\"'Group' | translate\"\n        *ngIf=\"node.icon !== 'c8y-group-smart'\"\n      ></i>\n      <span title=\"{{ breadcrumb }}\">\n        {{ node.translateLabel ? (node.label | translate) : node.label }}\n        <!-- use just for search results to display the path -->\n        <p\n          class=\"text-truncate\"\n          *ngIf=\"showPath\"\n        >\n          <small\n            class=\"text-muted\"\n            title=\"{{ breadcrumb }}\"\n          >\n            <em>{{ breadcrumb }}</em>\n          </small>\n        </p>\n        <!-- up to here -->\n      </span>\n    </button>\n    <!-- not a group button -->\n    <button\n      class=\"flex-grow\"\n      title=\"{{ breadcrumb }}\"\n      type=\"button\"\n      *ngIf=\"!node.isGroup() && !node.hasChildDevices()\"\n      [ngClass]=\"{\n        'btn btn-default btn-sm m-b-8 d-flex j-c-center': node.icon === 'plus',\n        'c8y-asset-selector__btn text-truncate': node.icon != 'plus'\n      }\"\n      (click)=\"selected(node)\"\n    >\n      <i\n        class=\"c8y-icon c8y-icon-duocolor m-r-4 text-16\"\n        [c8yIcon]=\"node.icon\"\n        [title]=\"'Smart group' | translate\"\n        *ngIf=\"node.icon === 'c8y-group-smart'\"\n      ></i>\n      <i\n        class=\"c8y-icon m-r-4\"\n        [c8yIcon]=\"node.icon\"\n        [title]=\"'Group' | translate\"\n        *ngIf=\"node.icon !== 'c8y-group-smart'\"\n        [ngClass]=\"{ 'c8y-icon-duocolor text-16 ': node.icon != 'plus' }\"\n      ></i>\n      <span title=\"{{ breadcrumb }}\">\n        {{ node.translateLabel ? (node.label | translate) : node.label }}\n        <!-- use just for search results to display the path -->\n        <p\n          class=\"text-truncate text-muted small\"\n          *ngIf=\"showPath\"\n        >\n          <em>{{ breadcrumb }}</em>\n        </p>\n        <!-- up to here -->\n      </span>\n    </button>\n    <!-- expand button (only for groups) -->\n    <div *ngIf=\"node.isGroup() || node.hasChildDevices()\">\n      <button\n        class=\"collapse-btn btn\"\n        [title]=\"expandTitle\"\n        [attr.aria-expanded]=\"node.open\"\n        (click)=\"click()\"\n      >\n        <i c8yIcon=\"angle-down\"></i>\n      </button>\n    </div>\n  </div>\n  <div\n    class=\"collapse\"\n    *ngIf=\"node.countChildren()\"\n    [collapse]=\"!node.open\"\n    [isAnimated]=\"true\"\n    [attr.role]=\"'group'\"\n  >\n    <c8y-asset-selector-node\n      *ngFor=\"let childNode of node.children\"\n      [node]=\"childNode\"\n      [preselected]=\"preselected || []\"\n      [multi]=\"multi\"\n      [active]=\"active\"\n      [attr.role]=\"view === 'tree' ? 'treeitem' : 'listitem'\"\n      (onSelect)=\"onSelect.emit($event)\"\n      (onDeselect)=\"onDeselect.emit($event)\"\n    ></c8y-asset-selector-node>\n  </div>\n</div>\n\n<!-- Miller columns -->\n<div *ngIf=\"view === 'miller'\">\n  <div\n    class=\"miller-column__item bg-inherit\"\n    title=\"{{ breadcrumb | translate }}\"\n    *ngIf=\"node && !node.root && !node.hidden && node !== rootNode\"\n    [ngClass]=\"{\n      active: isActive(),\n      'miller-column__item--more': node.toString() === 'LoadMoreNode'\n    }\"\n  >\n    <div\n      class=\"m-l-4 m-r-4 miller-column__item__checkbox\"\n      *ngIf=\"node.toString() !== 'LoadMoreNode'\"\n    >\n      <label [ngClass]=\"{ 'c8y-radio': !multi, 'c8y-checkbox': multi }\">\n        <input\n          id=\"nodeLabel2\"\n          [type]=\"multi ? 'checkbox' : 'radio'\"\n          (change)=\"selected(node)\"\n          [checked]=\"isGroupSelected()\"\n          [disabled]=\"!node.groupsSelectable && node.isGroup()\"\n        />\n        <span></span>\n        <span\n          class=\"sr-only\"\n          for=\"nodeLabel2\"\n          translate\n        >\n          Node label\n        </span>\n      </label>\n    </div>\n\n    <button\n      title=\"{{ breadcrumb | translate }}\"\n      type=\"button\"\n      [ngClass]=\"{\n        'btn btn-default btn-sm d-flex flex-grow j-c-center m-l-16 m-r-16 m-b-8':\n          node.toString() === 'LoadMoreNode',\n        'miller-column__item__btn': node.toString() !== 'LoadMoreNode',\n        'btn-pending': node.loading && node.toString() === 'LoadMoreNode'\n      }\"\n      (click)=\"millerViewClick(node)\"\n    >\n      <i\n        class=\"c8y-icon m-r-4\"\n        [c8yIcon]=\"node.icon\"\n        [ngClass]=\"{ 'c8y-icon-duocolor text-16': node.toString() !== 'LoadMoreNode' }\"\n      ></i>\n      <div class=\"text-left text-truncate\">\n        <p\n          class=\"text-truncate\"\n          title=\"{{ node.translateLabel ? (node.label | translate) : node.label }}\"\n        >\n          {{ node.translateLabel ? (node.label | translate) : node.label }}\n        </p>\n        <!-- use just for search results to display the path -->\n        <small\n          class=\"text-muted text-truncate\"\n          title=\"{{ breadcrumb }}\"\n          *ngIf=\"showPath\"\n        >\n          <em>{{ breadcrumb }}</em>\n        </small>\n        <!-- up to here -->\n      </div>\n      <span\n        class=\"p-l-4 m-l-auto\"\n        *ngIf=\"node.isGroup() || node.hasChildDevices()\"\n      >\n        <i c8yIcon=\"angle-right\"></i>\n      </span>\n    </button>\n  </div>\n\n  <div\n    role=\"list\"\n    *ngIf=\"node\"\n    [ngClass]=\"{ hidden: node !== rootNode }\"\n  >\n    <c8y-asset-selector-node\n      role=\"listitem\"\n      *ngFor=\"let childNode of node.children\"\n      [node]=\"childNode\"\n      [rootNode]=\"rootNode\"\n      [preselected]=\"preselected || []\"\n      [multi]=\"multi\"\n      [view]=\"view\"\n      [index]=\"index\"\n      [selectedItems]=\"selectedItems\"\n      [active]=\"active\"\n      [handleNextMillerViewColumn]=\"handleNextMillerViewColumn\"\n      (onSelect)=\"onSelect.emit($event)\"\n      (onDeselect)=\"onDeselect.emit($event)\"\n    ></c8y-asset-selector-node>\n  </div>\n</div>\n" }]
        }], ctorParameters: function () { return [{ type: i1.TranslateService }, { type: i0.ChangeDetectorRef }, { type: i2.AssetSelectorService }]; }, propDecorators: { node: [{
                type: Input
            }], rootNode: [{
                type: Input
            }], preselected: [{
                type: Input
            }], showPath: [{
                type: Input
            }], multi: [{
                type: Input
            }], view: [{
                type: Input
            }], index: [{
                type: Input
            }], active: [{
                type: Input
            }], selectedItems: [{
                type: Input
            }], handleNextMillerViewColumn: [{
                type: Input
            }], isLoadingState: [{
                type: Output
            }], onSelect: [{
                type: Output
            }], onDeselect: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZXQtc2VsZWN0b3Itbm9kZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9hc3NldHMtbmF2aWdhdG9yL2Fzc2V0LXNlbGVjdG9yL2Fzc2V0LXNlbGVjdG9yLW5vZGUuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vYXNzZXRzLW5hdmlnYXRvci9hc3NldC1zZWxlY3Rvci9hc3NldC1zZWxlY3Rvci1ub2RlLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBVSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFbEcsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQzlDLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0IsT0FBTyxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUNuRCxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDeEMsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDaEUsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGNBQWMsQ0FBQzs7Ozs7OztBQU16QyxNQUFNLE9BQU8sMEJBQTBCO0lBb0VyQzs7T0FFRztJQUNILElBQUksV0FBVztRQUNiLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDbkUsQ0FBQztJQUVEOztPQUVHO0lBQ0gsWUFDVSxnQkFBa0MsRUFDbEMsRUFBcUIsRUFDdEIsb0JBQTBDO1FBRnpD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QUFLO2dCQUlHLElBQUk7c0JBQVosS0FBSztnQkFLRyxLQUFLO3NCQUFiLEtBQUs7Z0JBSUcsTUFBTTtzQkFBZCxLQUFLO2dCQUlHLGFBQWE7c0JBQXJCLEtBQUs7Z0JBSUcsMEJBQTBCO3NCQUFsQyxLQUFLO2dCQUlJLGNBQWM7c0JBQXZCLE1BQU07Z0JBSUcsUUFBUTtzQkFBakIsTUFBTTtnQkFJRyxVQUFVO3NCQUFuQixNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2hhbmdlRGV0ZWN0b3JSZWYsIENvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgT25Jbml0LCBPdXRwdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IElJZGVudGlmaWVkLCBJTWFuYWdlZE9iamVjdCB9IGZyb20gJ0BjOHkvY2xpZW50JztcbmltcG9ydCB7IGdldHRleHQgfSBmcm9tICdAYzh5L25neC1jb21wb25lbnRzJztcbmltcG9ydCB7IFRyYW5zbGF0ZVNlcnZpY2UgfSBmcm9tICdAbmd4LXRyYW5zbGF0ZS9jb3JlJztcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IGZpbHRlciwgdGFrZVVudGlsIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgQWN0aW9uIH0gZnJvbSAnLi4vYWN0aW9uLmVudW0nO1xuaW1wb3J0IHsgQXNzZXRTZWxlY3RvclNlcnZpY2UgfSBmcm9tICcuL2Fzc2V0LXNlbGVjdG9yLnNlcnZpY2UnO1xuaW1wb3J0IHsgR3JvdXBOb2RlIH0gZnJvbSAnLi9ncm91cC1ub2RlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYzh5LWFzc2V0LXNlbGVjdG9yLW5vZGUnLFxuICB0ZW1wbGF0ZVVybDogJy4vYXNzZXQtc2VsZWN0b3Itbm9kZS5jb21wb25lbnQuaHRtbCdcbn0pXG5leHBvcnQgY2xhc3MgQXNzZXRTZWxlY3Rvck5vZGVDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICAvKipcbiAgICogVGhlIGN1cnJlbnQgbm9kZS5cbiAgICovXG4gIEBJbnB1dCgpIG5vZGU6IEdyb3VwTm9kZTtcbiAgLyoqXG4gICAqIFJvb3Qgbm9kZS4gTm9kZSBmb3VuZCBhdCB0aGUgdG9wIG9mIHRoZSBoaWVyYXJjaHkuXG4gICAqL1xuICBASW5wdXQoKSByb290Tm9kZTogR3JvdXBOb2RlO1xuICAvKipcbiAgICogQWxsIHByZXNlbGVjdGVkIGl0ZW1zLlxuICAgKi9cbiAgQElucHV0KCkgcHJlc2VsZWN0ZWQ6IElJZGVudGlmaWVkIHwgSUlkZW50aWZpZWRbXSA9IFtdO1xuICAvKipcbiAgICogU2hvdWxkIHRoZSBwYXRoIGJlIHNob3duLlxuICAgKi9cbiAgQElucHV0KCkgc2hvd1BhdGggPSBmYWxzZTtcbiAgLyoqXG4gICAqIENhbiB0aGUgdXNlciBzZWxlY3QgbXVsdGlwbGUgYXNzZXRzLlxuICAgKi9cbiAgQElucHV0KCkgbXVsdGkgPSBmYWxzZTtcbiAgLyoqXG4gICAqIFRoZSBjdXJyZW50IHBhdGggdG8gdGhlIG5vZGUuXG4gICAqL1xuICBASW5wdXQoKSB2aWV3OiAndHJlZScgfCAnbWlsbGVyJyA9ICd0cmVlJztcbiAgLyoqXG4gICAqIFVzZWQgb25seSBmb3IgbWlsbGVyLXZpZXcsIGRpc3BsYXlzIHRoZSBjb2x1bW4gbGV2ZWwgZm9yIHRoZSBjdXJyZW50IG5vZGUuXG4gICAqIEUuZyBpZiB0aGUgaW5kZXggaXMgb25lLCB0aGlzIHdpbGwgYmUgc2Vjb25kIGNvbHVtbi5cbiAgICovXG4gIEBJbnB1dCgpIGluZGV4O1xuICAvKipcbiAgICogU2V0cyB0aGUgYWN0aXZlIG5vZGUuXG4gICAqL1xuICBASW5wdXQoKSBhY3RpdmU6IEdyb3VwTm9kZTtcbiAgLyoqXG4gICAqIEFsbCBjdXJyZW50bHkgc2VsZWN0ZWQgYXNzZXRzLlxuICAgKi9cbiAgQElucHV0KCkgc2VsZWN0ZWRJdGVtczogSUlkZW50aWZpZWRbXSB8IElJZGVudGlmaWVkID0gW107XG4gIC8qKlxuICAgKiBBIGZ1bmN0aW9uIHRoYXQgc2hvdWxkIHZlcmlmeSB0aGUgbmVlZCB0byBhZGQgYSBjb2x1bW4gd2hlbiBhIG5vZGUgaXMgY2xpY2tlZC5cbiAgICovXG4gIEBJbnB1dCgpIGhhbmRsZU5leHRNaWxsZXJWaWV3Q29sdW1uOiAobm9kZTogR3JvdXBOb2RlLCBpbmRleDogbnVtYmVyKSA9PiBib29sZWFuO1xuICAvKipcbiAgICogRXZlbnQsIHdoaWNoIGluZGljYXRlcyB3aGV0aGVyIHRoZSBsb2FkaW5nIG9mIHRoZSBub2RlIGhhcyBjb21wbGV0ZWQuXG4gICAqL1xuICBAT3V0cHV0KCkgaXNMb2FkaW5nU3RhdGU6IEV2ZW50RW1pdHRlcjxib29sZWFuPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgLyoqXG4gICAqIEV2ZW50IHRoYXQgZW1pdHMgd2hlbiBhIG5vZGUgaXMgc2VsZWN0ZWQuXG4gICAqL1xuICBAT3V0cHV0KCkgb25TZWxlY3Q6IEV2ZW50RW1pdHRlcjxJTWFuYWdlZE9iamVjdD4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIC8qKlxuICAgKiBFdmVudCB0aGF0IGVtaXRzIHdoZW4gYSBub2RlIGlzIGRlc2VsZWN0ZWQuXG4gICAqL1xuICBAT3V0cHV0KCkgb25EZXNlbGVjdDogRXZlbnRFbWl0dGVyPHsgZGVzZWxlY3RNb2RlOiAnc2luZ2xlJyB8ICdhbGwnOyBtbzogSU1hbmFnZWRPYmplY3QgfT4gPVxuICAgIG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICBicmVhZGNydW1iOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBsZXZlbCA9IDA7XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICB1bnN1YnNjcmliZSQgPSBuZXcgU3ViamVjdDxhbnk+KCk7XG5cbiAgLyoqIHNldHMgdGhlIGBidG4tcGVuZGluZ2AgY2xhc3MgaW4gdGhlIGxvYWQgbW9yZSBidXR0b24gKi9cbiAgaXNMb2FkaW5nID0gZmFsc2U7XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBnZXQgZXhwYW5kVGl0bGUoKSB7XG4gICAgcmV0dXJuICF0aGlzLm5vZGUub3BlbiA/IGdldHRleHQoJ0V4cGFuZCcpIDogZ2V0dGV4dCgnQ29sbGFwc2UnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAaWdub3JlIG9ubHkgZGlcbiAgICovXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgdHJhbnNsYXRlU2VydmljZTogVHJhbnNsYXRlU2VydmljZSxcbiAgICBwcml2YXRlIGNkOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICBwdWJsaWMgYXNzZXRTZWxlY3RvclNlcnZpY2U6IEFzc2V0U2VsZWN0b3JTZXJ2aWNlXG4gICkge31cblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgYXN5bmMgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5icmVhZGNydW1iID0gdGhpcy5ub2RlLmxhYmVsO1xuICAgIHRoaXMuc2V0dXBCcmVhZGNydW1ic0FuZExldmVsKHRoaXMubm9kZSk7XG5cbiAgICBpZiAodGhpcy5ub2RlIGluc3RhbmNlb2YgR3JvdXBOb2RlKSB7XG4gICAgICB0aGlzLm5vZGUuaG9va0V2ZW50cygpO1xuICAgIH1cblxuICAgIC8vIG9wZW4gb24gc3RhcnR1cFxuICAgIGlmICh0aGlzLm5vZGUucm9vdCkge1xuICAgICAgdGhpcy5jbGljaygpO1xuICAgIH1cblxuICAgIC8vIHVzZWQgZm9yIGxvYWRpbmcgYW5kIHRvIHRyaWdnZXIgY2hhbmdlIGRldGVjdGlvbiB3aGVuIHRoZSBub2RlIGlzIG5vIGxvbmdlciBsb2FkaW5nLlxuICAgIGlmICh0aGlzLm5vZGUuZXZlbnRzKSB7XG4gICAgICB0aGlzLm5vZGUuZXZlbnRzXG4gICAgICAgIC5waXBlKFxuICAgICAgICAgIHRha2VVbnRpbCh0aGlzLnVuc3Vic2NyaWJlJCksXG4gICAgICAgICAgZmlsdGVyKChhOiBBY3Rpb24pID0+IGEgPT09IEFjdGlvbi5MT0FESU5HX0RPTkUpXG4gICAgICAgIClcbiAgICAgICAgLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5pc0xvYWRpbmdTdGF0ZS5lbWl0KGZhbHNlKTtcbiAgICAgICAgICB0aGlzLmNkLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogT3BlbnMgYSBub2RlLlxuICAgKi9cbiAgY2xpY2soKSB7XG4gICAgdGhpcy5ub2RlLm9wZW4gPSAhdGhpcy5ub2RlLm9wZW47XG4gICAgdGhpcy5ub2RlLmNsaWNrKHsgb3BlbjogdGhpcy5ub2RlLm9wZW4gfSk7XG4gIH1cblxuICBzZXR1cEJyZWFkY3J1bWJzQW5kTGV2ZWwobm9kZTogR3JvdXBOb2RlKSB7XG4gICAgaWYgKG5vZGUucGFyZW50cyAmJiBub2RlLnBhcmVudHMubGVuZ3RoKSB7XG4gICAgICBjb25zdCBwYXJlbnQgPSBub2RlLnBhcmVudHNbMF0gYXMgR3JvdXBOb2RlO1xuICAgICAgdGhpcy5icmVhZGNydW1iID1cbiAgICAgICAgdGhpcy50cmFuc2xhdGVTZXJ2aWNlLmluc3RhbnQocGFyZW50LmxhYmVsKSArXG4gICAgICAgICcgPiAnICtcbiAgICAgICAgdGhpcy50cmFuc2xhdGVTZXJ2aWNlLmluc3RhbnQodGhpcy5icmVhZGNydW1iKTtcbiAgICAgIHRoaXMubGV2ZWwrKztcblxuICAgICAgdGhpcy5zZXR1cEJyZWFkY3J1bWJzQW5kTGV2ZWwocGFyZW50KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0cyB0aGUgbm9kZSBhbmQgZW1pdHMgYSBjaGFuZ2Ugb24gdGhlIHBhcmVudCBjb21wb25lbnQuXG4gICAqIEBwYXJhbSBub2RlIFRoZSBub2RlIHRvIHNlbGVjdC5cbiAgICovXG4gIHNlbGVjdGVkKG5vZGU6IEdyb3VwTm9kZSkge1xuICAgIGlmIChub2RlLm1vKSB7XG4gICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbihub2RlLm1vKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5jbGljaygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgY2xpY2tzIG9uIGEgaXRlbSBpbiBNaWxsZXIgVmlldy5cbiAgICogQHBhcmFtIG5vZGUgVGhlIG5vZGUgdGhhdCB3YXMgY2xpY2tlZC5cbiAgICovXG4gIG1pbGxlclZpZXdDbGljayhub2RlOiBHcm91cE5vZGUpIHtcbiAgICBub2RlLmJyZWFkY3J1bWIgPSB0aGlzLmJyZWFkY3J1bWI7XG5cbiAgICBpZiAoIXRoaXMuaGFuZGxlTmV4dE1pbGxlclZpZXdDb2x1bW4pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qgc2hvdWxkSGFuZGxlRGVmYXVsdCA9IHRoaXMuaGFuZGxlTmV4dE1pbGxlclZpZXdDb2x1bW4obm9kZSwgdGhpcy5pbmRleCk7XG4gICAgaWYgKHNob3VsZEhhbmRsZURlZmF1bHQpIHtcbiAgICAgIHRoaXMuc2VsZWN0ZWQobm9kZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMudW5zdWJzY3JpYmUkLm5leHQodHJ1ZSk7XG4gICAgdGhpcy51bnN1YnNjcmliZSQuY29tcGxldGUoKTtcbiAgfVxuXG4gIGlzU2VsZWN0ZWQoKSB7XG4gICAgaWYgKCF0aGlzLm5vZGUubW8pIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuYXNzZXRTZWxlY3RvclNlcnZpY2UuZ2V0SW5kZXhPZlNlbGVjdGVkKHRoaXMucHJlc2VsZWN0ZWQsIHRoaXMubm9kZS5tbykgPiAtMTtcbiAgfVxuXG4gIGlzQWN0aXZlKCkge1xuICAgIGlmICh0aGlzLmFjdGl2ZSAmJiB0aGlzLm5vZGUubW8pIHtcbiAgICAgIHJldHVybiB0aGlzLmFjdGl2ZS5tbz8uaWQgPT09IHRoaXMubm9kZS5tby5pZDtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgaXNHcm91cFNlbGVjdGVkKCkge1xuICAgIGlmICh0aGlzLnNlbGVjdGVkSXRlbXMuc29tZShzZWxlY3RlZE5vZGUgPT4gc2VsZWN0ZWROb2RlLmlkID09PSB0aGlzLm5vZGUubW8/LmlkKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlU2VsZWN0aW9uKHNlbGVjdGVkTW86IElNYW5hZ2VkT2JqZWN0KSB7XG4gICAgaWYgKCF0aGlzLm11bHRpKSB7XG4gICAgICB0aGlzLm9uRGVzZWxlY3QuZW1pdCh7IGRlc2VsZWN0TW9kZTogJ2FsbCcsIG1vOiBzZWxlY3RlZE1vIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodGhpcy5pc1NlbGVjdGVkKCkpIHtcbiAgICAgIHRoaXMub25EZXNlbGVjdC5lbWl0KHsgZGVzZWxlY3RNb2RlOiAnc2luZ2xlJywgbW86IHNlbGVjdGVkTW8gfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMub25TZWxlY3QuZW1pdChzZWxlY3RlZE1vKTtcbiAgICB0aGlzLmNkLm1hcmtGb3JDaGVjaygpO1xuICB9XG59XG4iLCI8IS0tIEhpZXJhcmNoeSB0cmVlIC0tPlxuPGRpdlxuICBjbGFzcz1cImM4eS1hc3NldC1zZWxlY3Rvcl9faXRlbVwiXG4gIFtuZ1N0eWxlXT1cIntcbiAgICAnbWFyZ2luLWxlZnQnOiBsZXZlbCA+IDEgPyAxNiArICdweCcgOiAnMCdcbiAgfVwiXG4gICpuZ0lmPVwidmlldyA9PT0gJ3RyZWUnXCJcbiAgW2F0dHIucm9sZV09XCJ2aWV3ID09PSAndHJlZScgPyAndHJlZScgOiAnbGlzdCdcIlxuICBbbmdDbGFzc109XCJ7XG4gICAgJ2M4eS1hc3NldC1zZWxlY3Rvcl9faXRlbS0tbW9yZSc6IG5vZGU/Lmljb24gPT09ICdwbHVzJyxcbiAgICAnYzh5LWFzc2V0LXNlbGVjdG9yX19pdGVtLS1zdGFydCc6IGxldmVsID09PSAwXG4gIH1cIlxuPlxuICA8ZGl2XG4gICAgY2xhc3M9XCJjOHktYXNzZXQtc2VsZWN0b3JfX25vZGVcIlxuICAgIHRpdGxlPVwie3sgYnJlYWRjcnVtYiB8IHRyYW5zbGF0ZSB9fVwiXG4gICAgKm5nSWY9XCJub2RlICYmICFub2RlLnJvb3QgJiYgIW5vZGUuaGlkZGVuXCJcbiAgICBbYXR0ci5yb2xlXT1cInZpZXcgPT09ICd0cmVlJyA/ICd0cmVlaXRlbScgOiAnbGlzdGl0ZW0nXCJcbiAgICBbbmdDbGFzc109XCJ7ICdjOHktYXNzZXQtc2VsZWN0b3JfX25vZGUtLW9wZW4nOiBub2RlPy5vcGVuIH1cIlxuICA+XG4gICAgPGRpdlxuICAgICAgY2xhc3M9XCJkLWZsZXggYS1pLWNlbnRlciBwLXQtNCBwLWItNCBtLXItOFwiXG4gICAgICAqbmdJZj1cIm5vZGUudG9TdHJpbmcoKSAhPT0gJ0xvYWRNb3JlTm9kZSdcIlxuICAgID5cbiAgICAgIDxsYWJlbCBbbmdDbGFzc109XCJ7ICdjOHktY2hlY2tib3gnOiBtdWx0aSwgJ2M4eS1yYWRpbyc6ICFtdWx0aSB9XCI+XG4gICAgICAgIDxpbnB1dFxuICAgICAgICAgIGlkPVwibm9kZUxhYmVsXCJcbiAgICAgICAgICBbdHlwZV09XCJtdWx0aSA/ICdjaGVja2JveCcgOiAncmFkaW8nXCJcbiAgICAgICAgICAoY2hhbmdlKT1cInNlbGVjdGVkKG5vZGUpXCJcbiAgICAgICAgICBbY2hlY2tlZF09XCJpc1NlbGVjdGVkKClcIlxuICAgICAgICAgIFtkaXNhYmxlZF09XCIhbm9kZS5ncm91cHNTZWxlY3RhYmxlICYmIG5vZGUuaXNHcm91cCgpXCJcbiAgICAgICAgLz5cbiAgICAgICAgPHNwYW4+PC9zcGFuPlxuICAgICAgICA8c3BhblxuICAgICAgICAgIGNsYXNzPVwic3Itb25seVwiXG4gICAgICAgICAgZm9yPVwibm9kZUxhYmVsXCJcbiAgICAgICAgICB0cmFuc2xhdGVcbiAgICAgICAgPlxuICAgICAgICAgIE5vZGUgbGFiZWxcbiAgICAgICAgPC9zcGFuPlxuICAgICAgPC9sYWJlbD5cbiAgICA8L2Rpdj5cblxuICAgIDwhLS0gZ3JvdXAgYnV0dG9uIC0tPlxuICAgIDxidXR0b25cbiAgICAgIGNsYXNzPVwiYzh5LWFzc2V0LXNlbGVjdG9yX19idG4gdGV4dC10cnVuY2F0ZVwiXG4gICAgICBbYXR0ci5hcmlhLWV4cGFuZGVkXT1cIiFub2RlLm9wZW5cIlxuICAgICAgKm5nSWY9XCJub2RlLmlzR3JvdXAoKSB8fCBub2RlLmhhc0NoaWxkRGV2aWNlcygpXCJcbiAgICAgIChjbGljayk9XCJjbGljaygpXCJcbiAgICA+XG4gICAgICA8aVxuICAgICAgICBjbGFzcz1cImM4eS1pY29uIGM4eS1pY29uLWR1b2NvbG9yIG0tci00IHRleHQtMTZcIlxuICAgICAgICBbYzh5SWNvbl09XCJub2RlLmljb25cIlxuICAgICAgICBbdGl0bGVdPVwiJ1NtYXJ0IGdyb3VwJyB8IHRyYW5zbGF0ZVwiXG4gICAgICAgICpuZ0lmPVwibm9kZS5pY29uID09PSAnYzh5LWdyb3VwLXNtYXJ0J1wiXG4gICAgICA+PC9pPlxuICAgICAgPGlcbiAgICAgICAgY2xhc3M9XCJjOHktaWNvbiBjOHktaWNvbi1kdW9jb2xvciBtLXItNCB0ZXh0LTE2XCJcbiAgICAgICAgW2M4eUljb25dPVwibm9kZS5pY29uXCJcbiAgICAgICAgW3RpdGxlXT1cIidHcm91cCcgfCB0cmFuc2xhdGVcIlxuICAgICAgICAqbmdJZj1cIm5vZGUuaWNvbiAhPT0gJ2M4eS1ncm91cC1zbWFydCdcIlxuICAgICAgPjwvaT5cbiAgICAgIDxzcGFuIHRpdGxlPVwie3sgYnJlYWRjcnVtYiB9fVwiPlxuICAgICAgICB7eyBub2RlLnRyYW5zbGF0ZUxhYmVsID8gKG5vZGUubGFiZWwgfCB0cmFuc2xhdGUpIDogbm9kZS5sYWJlbCB9fVxuICAgICAgICA8IS0tIHVzZSBqdXN0IGZvciBzZWFyY2ggcmVzdWx0cyB0byBkaXNwbGF5IHRoZSBwYXRoIC0tPlxuICAgICAgICA8cFxuICAgICAgICAgIGNsYXNzPVwidGV4dC10cnVuY2F0ZVwiXG4gICAgICAgICAgKm5nSWY9XCJzaG93UGF0aFwiXG4gICAgICAgID5cbiAgICAgICAgICA8c21hbGxcbiAgICAgICAgICAgIGNsYXNzPVwidGV4dC1tdXRlZFwiXG4gICAgICAgICAgICB0aXRsZT1cInt7IGJyZWFkY3J1bWIgfX1cIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxlbT57eyBicmVhZGNydW1iIH19PC9lbT5cbiAgICAgICAgICA8L3NtYWxsPlxuICAgICAgICA8L3A+XG4gICAgICAgIDwhLS0gdXAgdG8gaGVyZSAtLT5cbiAgICAgIDwvc3Bhbj5cbiAgICA8L2J1dHRvbj5cbiAgICA8IS0tIG5vdCBhIGdyb3VwIGJ1dHRvbiAtLT5cbiAgICA8YnV0dG9uXG4gICAgICBjbGFzcz1cImZsZXgtZ3Jvd1wiXG4gICAgICB0aXRsZT1cInt7IGJyZWFkY3J1bWIgfX1cIlxuICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAqbmdJZj1cIiFub2RlLmlzR3JvdXAoKSAmJiAhbm9kZS5oYXNDaGlsZERldmljZXMoKVwiXG4gICAgICBbbmdDbGFzc109XCJ7XG4gICAgICAgICdidG4gYnRuLWRlZmF1bHQgYnRuLXNtIG0tYi04IGQtZmxleCBqLWMtY2VudGVyJzogbm9kZS5pY29uID09PSAncGx1cycsXG4gICAgICAgICdjOHktYXNzZXQtc2VsZWN0b3JfX2J0biB0ZXh0LXRydW5jYXRlJzogbm9kZS5pY29uICE9ICdwbHVzJ1xuICAgICAgfVwiXG4gICAgICAoY2xpY2spPVwic2VsZWN0ZWQobm9kZSlcIlxuICAgID5cbiAgICAgIDxpXG4gICAgICAgIGNsYXNzPVwiYzh5LWljb24gYzh5LWljb24tZHVvY29sb3IgbS1yLTQgdGV4dC0xNlwiXG4gICAgICAgIFtjOHlJY29uXT1cIm5vZGUuaWNvblwiXG4gICAgICAgIFt0aXRsZV09XCInU21hcnQgZ3JvdXAnIHwgdHJhbnNsYXRlXCJcbiAgICAgICAgKm5nSWY9XCJub2RlLmljb24gPT09ICdjOHktZ3JvdXAtc21hcnQnXCJcbiAgICAgID48L2k+XG4gICAgICA8aVxuICAgICAgICBjbGFzcz1cImM4eS1pY29uIG0tci00XCJcbiAgICAgICAgW2M4eUljb25dPVwibm9kZS5pY29uXCJcbiAgICAgICAgW3RpdGxlXT1cIidHcm91cCcgfCB0cmFuc2xhdGVcIlxuICAgICAgICAqbmdJZj1cIm5vZGUuaWNvbiAhPT0gJ2M4eS1ncm91cC1zbWFydCdcIlxuICAgICAgICBbbmdDbGFzc109XCJ7ICdjOHktaWNvbi1kdW9jb2xvciB0ZXh0LTE2ICc6IG5vZGUuaWNvbiAhPSAncGx1cycgfVwiXG4gICAgICA+PC9pPlxuICAgICAgPHNwYW4gdGl0bGU9XCJ7eyBicmVhZGNydW1iIH19XCI+XG4gICAgICAgIHt7IG5vZGUudHJhbnNsYXRlTGFiZWwgPyAobm9kZS5sYWJlbCB8IHRyYW5zbGF0ZSkgOiBub2RlLmxhYmVsIH19XG4gICAgICAgIDwhLS0gdXNlIGp1c3QgZm9yIHNlYXJjaCByZXN1bHRzIHRvIGRpc3BsYXkgdGhlIHBhdGggLS0+XG4gICAgICAgIDxwXG4gICAgICAgICAgY2xhc3M9XCJ0ZXh0LXRydW5jYXRlIHRleHQtbXV0ZWQgc21hbGxcIlxuICAgICAgICAgICpuZ0lmPVwic2hvd1BhdGhcIlxuICAgICAgICA+XG4gICAgICAgICAgPGVtPnt7IGJyZWFkY3J1bWIgfX08L2VtPlxuICAgICAgICA8L3A+XG4gICAgICAgIDwhLS0gdXAgdG8gaGVyZSAtLT5cbiAgICAgIDwvc3Bhbj5cbiAgICA8L2J1dHRvbj5cbiAgICA8IS0tIGV4cGFuZCBidXR0b24gKG9ubHkgZm9yIGdyb3VwcykgLS0+XG4gICAgPGRpdiAqbmdJZj1cIm5vZGUuaXNHcm91cCgpIHx8IG5vZGUuaGFzQ2hpbGREZXZpY2VzKClcIj5cbiAgICAgIDxidXR0b25cbiAgICAgICAgY2xhc3M9XCJjb2xsYXBzZS1idG4gYnRuXCJcbiAgICAgICAgW3RpdGxlXT1cImV4cGFuZFRpdGxlXCJcbiAgICAgICAgW2F0dHIuYXJpYS1leHBhbmRlZF09XCJub2RlLm9wZW5cIlxuICAgICAgICAoY2xpY2spPVwiY2xpY2soKVwiXG4gICAgICA+XG4gICAgICAgIDxpIGM4eUljb249XCJhbmdsZS1kb3duXCI+PC9pPlxuICAgICAgPC9idXR0b24+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuICA8ZGl2XG4gICAgY2xhc3M9XCJjb2xsYXBzZVwiXG4gICAgKm5nSWY9XCJub2RlLmNvdW50Q2hpbGRyZW4oKVwiXG4gICAgW2NvbGxhcHNlXT1cIiFub2RlLm9wZW5cIlxuICAgIFtpc0FuaW1hdGVkXT1cInRydWVcIlxuICAgIFthdHRyLnJvbGVdPVwiJ2dyb3VwJ1wiXG4gID5cbiAgICA8Yzh5LWFzc2V0LXNlbGVjdG9yLW5vZGVcbiAgICAgICpuZ0Zvcj1cImxldCBjaGlsZE5vZGUgb2Ygbm9kZS5jaGlsZHJlblwiXG4gICAgICBbbm9kZV09XCJjaGlsZE5vZGVcIlxuICAgICAgW3ByZXNlbGVjdGVkXT1cInByZXNlbGVjdGVkIHx8IFtdXCJcbiAgICAgIFttdWx0aV09XCJtdWx0aVwiXG4gICAgICBbYWN0aXZlXT1cImFjdGl2ZVwiXG4gICAgICBbYXR0ci5yb2xlXT1cInZpZXcgPT09ICd0cmVlJyA/ICd0cmVlaXRlbScgOiAnbGlzdGl0ZW0nXCJcbiAgICAgIChvblNlbGVjdCk9XCJvblNlbGVjdC5lbWl0KCRldmVudClcIlxuICAgICAgKG9uRGVzZWxlY3QpPVwib25EZXNlbGVjdC5lbWl0KCRldmVudClcIlxuICAgID48L2M4eS1hc3NldC1zZWxlY3Rvci1ub2RlPlxuICA8L2Rpdj5cbjwvZGl2PlxuXG48IS0tIE1pbGxlciBjb2x1bW5zIC0tPlxuPGRpdiAqbmdJZj1cInZpZXcgPT09ICdtaWxsZXInXCI+XG4gIDxkaXZcbiAgICBjbGFzcz1cIm1pbGxlci1jb2x1bW5fX2l0ZW0gYmctaW5oZXJpdFwiXG4gICAgdGl0bGU9XCJ7eyBicmVhZGNydW1iIHwgdHJhbnNsYXRlIH19XCJcbiAgICAqbmdJZj1cIm5vZGUgJiYgIW5vZGUucm9vdCAmJiAhbm9kZS5oaWRkZW4gJiYgbm9kZSAhPT0gcm9vdE5vZGVcIlxuICAgIFtuZ0NsYXNzXT1cIntcbiAgICAgIGFjdGl2ZTogaXNBY3RpdmUoKSxcbiAgICAgICdtaWxsZXItY29sdW1uX19pdGVtLS1tb3JlJzogbm9kZS50b1N0cmluZygpID09PSAnTG9hZE1vcmVOb2RlJ1xuICAgIH1cIlxuICA+XG4gICAgPGRpdlxuICAgICAgY2xhc3M9XCJtLWwtNCBtLXItNCBtaWxsZXItY29sdW1uX19pdGVtX19jaGVja2JveFwiXG4gICAgICAqbmdJZj1cIm5vZGUudG9TdHJpbmcoKSAhPT0gJ0xvYWRNb3JlTm9kZSdcIlxuICAgID5cbiAgICAgIDxsYWJlbCBbbmdDbGFzc109XCJ7ICdjOHktcmFkaW8nOiAhbXVsdGksICdjOHktY2hlY2tib3gnOiBtdWx0aSB9XCI+XG4gICAgICAgIDxpbnB1dFxuICAgICAgICAgIGlkPVwibm9kZUxhYmVsMlwiXG4gICAgICAgICAgW3R5cGVdPVwibXVsdGkgPyAnY2hlY2tib3gnIDogJ3JhZGlvJ1wiXG4gICAgICAgICAgKGNoYW5nZSk9XCJzZWxlY3RlZChub2RlKVwiXG4gICAgICAgICAgW2NoZWNrZWRdPVwiaXNHcm91cFNlbGVjdGVkKClcIlxuICAgICAgICAgIFtkaXNhYmxlZF09XCIhbm9kZS5ncm91cHNTZWxlY3RhYmxlICYmIG5vZGUuaXNHcm91cCgpXCJcbiAgICAgICAgLz5cbiAgICAgICAgPHNwYW4+PC9zcGFuPlxuICAgICAgICA8c3BhblxuICAgICAgICAgIGNsYXNzPVwic3Itb25seVwiXG4gICAgICAgICAgZm9yPVwibm9kZUxhYmVsMlwiXG4gICAgICAgICAgdHJhbnNsYXRlXG4gICAgICAgID5cbiAgICAgICAgICBOb2RlIGxhYmVsXG4gICAgICAgIDwvc3Bhbj5cbiAgICAgIDwvbGFiZWw+XG4gICAgPC9kaXY+XG5cbiAgICA8YnV0dG9uXG4gICAgICB0aXRsZT1cInt7IGJyZWFkY3J1bWIgfCB0cmFuc2xhdGUgfX1cIlxuICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICBbbmdDbGFzc109XCJ7XG4gICAgICAgICdidG4gYnRuLWRlZmF1bHQgYnRuLXNtIGQtZmxleCBmbGV4LWdyb3cgai1jLWNlbnRlciBtLWwtMTYgbS1yLTE2IG0tYi04JzpcbiAgICAgICAgICBub2RlLnRvU3RyaW5nKCkgPT09ICdMb2FkTW9yZU5vZGUnLFxuICAgICAgICAnbWlsbGVyLWNvbHVtbl9faXRlbV9fYnRuJzogbm9kZS50b1N0cmluZygpICE9PSAnTG9hZE1vcmVOb2RlJyxcbiAgICAgICAgJ2J0bi1wZW5kaW5nJzogbm9kZS5sb2FkaW5nICYmIG5vZGUudG9TdHJpbmcoKSA9PT0gJ0xvYWRNb3JlTm9kZSdcbiAgICAgIH1cIlxuICAgICAgKGNsaWNrKT1cIm1pbGxlclZpZXdDbGljayhub2RlKVwiXG4gICAgPlxuICAgICAgPGlcbiAgICAgICAgY2xhc3M9XCJjOHktaWNvbiBtLXItNFwiXG4gICAgICAgIFtjOHlJY29uXT1cIm5vZGUuaWNvblwiXG4gICAgICAgIFtuZ0NsYXNzXT1cInsgJ2M4eS1pY29uLWR1b2NvbG9yIHRleHQtMTYnOiBub2RlLnRvU3RyaW5nKCkgIT09ICdMb2FkTW9yZU5vZGUnIH1cIlxuICAgICAgPjwvaT5cbiAgICAgIDxkaXYgY2xhc3M9XCJ0ZXh0LWxlZnQgdGV4dC10cnVuY2F0ZVwiPlxuICAgICAgICA8cFxuICAgICAgICAgIGNsYXNzPVwidGV4dC10cnVuY2F0ZVwiXG4gICAgICAgICAgdGl0bGU9XCJ7eyBub2RlLnRyYW5zbGF0ZUxhYmVsID8gKG5vZGUubGFiZWwgfCB0cmFuc2xhdGUpIDogbm9kZS5sYWJlbCB9fVwiXG4gICAgICAgID5cbiAgICAgICAgICB7eyBub2RlLnRyYW5zbGF0ZUxhYmVsID8gKG5vZGUubGFiZWwgfCB0cmFuc2xhdGUpIDogbm9kZS5sYWJlbCB9fVxuICAgICAgICA8L3A+XG4gICAgICAgIDwhLS0gdXNlIGp1c3QgZm9yIHNlYXJjaCByZXN1bHRzIHRvIGRpc3BsYXkgdGhlIHBhdGggLS0+XG4gICAgICAgIDxzbWFsbFxuICAgICAgICAgIGNsYXNzPVwidGV4dC1tdXRlZCB0ZXh0LXRydW5jYXRlXCJcbiAgICAgICAgICB0aXRsZT1cInt7IGJyZWFkY3J1bWIgfX1cIlxuICAgICAgICAgICpuZ0lmPVwic2hvd1BhdGhcIlxuICAgICAgICA+XG4gICAgICAgICAgPGVtPnt7IGJyZWFkY3J1bWIgfX08L2VtPlxuICAgICAgICA8L3NtYWxsPlxuICAgICAgICA8IS0tIHVwIHRvIGhlcmUgLS0+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxzcGFuXG4gICAgICAgIGNsYXNzPVwicC1sLTQgbS1sLWF1dG9cIlxuICAgICAgICAqbmdJZj1cIm5vZGUuaXNHcm91cCgpIHx8IG5vZGUuaGFzQ2hpbGREZXZpY2VzKClcIlxuICAgICAgPlxuICAgICAgICA8aSBjOHlJY29uPVwiYW5nbGUtcmlnaHRcIj48L2k+XG4gICAgICA8L3NwYW4+XG4gICAgPC9idXR0b24+XG4gIDwvZGl2PlxuXG4gIDxkaXZcbiAgICByb2xlPVwibGlzdFwiXG4gICAgKm5nSWY9XCJub2RlXCJcbiAgICBbbmdDbGFzc109XCJ7IGhpZGRlbjogbm9kZSAhPT0gcm9vdE5vZGUgfVwiXG4gID5cbiAgICA8Yzh5LWFzc2V0LXNlbGVjdG9yLW5vZGVcbiAgICAgIHJvbGU9XCJsaXN0aXRlbVwiXG4gICAgICAqbmdGb3I9XCJsZXQgY2hpbGROb2RlIG9mIG5vZGUuY2hpbGRyZW5cIlxuICAgICAgW25vZGVdPVwiY2hpbGROb2RlXCJcbiAgICAgIFtyb290Tm9kZV09XCJyb290Tm9kZVwiXG4gICAgICBbcHJlc2VsZWN0ZWRdPVwicHJlc2VsZWN0ZWQgfHwgW11cIlxuICAgICAgW211bHRpXT1cIm11bHRpXCJcbiAgICAgIFt2aWV3XT1cInZpZXdcIlxuICAgICAgW2luZGV4XT1cImluZGV4XCJcbiAgICAgIFtzZWxlY3RlZEl0ZW1zXT1cInNlbGVjdGVkSXRlbXNcIlxuICAgICAgW2FjdGl2ZV09XCJhY3RpdmVcIlxuICAgICAgW2hhbmRsZU5leHRNaWxsZXJWaWV3Q29sdW1uXT1cImhhbmRsZU5leHRNaWxsZXJWaWV3Q29sdW1uXCJcbiAgICAgIChvblNlbGVjdCk9XCJvblNlbGVjdC5lbWl0KCRldmVudClcIlxuICAgICAgKG9uRGVzZWxlY3QpPVwib25EZXNlbGVjdC5lbWl0KCRldmVudClcIlxuICAgID48L2M4eS1hc3NldC1zZWxlY3Rvci1ub2RlPlxuICA8L2Rpdj5cbjwvZGl2PlxuIl19
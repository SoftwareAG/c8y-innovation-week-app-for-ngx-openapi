import { CdkStep } from '@angular/cdk/stepper';
import { Component, EventEmitter, Input, Output } from '@angular/core';
import { GainsightService } from '../product-experience/gainsight.service';
import { ACTIONS } from './stepper-px.constants';
import { C8yStepper } from './stepper.component';
import * as i0 from "@angular/core";
import * as i1 from "./stepper.component";
import * as i2 from "@angular/cdk/stepper";
import * as i3 from "../product-experience/gainsight.service";
import * as i4 from "@angular/common";
import * as i5 from "../i18n/c8y-translate.pipe";
/**
 * C8yStepperButtons provides a convenient way to have, according to
 * the C8yStepper and each cdk-step, buttons to navigate between steps or to cancel the whole
 * step-process. Buttons rendered with the help of this component will use the branding css.
 *
 * By default all steps with this component in use will render a next button, expect the last step.
 * The other way around, every step using this component will render a back button, expect the first step.
 * To get a cancel button rendered you need to handle the onCancel event.
 * For next and back button you don't need to handle the available events onNext and onBack because default behavior
 * is implemented. The default will just call, according to the button, the stepper.next() or stepper.previous()
 * methods and moves the stepper forth or back. Using the EventEmitter onNext and onBack will emit for you the following
 * object: {stepper: C8yStepper, step: CdkStep}. This is useful if you need to implement custom logic before moving
 * to the next step or sending data to a backend. In this case you need to tell the stepper to move forward or back
 * on your own.
 *
 * With the component input [labels] you can change the label of each button in each step. It takes an object like this:
 * {next?: string, back?: string, cancel?: string}
 *
 * The [pending] input is of type boolean and will enable css animation for the next button when true.
 *
 * If the cdk-step provides a stepControl the component will set the next button disabled when the formGroup
 * behind it is invalid. As long as the [pending] input is true the back and next button is also disabled.
 * This will prevent multiple clicks while running a request or stepping back while a request is ongoing.
 *
 * **Example**
 * ```
 * <c8y-stepper>
 *  <cdk-step>
 *    <!--
 *      your html code
 *          ...
 *          ...    -->
 *    <c8y-stepper-buttons
 *     (onNext)="save()"
 *     [labels]="{ next: 'Save' }"
 *     [pending]="pendingStatus"
 *     ></c8y-stepper-buttons>
 *  </cdk-step>
 * </c8y-stepper>
 *
 * // in your component:
 * async save() {
 *   this.pendingStatus = true;
 *   // your async request goes here ...
 *   // await something();
 *   this.pendingStatus = false;
 *   this.stepper.next();
 * }
 * ```
 */
export class C8yStepperButtons {
    constructor(stepper, step, gainsightService) {
        this.stepper = stepper;
        this.step = step;
        this.gainsightService = gainsightService;
        /**
         * Optional
         * Indicates if a request is pending and sets the next button
         * to disabled when true
         */
        this.pending = false;
        /**
         * Disabled state of a button
         */
        this.disabled = false;
        /**
         * EventEmitter which emits when cancel button is clicked
         */
        this.onCancel = new EventEmitter();
        /**
         * EventEmitter which emits {stepper: C8yStepper; step: CdkStep} when next button is clicked.
         */
        this.onNext = new EventEmitter();
        /**
         * EventEmitter which emits {stepper: C8yStepper; step: CdkStep} when back button is clicked.
         */
        this.onBack = new EventEmitter();
        /**
         * EventEmitter which emits when the optional custom button is clicked
         */
        this.onCustom = new EventEmitter();
        /**
         * Indicator which button should be shown.
         * Based on the cdk-steps within the c8y-stepper
         * next and back buttons are rendered.
         */
        this.showBtns = {
            cancel: false,
            back: false,
            next: false,
            custom: false
        };
        /**
         * Flag that indicates that the default settings defined in the showBtns have been overwritten.
         */
        this.forceShowBtns = false;
    }
    /**
     * This option forces the display of the buttons passed by the input.
     * It will override the default settings and take precedence over the standard settings.
     * @param btns An object that contains options for displaying buttons.
     *
     * **Example**
     * ```html
     *
     * <c8y-stepper-buttons
     *   [labels]="{ custom: 'Custom btn', cancel: 'Cancel btn' }"
     *   [showButtons]="{ custom: true, cancel: true }"
     * ></c8y-stepper-buttons>
     *
     * ```
     */
    set showButtons(btns) {
        if (btns) {
            this.showBtns = btns;
            this.forceShowBtns = true;
        }
    }
    /**
     * @ignore
     */
    ngAfterContentInit() {
        if (!this.forceShowBtns) {
            this.showBtns.cancel = this.onCancel.observers.length > 0;
            this.showBtns.custom = this.onCustom.observers.length > 0;
        }
        if (this.stepper && this.stepper._steps && this.step && !this.forceShowBtns) {
            this.showBtns.back = this.stepper._steps.first !== this.step;
            this.showBtns.next = this.stepper._steps.last !== this.step;
        }
        if (this.step && this.step.stepControl) {
            this.disabled = this.step.stepControl.invalid;
            this.statusChangeSubscription = this.step.stepControl.statusChanges.subscribe(() => {
                this.disabled = this.step.stepControl.invalid;
            });
        }
    }
    ngOnDestroy() {
        if (this.statusChangeSubscription && !this.statusChangeSubscription.closed) {
            this.statusChangeSubscription.unsubscribe();
        }
    }
    /**
     * Gets called when cancel button is clicked.
     * It will emit immediate.
     */
    cancel() {
        this.onCancel.emit();
        this.triggerEvent(ACTIONS.CLICK_STEPPER_CANCEL_BTN);
    }
    /**
     * Gets called when next button is clicked. When onNext EventEmitter has an observer registered
     * it will emit the following object {stepper: C8yStepper; step: CdkStep}.
     * Otherwise it will call stepper.next() as default.
     */
    next() {
        if (this.onNext.observers.length > 0) {
            this.onNext.emit({ stepper: this.stepper, step: this.step });
        }
        else {
            this.stepper.next();
        }
        this.triggerEvent(ACTIONS.CLICK_STEPPER_NEXT_BTN);
    }
    /**
     * Gets called when back button is clicked. When onBack EventEmitter has an observer registered
     * it will emit the following object {stepper: C8yStepper; step: CdkStep}.
     * Otherwise it will call stepper.previous() as default.
     */
    back() {
        this.stepper.selected.completed = false;
        if (this.onBack.observers.length > 0) {
            this.onBack.emit({ stepper: this.stepper, step: this.step });
        }
        else {
            this.stepper.previous();
        }
        this.triggerEvent(ACTIONS.CLICK_STEPPER_BACK_BTN);
    }
    /**
     * Gets called when the custom button is clicked.
     * It will emit immediately.
     */
    custom() {
        this.onCustom.emit();
        this.triggerEvent(ACTIONS.CLICK_STEPPER_CUSTOM_BTN);
    }
    triggerEvent(action) {
        const eventData = {
            ...this.stepper.productExperienceEvent?.data,
            action,
            step: this.gainsightService.translateToEnglish(this.step.label)
        };
        const eventName = this.stepper.productExperienceEvent?.eventName || 'c8yStepper';
        this.gainsightService.triggerEvent(eventName, eventData);
    }
}
C8yStepperButtons.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.7", ngImport: i0, type: C8yStepperButtons, deps: [{ token: i1.C8yStepper }, { token: i2.CdkStep }, { token: i3.GainsightService }], target: i0.ɵɵFactoryTarget.Component });
C8yStepperButtons.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.7", type: C8yStepperButtons, selector: "c8y-stepper-buttons", inputs: { labels: "labels", pending: "pending", disabled: "disabled", showButtons: "showButtons" }, outputs: { onCancel: "onCancel", onNext: "onNext", onBack: "onBack", onCustom: "onCustom" }, ngImport: i0, template: "<div class=\"text-center\">\n  <button\n    class=\"btn btn-default\"\n    title=\"{{ labels?.cancel | translate }}\"\n    type=\"button\"\n    *ngIf=\"showBtns.cancel\"\n    (click)=\"cancel()\"\n  >\n    <span\n      title=\"{{ labels?.cancel | translate }}\"\n      *ngIf=\"labels?.cancel; else cancelLabel\"\n    >\n      {{ labels?.cancel | translate }}\n    </span>\n    <ng-template #cancelLabel>\n      <span title=\"{{ 'Cancel' | translate }}\">{{ 'Cancel' | translate }}</span>\n    </ng-template>\n  </button>\n  <button\n    class=\"btn btn-default\"\n    title=\"{{ labels?.back | translate }}\"\n    title=\"{{ labels?.back || 'Back' | translate }}\"\n    type=\"button\"\n    *ngIf=\"showBtns.back\"\n    (click)=\"back()\"\n    [disabled]=\"pending\"\n    data-cy=\"back\"\n  >\n    <span\n      title=\"{{ labels?.back | translate }}\"\n      *ngIf=\"labels?.back; else backLabel\"\n    >\n      {{ labels?.back | translate }}\n    </span>\n    <ng-template #backLabel>\n      <span title=\"{{ 'Back' | translate }}\">{{ 'Back' | translate }}</span>\n    </ng-template>\n  </button>\n  <button\n    class=\"btn\"\n    title=\"{{ labels?.custom || 'Complete' | translate }}\"\n    type=\"button\"\n    *ngIf=\"showBtns.custom\"\n    (click)=\"custom()\"\n    [ngClass]=\"{\n      'btn-default': showBtns.next,\n      'btn-primary': !showBtns.next,\n      'btn-pending': pending\n    }\"\n    [disabled]=\"disabled\"\n    data-cy=\"custom\"\n  >\n    <span\n      title=\"{{ labels?.custom | translate }}\"\n      *ngIf=\"labels?.custom; else customLabel\"\n    >\n      {{ labels?.custom | translate }}\n    </span>\n    <ng-template #customLabel>\n      <span title=\"{{ 'Complete' | translate }}\">{{ 'Complete' | translate }}</span>\n    </ng-template>\n  </button>\n  <button\n    class=\"btn btn-primary\"\n    title=\"{{ labels?.next | translate }}\"\n    title=\"{{ labels?.next || 'Next' | translate }}\"\n    type=\"button\"\n    (click)=\"next()\"\n    *ngIf=\"showBtns.next\"\n    [ngClass]=\"{ 'btn-pending': pending }\"\n    [disabled]=\"disabled\"\n    data-cy=\"next\"\n  >\n    <span\n      title=\"{{ labels?.next | translate }}\"\n      *ngIf=\"labels?.next; else nextLabel\"\n    >\n      {{ labels?.next | translate }}\n    </span>\n    <ng-template #nextLabel>\n      <span title=\"{{ 'Next' | translate }}\">{{ 'Next' | translate }}</span>\n    </ng-template>\n  </button>\n  <ng-content select=\"button\"></ng-content>\n</div>\n", dependencies: [{ kind: "directive", type: i4.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i4.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "pipe", type: i5.C8yTranslatePipe, name: "translate" }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.7", ngImport: i0, type: C8yStepperButtons, decorators: [{
            type: Component,
            args: [{ selector: 'c8y-stepper-buttons', template: "<div class=\"text-center\">\n  <button\n    class=\"btn btn-default\"\n    title=\"{{ labels?.cancel | translate }}\"\n    type=\"button\"\n    *ngIf=\"showBtns.cancel\"\n    (click)=\"cancel()\"\n  >\n    <span\n      title=\"{{ labels?.cancel | translate }}\"\n      *ngIf=\"labels?.cancel; else cancelLabel\"\n    >\n      {{ labels?.cancel | translate }}\n    </span>\n    <ng-template #cancelLabel>\n      <span title=\"{{ 'Cancel' | translate }}\">{{ 'Cancel' | translate }}</span>\n    </ng-template>\n  </button>\n  <button\n    class=\"btn btn-default\"\n    title=\"{{ labels?.back | translate }}\"\n    title=\"{{ labels?.back || 'Back' | translate }}\"\n    type=\"button\"\n    *ngIf=\"showBtns.back\"\n    (click)=\"back()\"\n    [disabled]=\"pending\"\n    data-cy=\"back\"\n  >\n    <span\n      title=\"{{ labels?.back | translate }}\"\n      *ngIf=\"labels?.back; else backLabel\"\n    >\n      {{ labels?.back | translate }}\n    </span>\n    <ng-template #backLabel>\n      <span title=\"{{ 'Back' | translate }}\">{{ 'Back' | translate }}</span>\n    </ng-template>\n  </button>\n  <button\n    class=\"btn\"\n    title=\"{{ labels?.custom || 'Complete' | translate }}\"\n    type=\"button\"\n    *ngIf=\"showBtns.custom\"\n    (click)=\"custom()\"\n    [ngClass]=\"{\n      'btn-default': showBtns.next,\n      'btn-primary': !showBtns.next,\n      'btn-pending': pending\n    }\"\n    [disabled]=\"disabled\"\n    data-cy=\"custom\"\n  >\n    <span\n      title=\"{{ labels?.custom | translate }}\"\n      *ngIf=\"labels?.custom; else customLabel\"\n    >\n      {{ labels?.custom | translate }}\n    </span>\n    <ng-template #customLabel>\n      <span title=\"{{ 'Complete' | translate }}\">{{ 'Complete' | translate }}</span>\n    </ng-template>\n  </button>\n  <button\n    class=\"btn btn-primary\"\n    title=\"{{ labels?.next | translate }}\"\n    title=\"{{ labels?.next || 'Next' | translate }}\"\n    type=\"button\"\n    (click)=\"next()\"\n    *ngIf=\"showBtns.next\"\n    [ngClass]=\"{ 'btn-pending': pending }\"\n    [disabled]=\"disabled\"\n    data-cy=\"next\"\n  >\n    <span\n      title=\"{{ labels?.next | translate }}\"\n      *ngIf=\"labels?.next; else nextLabel\"\n    >\n      {{ labels?.next | translate }}\n    </span>\n    <ng-template #nextLabel>\n      <span title=\"{{ 'Next' | translate }}\">{{ 'Next' | translate }}</span>\n    </ng-template>\n  </button>\n  <ng-content select=\"button\"></ng-content>\n</div>\n" }]
        }], ctorParameters: function () { return [{ type: i1.C8yStepper }, { type: i2.CdkStep }, { type: i3.GainsightService }]; }, propDecorators: { labels: [{
                type: Input
            }], pending: [{
                type: Input
            }], disabled: [{
                type: Input
            }], onCancel: [{
                type: Output
            }], onNext: [{
                type: Output
            }], onBack: [{
                type: Output
            }], onCustom: [{
                type: Output
            }], showButtons: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RlcHBlci1idXR0b25zLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL2NvcmUvc3RlcHBlci9zdGVwcGVyLWJ1dHRvbnMuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vY29yZS9zdGVwcGVyL3N0ZXBwZXItYnV0dG9ucy5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDL0MsT0FBTyxFQUFvQixTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBYSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFcEcsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0seUNBQXlDLENBQUM7QUFDM0UsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ2pELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQzs7Ozs7OztBQUdqRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQWlERztBQUtILE1BQU0sT0FBTyxpQkFBaUI7SUFzRDVCLFlBQ1UsT0FBbUIsRUFDbkIsSUFBYSxFQUNiLGdCQUFrQztRQUZsQyxZQUFPLEdBQVAsT0FBTyxDQUFZO1FBQ25CLFNBQUksR0FBSixJQUFJLENBQVM7UUFDYixxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWtCO1FBbkQ1Qzs7OztXQUlHO1FBQ00sWUFBTyxHQUFhLEtBQUssQ0FBQztRQUVuQzs7V0FFRztRQUNNLGFBQVEsR0FBYSxLQUFLLENBQUM7UUFFcEM7O1dBRUc7UUFDTyxhQUFRLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUN4Qzs7V0FFRztRQUNPLFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBMEMsQ0FBQztRQUU5RTs7V0FFRztRQUNPLFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBMEMsQ0FBQztRQUU5RTs7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QUFTOytCQUNFLHFCQUFxQjtzSkFRdEIsTUFBTTtzQkFBZCxLQUFLO2dCQU1HLE9BQU87c0JBQWYsS0FBSztnQkFLRyxRQUFRO3NCQUFoQixLQUFLO2dCQUtJLFFBQVE7c0JBQWpCLE1BQU07Z0JBSUcsTUFBTTtzQkFBZixNQUFNO2dCQUtHLE1BQU07c0JBQWYsTUFBTTtnQkFLRyxRQUFRO3NCQUFqQixNQUFNO2dCQXdDTSxXQUFXO3NCQUF2QixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2RrU3RlcCB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9zdGVwcGVyJztcbmltcG9ydCB7IEFmdGVyQ29udGVudEluaXQsIENvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgT25EZXN0cm95LCBPdXRwdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgR2FpbnNpZ2h0U2VydmljZSB9IGZyb20gJy4uL3Byb2R1Y3QtZXhwZXJpZW5jZS9nYWluc2lnaHQuc2VydmljZSc7XG5pbXBvcnQgeyBBQ1RJT05TIH0gZnJvbSAnLi9zdGVwcGVyLXB4LmNvbnN0YW50cyc7XG5pbXBvcnQgeyBDOHlTdGVwcGVyIH0gZnJvbSAnLi9zdGVwcGVyLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBTdGVwcGVyQnV0dG9uc1Zpc2liaWxpdHkgfSBmcm9tICcuL3N0ZXBwZXIubW9kZWwnO1xuXG4vKipcbiAqIEM4eVN0ZXBwZXJCdXR0b25zIHByb3ZpZGVzIGEgY29udmVuaWVudCB3YXkgdG8gaGF2ZSwgYWNjb3JkaW5nIHRvXG4gKiB0aGUgQzh5U3RlcHBlciBhbmQgZWFjaCBjZGstc3RlcCwgYnV0dG9ucyB0byBuYXZpZ2F0ZSBiZXR3ZWVuIHN0ZXBzIG9yIHRvIGNhbmNlbCB0aGUgd2hvbGVcbiAqIHN0ZXAtcHJvY2Vzcy4gQnV0dG9ucyByZW5kZXJlZCB3aXRoIHRoZSBoZWxwIG9mIHRoaXMgY29tcG9uZW50IHdpbGwgdXNlIHRoZSBicmFuZGluZyBjc3MuXG4gKlxuICogQnkgZGVmYXVsdCBhbGwgc3RlcHMgd2l0aCB0aGlzIGNvbXBvbmVudCBpbiB1c2Ugd2lsbCByZW5kZXIgYSBuZXh0IGJ1dHRvbiwgZXhwZWN0IHRoZSBsYXN0IHN0ZXAuXG4gKiBUaGUgb3RoZXIgd2F5IGFyb3VuZCwgZXZlcnkgc3RlcCB1c2luZyB0aGlzIGNvbXBvbmVudCB3aWxsIHJlbmRlciBhIGJhY2sgYnV0dG9uLCBleHBlY3QgdGhlIGZpcnN0IHN0ZXAuXG4gKiBUbyBnZXQgYSBjYW5jZWwgYnV0dG9uIHJlbmRlcmVkIHlvdSBuZWVkIHRvIGhhbmRsZSB0aGUgb25DYW5jZWwgZXZlbnQuXG4gKiBGb3IgbmV4dCBhbmQgYmFjayBidXR0b24geW91IGRvbid0IG5lZWQgdG8gaGFuZGxlIHRoZSBhdmFpbGFibGUgZXZlbnRzIG9uTmV4dCBhbmQgb25CYWNrIGJlY2F1c2UgZGVmYXVsdCBiZWhhdmlvclxuICogaXMgaW1wbGVtZW50ZWQuIFRoZSBkZWZhdWx0IHdpbGwganVzdCBjYWxsLCBhY2NvcmRpbmcgdG8gdGhlIGJ1dHRvbiwgdGhlIHN0ZXBwZXIubmV4dCgpIG9yIHN0ZXBwZXIucHJldmlvdXMoKVxuICogbWV0aG9kcyBhbmQgbW92ZXMgdGhlIHN0ZXBwZXIgZm9ydGggb3IgYmFjay4gVXNpbmcgdGhlIEV2ZW50RW1pdHRlciBvbk5leHQgYW5kIG9uQmFjayB3aWxsIGVtaXQgZm9yIHlvdSB0aGUgZm9sbG93aW5nXG4gKiBvYmplY3Q6IHtzdGVwcGVyOiBDOHlTdGVwcGVyLCBzdGVwOiBDZGtTdGVwfS4gVGhpcyBpcyB1c2VmdWwgaWYgeW91IG5lZWQgdG8gaW1wbGVtZW50IGN1c3RvbSBsb2dpYyBiZWZvcmUgbW92aW5nXG4gKiB0byB0aGUgbmV4dCBzdGVwIG9yIHNlbmRpbmcgZGF0YSB0byBhIGJhY2tlbmQuIEluIHRoaXMgY2FzZSB5b3UgbmVlZCB0byB0ZWxsIHRoZSBzdGVwcGVyIHRvIG1vdmUgZm9yd2FyZCBvciBiYWNrXG4gKiBvbiB5b3VyIG93bi5cbiAqXG4gKiBXaXRoIHRoZSBjb21wb25lbnQgaW5wdXQgW2xhYmVsc10geW91IGNhbiBjaGFuZ2UgdGhlIGxhYmVsIG9mIGVhY2ggYnV0dG9uIGluIGVhY2ggc3RlcC4gSXQgdGFrZXMgYW4gb2JqZWN0IGxpa2UgdGhpczpcbiAqIHtuZXh0Pzogc3RyaW5nLCBiYWNrPzogc3RyaW5nLCBjYW5jZWw/OiBzdHJpbmd9XG4gKlxuICogVGhlIFtwZW5kaW5nXSBpbnB1dCBpcyBvZiB0eXBlIGJvb2xlYW4gYW5kIHdpbGwgZW5hYmxlIGNzcyBhbmltYXRpb24gZm9yIHRoZSBuZXh0IGJ1dHRvbiB3aGVuIHRydWUuXG4gKlxuICogSWYgdGhlIGNkay1zdGVwIHByb3ZpZGVzIGEgc3RlcENvbnRyb2wgdGhlIGNvbXBvbmVudCB3aWxsIHNldCB0aGUgbmV4dCBidXR0b24gZGlzYWJsZWQgd2hlbiB0aGUgZm9ybUdyb3VwXG4gKiBiZWhpbmQgaXQgaXMgaW52YWxpZC4gQXMgbG9uZyBhcyB0aGUgW3BlbmRpbmddIGlucHV0IGlzIHRydWUgdGhlIGJhY2sgYW5kIG5leHQgYnV0dG9uIGlzIGFsc28gZGlzYWJsZWQuXG4gKiBUaGlzIHdpbGwgcHJldmVudCBtdWx0aXBsZSBjbGlja3Mgd2hpbGUgcnVubmluZyBhIHJlcXVlc3Qgb3Igc3RlcHBpbmcgYmFjayB3aGlsZSBhIHJlcXVlc3QgaXMgb25nb2luZy5cbiAqXG4gKiAqKkV4YW1wbGUqKlxuICogYGBgXG4gKiA8Yzh5LXN0ZXBwZXI+XG4gKiAgPGNkay1zdGVwPlxuICogICAgPCEtLVxuICogICAgICB5b3VyIGh0bWwgY29kZVxuICogICAgICAgICAgLi4uXG4gKiAgICAgICAgICAuLi4gICAgLS0+XG4gKiAgICA8Yzh5LXN0ZXBwZXItYnV0dG9uc1xuICogICAgIChvbk5leHQpPVwic2F2ZSgpXCJcbiAqICAgICBbbGFiZWxzXT1cInsgbmV4dDogJ1NhdmUnIH1cIlxuICogICAgIFtwZW5kaW5nXT1cInBlbmRpbmdTdGF0dXNcIlxuICogICAgID48L2M4eS1zdGVwcGVyLWJ1dHRvbnM+XG4gKiAgPC9jZGstc3RlcD5cbiAqIDwvYzh5LXN0ZXBwZXI+XG4gKlxuICogLy8gaW4geW91ciBjb21wb25lbnQ6XG4gKiBhc3luYyBzYXZlKCkge1xuICogICB0aGlzLnBlbmRpbmdTdGF0dXMgPSB0cnVlO1xuICogICAvLyB5b3VyIGFzeW5jIHJlcXVlc3QgZ29lcyBoZXJlIC4uLlxuICogICAvLyBhd2FpdCBzb21ldGhpbmcoKTtcbiAqICAgdGhpcy5wZW5kaW5nU3RhdHVzID0gZmFsc2U7XG4gKiAgIHRoaXMuc3RlcHBlci5uZXh0KCk7XG4gKiB9XG4gKiBgYGBcbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYzh5LXN0ZXBwZXItYnV0dG9ucycsXG4gIHRlbXBsYXRlVXJsOiAnLi9zdGVwcGVyLWJ1dHRvbnMuY29tcG9uZW50Lmh0bWwnXG59KVxuZXhwb3J0IGNsYXNzIEM4eVN0ZXBwZXJCdXR0b25zIGltcGxlbWVudHMgQWZ0ZXJDb250ZW50SW5pdCwgT25EZXN0cm95IHtcbiAgLyoqXG4gICAqIE9wdGlvbmFsXG4gICAqIFNwZWNpZnkgY3VzdG9tIGxhYmVscyBmb3IgZWFjaCBidXR0b24gKGNhbmNlbCwgYmFjayBvciBuZXh0KVxuICAgKi9cbiAgQElucHV0KCkgbGFiZWxzPzogeyBjYW5jZWw/OiBzdHJpbmc7IGJhY2s/OiBzdHJpbmc7IG5leHQ/OiBzdHJpbmc7IGN1c3RvbT86IHN0cmluZyB9O1xuICAvKipcbiAgICogT3B0aW9uYWxcbiAgICogSW5kaWNhdGVzIGlmIGEgcmVxdWVzdCBpcyBwZW5kaW5nIGFuZCBzZXRzIHRoZSBuZXh0IGJ1dHRvblxuICAgKiB0byBkaXNhYmxlZCB3aGVuIHRydWVcbiAgICovXG4gIEBJbnB1dCgpIHBlbmRpbmc/OiBib29sZWFuID0gZmFsc2U7XG5cbiAgLyoqXG4gICAqIERpc2FibGVkIHN0YXRlIG9mIGEgYnV0dG9uXG4gICAqL1xuICBASW5wdXQoKSBkaXNhYmxlZD86IGJvb2xlYW4gPSBmYWxzZTtcblxuICAvKipcbiAgICogRXZlbnRFbWl0dGVyIHdoaWNoIGVtaXRzIHdoZW4gY2FuY2VsIGJ1dHRvbiBpcyBjbGlja2VkXG4gICAqL1xuICBAT3V0cHV0KCkgb25DYW5jZWwgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIC8qKlxuICAgKiBFdmVudEVtaXR0ZXIgd2hpY2ggZW1pdHMge3N0ZXBwZXI6IEM4eVN0ZXBwZXI7IHN0ZXA6IENka1N0ZXB9IHdoZW4gbmV4dCBidXR0b24gaXMgY2xpY2tlZC5cbiAgICovXG4gIEBPdXRwdXQoKSBvbk5leHQgPSBuZXcgRXZlbnRFbWl0dGVyPHsgc3RlcHBlcjogQzh5U3RlcHBlcjsgc3RlcDogQ2RrU3RlcCB9PigpO1xuXG4gIC8qKlxuICAgKiBFdmVudEVtaXR0ZXIgd2hpY2ggZW1pdHMge3N0ZXBwZXI6IEM4eVN0ZXBwZXI7IHN0ZXA6IENka1N0ZXB9IHdoZW4gYmFjayBidXR0b24gaXMgY2xpY2tlZC5cbiAgICovXG4gIEBPdXRwdXQoKSBvbkJhY2sgPSBuZXcgRXZlbnRFbWl0dGVyPHsgc3RlcHBlcjogQzh5U3RlcHBlcjsgc3RlcDogQ2RrU3RlcCB9PigpO1xuXG4gIC8qKlxuICAgKiBFdmVudEVtaXR0ZXIgd2hpY2ggZW1pdHMgd2hlbiB0aGUgb3B0aW9uYWwgY3VzdG9tIGJ1dHRvbiBpcyBjbGlja2VkXG4gICAqL1xuICBAT3V0cHV0KCkgb25DdXN0b20gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgLyoqXG4gICAqIEluZGljYXRvciB3aGljaCBidXR0b24gc2hvdWxkIGJlIHNob3duLlxuICAgKiBCYXNlZCBvbiB0aGUgY2RrLXN0ZXBzIHdpdGhpbiB0aGUgYzh5LXN0ZXBwZXJcbiAgICogbmV4dCBhbmQgYmFjayBidXR0b25zIGFyZSByZW5kZXJlZC5cbiAgICovXG4gIHNob3dCdG5zOiBTdGVwcGVyQnV0dG9uc1Zpc2liaWxpdHkgPSB7XG4gICAgY2FuY2VsOiBmYWxzZSxcbiAgICBiYWNrOiBmYWxzZSxcbiAgICBuZXh0OiBmYWxzZSxcbiAgICBjdXN0b206IGZhbHNlXG4gIH07XG4gIC8qKlxuICAgKiBGbGFnIHRoYXQgaW5kaWNhdGVzIHRoYXQgdGhlIGRlZmF1bHQgc2V0dGluZ3MgZGVmaW5lZCBpbiB0aGUgc2hvd0J0bnMgaGF2ZSBiZWVuIG92ZXJ3cml0dGVuLlxuICAgKi9cbiAgZm9yY2VTaG93QnRucyA9IGZhbHNlO1xuXG4gIHByaXZhdGUgc3RhdHVzQ2hhbmdlU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgc3RlcHBlcjogQzh5U3RlcHBlcixcbiAgICBwcml2YXRlIHN0ZXA6IENka1N0ZXAsXG4gICAgcHJpdmF0ZSBnYWluc2lnaHRTZXJ2aWNlOiBHYWluc2lnaHRTZXJ2aWNlXG4gICkge31cblxuICAvKipcbiAgICogVGhpcyBvcHRpb24gZm9yY2VzIHRoZSBkaXNwbGF5IG9mIHRoZSBidXR0b25zIHBhc3NlZCBieSB0aGUgaW5wdXQuXG4gICAqIEl0IHdpbGwgb3ZlcnJpZGUgdGhlIGRlZmF1bHQgc2V0dGluZ3MgYW5kIHRha2UgcHJlY2VkZW5jZSBvdmVyIHRoZSBzdGFuZGFyZCBzZXR0aW5ncy5cbiAgICogQHBhcmFtIGJ0bnMgQW4gb2JqZWN0IHRoYXQgY29udGFpbnMgb3B0aW9ucyBmb3IgZGlzcGxheWluZyBidXR0b25zLlxuICAgKlxuICAgKiAqKkV4YW1wbGUqKlxuICAgKiBgYGBodG1sXG4gICAqXG4gICAqIDxjOHktc3RlcHBlci1idXR0b25zXG4gICAqICAgW2xhYmVsc109XCJ7IGN1c3RvbTogJ0N1c3RvbSBidG4nLCBjYW5jZWw6ICdDYW5jZWwgYnRuJyB9XCJcbiAgICogICBbc2hvd0J1dHRvbnNdPVwieyBjdXN0b206IHRydWUsIGNhbmNlbDogdHJ1ZSB9XCJcbiAgICogPjwvYzh5LXN0ZXBwZXItYnV0dG9ucz5cbiAgICpcbiAgICogYGBgXG4gICAqL1xuICBASW5wdXQoKSBzZXQgc2hvd0J1dHRvbnMoYnRuczogU3RlcHBlckJ1dHRvbnNWaXNpYmlsaXR5KSB7XG4gICAgaWYgKGJ0bnMpIHtcbiAgICAgIHRoaXMuc2hvd0J0bnMgPSBidG5zO1xuICAgICAgdGhpcy5mb3JjZVNob3dCdG5zID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgbmdBZnRlckNvbnRlbnRJbml0KCkge1xuICAgIGlmICghdGhpcy5mb3JjZVNob3dCdG5zKSB7XG4gICAgICB0aGlzLnNob3dCdG5zLmNhbmNlbCA9IHRoaXMub25DYW5jZWwub2JzZXJ2ZXJzLmxlbmd0aCA+IDA7XG4gICAgICB0aGlzLnNob3dCdG5zLmN1c3RvbSA9IHRoaXMub25DdXN0b20ub2JzZXJ2ZXJzLmxlbmd0aCA+IDA7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc3RlcHBlciAmJiB0aGlzLnN0ZXBwZXIuX3N0ZXBzICYmIHRoaXMuc3RlcCAmJiAhdGhpcy5mb3JjZVNob3dCdG5zKSB7XG4gICAgICB0aGlzLnNob3dCdG5zLmJhY2sgPSB0aGlzLnN0ZXBwZXIuX3N0ZXBzLmZpcnN0ICE9PSB0aGlzLnN0ZXA7XG4gICAgICB0aGlzLnNob3dCdG5zLm5leHQgPSB0aGlzLnN0ZXBwZXIuX3N0ZXBzLmxhc3QgIT09IHRoaXMuc3RlcDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zdGVwICYmIHRoaXMuc3RlcC5zdGVwQ29udHJvbCkge1xuICAgICAgdGhpcy5kaXNhYmxlZCA9IHRoaXMuc3RlcC5zdGVwQ29udHJvbC5pbnZhbGlkO1xuXG4gICAgICB0aGlzLnN0YXR1c0NoYW5nZVN1YnNjcmlwdGlvbiA9IHRoaXMuc3RlcC5zdGVwQ29udHJvbC5zdGF0dXNDaGFuZ2VzLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgIHRoaXMuZGlzYWJsZWQgPSB0aGlzLnN0ZXAuc3RlcENvbnRyb2wuaW52YWxpZDtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIGlmICh0aGlzLnN0YXR1c0NoYW5nZVN1YnNjcmlwdGlvbiAmJiAhdGhpcy5zdGF0dXNDaGFuZ2VTdWJzY3JpcHRpb24uY2xvc2VkKSB7XG4gICAgICB0aGlzLnN0YXR1c0NoYW5nZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIGNhbGxlZCB3aGVuIGNhbmNlbCBidXR0b24gaXMgY2xpY2tlZC5cbiAgICogSXQgd2lsbCBlbWl0IGltbWVkaWF0ZS5cbiAgICovXG4gIGNhbmNlbCgpIHtcbiAgICB0aGlzLm9uQ2FuY2VsLmVtaXQoKTtcbiAgICB0aGlzLnRyaWdnZXJFdmVudChBQ1RJT05TLkNMSUNLX1NURVBQRVJfQ0FOQ0VMX0JUTik7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyBjYWxsZWQgd2hlbiBuZXh0IGJ1dHRvbiBpcyBjbGlja2VkLiBXaGVuIG9uTmV4dCBFdmVudEVtaXR0ZXIgaGFzIGFuIG9ic2VydmVyIHJlZ2lzdGVyZWRcbiAgICogaXQgd2lsbCBlbWl0IHRoZSBmb2xsb3dpbmcgb2JqZWN0IHtzdGVwcGVyOiBDOHlTdGVwcGVyOyBzdGVwOiBDZGtTdGVwfS5cbiAgICogT3RoZXJ3aXNlIGl0IHdpbGwgY2FsbCBzdGVwcGVyLm5leHQoKSBhcyBkZWZhdWx0LlxuICAgKi9cbiAgbmV4dCgpIHtcbiAgICBpZiAodGhpcy5vbk5leHQub2JzZXJ2ZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMub25OZXh0LmVtaXQoeyBzdGVwcGVyOiB0aGlzLnN0ZXBwZXIsIHN0ZXA6IHRoaXMuc3RlcCB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zdGVwcGVyLm5leHQoKTtcbiAgICB9XG4gICAgdGhpcy50cmlnZ2VyRXZlbnQoQUNUSU9OUy5DTElDS19TVEVQUEVSX05FWFRfQlROKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIGNhbGxlZCB3aGVuIGJhY2sgYnV0dG9uIGlzIGNsaWNrZWQuIFdoZW4gb25CYWNrIEV2ZW50RW1pdHRlciBoYXMgYW4gb2JzZXJ2ZXIgcmVnaXN0ZXJlZFxuICAgKiBpdCB3aWxsIGVtaXQgdGhlIGZvbGxvd2luZyBvYmplY3Qge3N0ZXBwZXI6IEM4eVN0ZXBwZXI7IHN0ZXA6IENka1N0ZXB9LlxuICAgKiBPdGhlcndpc2UgaXQgd2lsbCBjYWxsIHN0ZXBwZXIucHJldmlvdXMoKSBhcyBkZWZhdWx0LlxuICAgKi9cbiAgYmFjaygpIHtcbiAgICB0aGlzLnN0ZXBwZXIuc2VsZWN0ZWQuY29tcGxldGVkID0gZmFsc2U7XG4gICAgaWYgKHRoaXMub25CYWNrLm9ic2VydmVycy5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLm9uQmFjay5lbWl0KHsgc3RlcHBlcjogdGhpcy5zdGVwcGVyLCBzdGVwOiB0aGlzLnN0ZXAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3RlcHBlci5wcmV2aW91cygpO1xuICAgIH1cbiAgICB0aGlzLnRyaWdnZXJFdmVudChBQ1RJT05TLkNMSUNLX1NURVBQRVJfQkFDS19CVE4pO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgY2FsbGVkIHdoZW4gdGhlIGN1c3RvbSBidXR0b24gaXMgY2xpY2tlZC5cbiAgICogSXQgd2lsbCBlbWl0IGltbWVkaWF0ZWx5LlxuICAgKi9cbiAgY3VzdG9tKCkge1xuICAgIHRoaXMub25DdXN0b20uZW1pdCgpO1xuICAgIHRoaXMudHJpZ2dlckV2ZW50KEFDVElPTlMuQ0xJQ0tfU1RFUFBFUl9DVVNUT01fQlROKTtcbiAgfVxuXG4gIHByaXZhdGUgdHJpZ2dlckV2ZW50KGFjdGlvbjogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgZXZlbnREYXRhID0ge1xuICAgICAgLi4udGhpcy5zdGVwcGVyLnByb2R1Y3RFeHBlcmllbmNlRXZlbnQ/LmRhdGEsXG4gICAgICBhY3Rpb24sXG4gICAgICBzdGVwOiB0aGlzLmdhaW5zaWdodFNlcnZpY2UudHJhbnNsYXRlVG9FbmdsaXNoKHRoaXMuc3RlcC5sYWJlbClcbiAgICB9O1xuICAgIGNvbnN0IGV2ZW50TmFtZSA9IHRoaXMuc3RlcHBlci5wcm9kdWN0RXhwZXJpZW5jZUV2ZW50Py5ldmVudE5hbWUgfHwgJ2M4eVN0ZXBwZXInO1xuICAgIHRoaXMuZ2FpbnNpZ2h0U2VydmljZS50cmlnZ2VyRXZlbnQoZXZlbnROYW1lLCBldmVudERhdGEpO1xuICB9XG59XG4iLCI8ZGl2IGNsYXNzPVwidGV4dC1jZW50ZXJcIj5cbiAgPGJ1dHRvblxuICAgIGNsYXNzPVwiYnRuIGJ0bi1kZWZhdWx0XCJcbiAgICB0aXRsZT1cInt7IGxhYmVscz8uY2FuY2VsIHwgdHJhbnNsYXRlIH19XCJcbiAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAqbmdJZj1cInNob3dCdG5zLmNhbmNlbFwiXG4gICAgKGNsaWNrKT1cImNhbmNlbCgpXCJcbiAgPlxuICAgIDxzcGFuXG4gICAgICB0aXRsZT1cInt7IGxhYmVscz8uY2FuY2VsIHwgdHJhbnNsYXRlIH19XCJcbiAgICAgICpuZ0lmPVwibGFiZWxzPy5jYW5jZWw7IGVsc2UgY2FuY2VsTGFiZWxcIlxuICAgID5cbiAgICAgIHt7IGxhYmVscz8uY2FuY2VsIHwgdHJhbnNsYXRlIH19XG4gICAgPC9zcGFuPlxuICAgIDxuZy10ZW1wbGF0ZSAjY2FuY2VsTGFiZWw+XG4gICAgICA8c3BhbiB0aXRsZT1cInt7ICdDYW5jZWwnIHwgdHJhbnNsYXRlIH19XCI+e3sgJ0NhbmNlbCcgfCB0cmFuc2xhdGUgfX08L3NwYW4+XG4gICAgPC9uZy10ZW1wbGF0ZT5cbiAgPC9idXR0b24+XG4gIDxidXR0b25cbiAgICBjbGFzcz1cImJ0biBidG4tZGVmYXVsdFwiXG4gICAgdGl0bGU9XCJ7eyBsYWJlbHM/LmJhY2sgfCB0cmFuc2xhdGUgfX1cIlxuICAgIHRpdGxlPVwie3sgbGFiZWxzPy5iYWNrIHx8ICdCYWNrJyB8IHRyYW5zbGF0ZSB9fVwiXG4gICAgdHlwZT1cImJ1dHRvblwiXG4gICAgKm5nSWY9XCJzaG93QnRucy5iYWNrXCJcbiAgICAoY2xpY2spPVwiYmFjaygpXCJcbiAgICBbZGlzYWJsZWRdPVwicGVuZGluZ1wiXG4gICAgZGF0YS1jeT1cImJhY2tcIlxuICA+XG4gICAgPHNwYW5cbiAgICAgIHRpdGxlPVwie3sgbGFiZWxzPy5iYWNrIHwgdHJhbnNsYXRlIH19XCJcbiAgICAgICpuZ0lmPVwibGFiZWxzPy5iYWNrOyBlbHNlIGJhY2tMYWJlbFwiXG4gICAgPlxuICAgICAge3sgbGFiZWxzPy5iYWNrIHwgdHJhbnNsYXRlIH19XG4gICAgPC9zcGFuPlxuICAgIDxuZy10ZW1wbGF0ZSAjYmFja0xhYmVsPlxuICAgICAgPHNwYW4gdGl0bGU9XCJ7eyAnQmFjaycgfCB0cmFuc2xhdGUgfX1cIj57eyAnQmFjaycgfCB0cmFuc2xhdGUgfX08L3NwYW4+XG4gICAgPC9uZy10ZW1wbGF0ZT5cbiAgPC9idXR0b24+XG4gIDxidXR0b25cbiAgICBjbGFzcz1cImJ0blwiXG4gICAgdGl0bGU9XCJ7eyBsYWJlbHM/LmN1c3RvbSB8fCAnQ29tcGxldGUnIHwgdHJhbnNsYXRlIH19XCJcbiAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAqbmdJZj1cInNob3dCdG5zLmN1c3RvbVwiXG4gICAgKGNsaWNrKT1cImN1c3RvbSgpXCJcbiAgICBbbmdDbGFzc109XCJ7XG4gICAgICAnYnRuLWRlZmF1bHQnOiBzaG93QnRucy5uZXh0LFxuICAgICAgJ2J0bi1wcmltYXJ5JzogIXNob3dCdG5zLm5leHQsXG4gICAgICAnYnRuLXBlbmRpbmcnOiBwZW5kaW5nXG4gICAgfVwiXG4gICAgW2Rpc2FibGVkXT1cImRpc2FibGVkXCJcbiAgICBkYXRhLWN5PVwiY3VzdG9tXCJcbiAgPlxuICAgIDxzcGFuXG4gICAgICB0aXRsZT1cInt7IGxhYmVscz8uY3VzdG9tIHwgdHJhbnNsYXRlIH19XCJcbiAgICAgICpuZ0lmPVwibGFiZWxzPy5jdXN0b207IGVsc2UgY3VzdG9tTGFiZWxcIlxuICAgID5cbiAgICAgIHt7IGxhYmVscz8uY3VzdG9tIHwgdHJhbnNsYXRlIH19XG4gICAgPC9zcGFuPlxuICAgIDxuZy10ZW1wbGF0ZSAjY3VzdG9tTGFiZWw+XG4gICAgICA8c3BhbiB0aXRsZT1cInt7ICdDb21wbGV0ZScgfCB0cmFuc2xhdGUgfX1cIj57eyAnQ29tcGxldGUnIHwgdHJhbnNsYXRlIH19PC9zcGFuPlxuICAgIDwvbmctdGVtcGxhdGU+XG4gIDwvYnV0dG9uPlxuICA8YnV0dG9uXG4gICAgY2xhc3M9XCJidG4gYnRuLXByaW1hcnlcIlxuICAgIHRpdGxlPVwie3sgbGFiZWxzPy5uZXh0IHwgdHJhbnNsYXRlIH19XCJcbiAgICB0aXRsZT1cInt7IGxhYmVscz8ubmV4dCB8fCAnTmV4dCcgfCB0cmFuc2xhdGUgfX1cIlxuICAgIHR5cGU9XCJidXR0b25cIlxuICAgIChjbGljayk9XCJuZXh0KClcIlxuICAgICpuZ0lmPVwic2hvd0J0bnMubmV4dFwiXG4gICAgW25nQ2xhc3NdPVwieyAnYnRuLXBlbmRpbmcnOiBwZW5kaW5nIH1cIlxuICAgIFtkaXNhYmxlZF09XCJkaXNhYmxlZFwiXG4gICAgZGF0YS1jeT1cIm5leHRcIlxuICA+XG4gICAgPHNwYW5cbiAgICAgIHRpdGxlPVwie3sgbGFiZWxzPy5uZXh0IHwgdHJhbnNsYXRlIH19XCJcbiAgICAgICpuZ0lmPVwibGFiZWxzPy5uZXh0OyBlbHNlIG5leHRMYWJlbFwiXG4gICAgPlxuICAgICAge3sgbGFiZWxzPy5uZXh0IHwgdHJhbnNsYXRlIH19XG4gICAgPC9zcGFuPlxuICAgIDxuZy10ZW1wbGF0ZSAjbmV4dExhYmVsPlxuICAgICAgPHNwYW4gdGl0bGU9XCJ7eyAnTmV4dCcgfCB0cmFuc2xhdGUgfX1cIj57eyAnTmV4dCcgfCB0cmFuc2xhdGUgfX08L3NwYW4+XG4gICAgPC9uZy10ZW1wbGF0ZT5cbiAgPC9idXR0b24+XG4gIDxuZy1jb250ZW50IHNlbGVjdD1cImJ1dHRvblwiPjwvbmctY29udGVudD5cbjwvZGl2PlxuIl19
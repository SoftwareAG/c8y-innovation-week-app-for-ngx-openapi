// tslint:disable-next-line:max-line-length
import { Component, EventEmitter, Input, Output, ViewChild, ViewContainerRef } from '@angular/core';
import { ActivationEnd, Router } from '@angular/router';
import { Subject, merge } from 'rxjs';
import { distinctUntilChanged, filter, map, tap } from 'rxjs/operators';
import { PopoverConfirmComponent } from '../modal/popover-confirm.component';
import { NavigatorIconComponent } from './navigator-icon.component';
import { NavigatorNode } from './navigator-node';
import { isUndefined } from 'lodash-es';
import * as i0 from "@angular/core";
import * as i1 from "@angular/router";
import * as i2 from "ngx-bootstrap/collapse";
import * as i3 from "../common/icon.directive";
import * as i4 from "@angular/common";
import * as i5 from "../modal/popover-confirm.component";
import * as i6 from "../i18n/c8y-translate.pipe";
/**
 * Navigator node renderer.
 */
export class NavigatorNodeComponent {
    constructor(router) {
        this.router = router;
        /**
         * Event emitter responsible for broadcasting one of the following events: "icon", "expander" or "link" as string value.
         *
         * The type of event depends on where you click on the navigator node:
         * * clicking the icon will broadcast the event "icon",
         * * clicking the expander will broadcast the event "expander",
         * * clicking the label will broadcast the event "link".
         */
        this.nodeClick = new EventEmitter();
        /**
         * A subject that is triggered as soon as the navigator node is initialized.
         */
        this.nodeInit$ = new Subject();
        /**
         * A observable which emits, as soon as the active state of the node changes.
         */
        this.isActive$ = merge(this.nodeInit$, this.router.events.pipe(filter(e => e instanceof ActivationEnd))).pipe(map(() => {
            if (isUndefined(this.node.path)) {
                return false;
            }
            return this.router.isActive(this.node.path, this.node.routerLinkExact);
        }), distinctUntilChanged(), tap(isActive => {
            if (isActive) {
                this.expandCollapse(true);
                this.expandRecursiveParent(this.node.parents);
            }
        }));
    }
    /**
     * @ignore
     */
    ngAfterViewInit() {
        if (!this.node.component) {
            this.viewInitTimeout = setTimeout(() => {
                this.updateIcon();
                this.node.confirm = this.confirm;
                this.nodeInit$.next();
            });
        }
    }
    /**
     * Returns the expander title.
     */
    get expandTitle() {
        return !this.node.open ? 'Expand' : 'Collapse';
    }
    /**
     * Click event handler.
     *
     * @param {string} from Source of the click event.
     * @param event DOM event.
     */
    click(from = 'link', $event) {
        let open;
        switch (from) {
            case "expander" /* ClickEventSource.EXPANDER */:
                if ($event) {
                    $event.preventDefault();
                    $event.stopPropagation();
                }
                open = !this.node.open;
                break;
            case "icon" /* ClickEventSource.ICON */:
            case "link" /* ClickEventSource.LINK */:
                open = this.router.isActive(this.node.path, this.node.routerLinkExact)
                    ? true
                    : !this.node.open;
                break;
        }
        this.handleExpandCollapse(open, from, $event);
        this.nodeClick.emit(from);
    }
    /**
     * Expands or collapses the navigator node and its children recursively.
     *
     * @param {boolean} open Open or close the node.
     * @param {ClickOptions} forNode Click options.
     */
    expandCollapse(open, forNode = {}) {
        this.node.open = open;
        forNode.open = open;
        this.node.click(forNode);
    }
    /**
     * @ignore
     */
    ngOnDestroy() {
        clearTimeout(this.viewInitTimeout);
        if (this.node) {
            this.node.destroy();
        }
    }
    /**
     * Expands the parent nodes recursively.
     * @param nodes The nodes that should be tried to get opened.
     * @param clickOption The click options to perform on the parent nodes.
     */
    expandRecursiveParent(nodes, clickOption = { expander: true }) {
        nodes.forEach(parentNode => {
            if (!parentNode.open) {
                parentNode.open = true;
                parentNode.click(clickOption);
            }
            this.expandRecursiveParent(parentNode.parents, clickOption);
        });
    }
    handleExpandCollapse(open, from, $event) {
        if (open === this.node.open ||
            (this.node.path && !open && from !== "expander" /* ClickEventSource.EXPANDER */)) {
            return;
        }
        this.expandCollapse(open, { [from]: true, $event });
    }
    updateIcon() {
        if (this.node.iconTemplate) {
            this.updateIconTemplate();
        }
        else {
            this.updateIconComponent();
        }
    }
    updateIconComponent() {
        let componentType = NavigatorIconComponent;
        if (this.node && this.node.iconComponent) {
            componentType = this.node.iconComponent;
        }
        this.iconSlot.clear();
        const componentRef = this.iconSlot.createComponent(componentType, {
            injector: this.node.injector
        });
        componentRef.instance.node = this.node;
    }
    updateIconTemplate() {
        this.iconSlot.clear();
        this.iconSlot.createEmbeddedView(this.node.iconTemplate, undefined, {
            injector: this.node.injector
        });
    }
}
NavigatorNodeComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.7", ngImport: i0, type: NavigatorNodeComponent, deps: [{ token: i1.Router }], target: i0.ɵɵFactoryTarget.Component });
NavigatorNodeComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.7", type: NavigatorNodeComponent, selector: "c8y-navigator-node", inputs: { node: "node", isRoot: "isRoot" }, outputs: { nodeClick: "nodeClick" }, viewQueries: [{ propertyName: "iconSlot", first: true, predicate: ["icon"], descendants: true, read: ViewContainerRef }, { propertyName: "confirm", first: true, predicate: PopoverConfirmComponent, descendants: true }], ngImport: i0, template: "<ng-container *ngIf=\"node.component\">\n  <ng-container *ngComponentOutlet=\"node.component; injector: node.injector\"></ng-container>\n</ng-container>\n\n<div\n  class=\"slot\"\n  *ngIf=\"!node.component\"\n  [hidden]=\"node.hidden\"\n  (dragstart)=\"node.dragStart($event)\"\n  (dragend)=\"node.dragEnd($event)\"\n  (drop)=\"node.drop($event)\"\n  [draggable]=\"node.draggable\"\n  [ngClass]=\"{ dragged: node.dragged, disabled: node.loading }\"\n>\n  <ng-container>\n    <div\n      class=\"link\"\n      tabindex=\"-1\"\n      [routerLink]=\"node.canNavigate ? node.path : undefined\"\n      [ngClass]=\"{ active: isActive$ | async }\"\n    >\n      <ng-container *ngTemplateOutlet=\"navicon\"></ng-container>\n      <button\n        class=\"btn-clean\"\n        title=\"{{ node.translateLabel ? (node.label | translate) : node.label }}\"\n        [attr.aria-expanded]=\"node.hasChildren ? node.open : null\"\n        type=\"button\"\n        draggable=\"false\"\n        (dragover)=\"node.canDrop && $event.preventDefault()\"\n        (dragenter)=\"node.canDrop && node.dragEnter($event)\"\n        (dragleave)=\"node.canDrop && node.dragLeave($event)\"\n        [attr.data-cy]=\"node.label\"\n        [attr.id]=\"isRoot ? node.id : undefined\"\n        (click)=\"click(node.canNavigate ? 'link' : 'expander', $event)\"\n        [ngClass]=\"{\n          'root-link': isRoot,\n          open: node.open && node.hasChildren,\n          parent: node.hasChildren,\n          'dragged-hover': node.draggedHover && !node.dragged\n        }\"\n      >\n        <ng-container *ngTemplateOutlet=\"inner\"></ng-container>\n      </button>\n    </div>\n  </ng-container>\n\n  <div\n    class=\"children panel-expand expand\"\n    *ngIf=\"node.children.length\"\n    [collapse]=\"!node.open\"\n    [isAnimated]=\"true\"\n  >\n    <c8y-navigator-node\n      *ngFor=\"let childNode of node.children\"\n      [node]=\"childNode\"\n      (nodeClick)=\"nodeClick.emit($event)\"\n    ></c8y-navigator-node>\n  </div>\n</div>\n\n<!-- icon -->\n<ng-template #navicon>\n  <!-- loader -->\n  <i\n    class=\"icon-spin loadingIndicator\"\n    [c8yIcon]=\"'circle-o-notch'\"\n    style=\"{{ isRoot ? 'padding-left: 16px;' : null }}\"\n    *ngIf=\"node.loading && !isRoot\"\n  ></i>\n  <ng-container #icon></ng-container>\n</ng-template>\n\n<ng-template #inner>\n  <!--title  -->\n  <span>{{ node.translateLabel ? (node.label | translate) : node.label }}</span>\n\n  <!--expander  -->\n  <i\n    class=\"expander\"\n    [c8yIcon]=\"'chevron-down'\"\n    [attr.aria-label]=\"expandTitle\"\n    role=\"button\"\n    *ngIf=\"node.hasChildren\"\n    (click)=\"click('expander', $event)\"\n    data-cy=\"c8y-navigator-node--expander\"\n  ></i>\n\n  <!--  Popover confirm  -->\n  <c8y-popover-confirm\n    triggers=\"focus\"\n    containerClass=\"navigator-popover\"\n  ></c8y-popover-confirm>\n</ng-template>\n", dependencies: [{ kind: "directive", type: i1.RouterLink, selector: "[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "directive", type: i2.CollapseDirective, selector: "[collapse]", inputs: ["display", "isAnimated", "collapse"], outputs: ["collapsed", "collapses", "expanded", "expands"], exportAs: ["bs-collapse"] }, { kind: "directive", type: i3.IconDirective, selector: "[c8yIcon]", inputs: ["c8yIcon"] }, { kind: "directive", type: i4.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i4.NgComponentOutlet, selector: "[ngComponentOutlet]", inputs: ["ngComponentOutlet", "ngComponentOutletInjector", "ngComponentOutletContent", "ngComponentOutletNgModule", "ngComponentOutletNgModuleFactory"] }, { kind: "directive", type: i4.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i4.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i4.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "component", type: i5.PopoverConfirmComponent, selector: "c8y-popover-confirm", inputs: ["buttons", "message", "title", "isOpen", "containerClass", "placement", "outsideClick"] }, { kind: "component", type: NavigatorNodeComponent, selector: "c8y-navigator-node", inputs: ["node", "isRoot"], outputs: ["nodeClick"] }, { kind: "pipe", type: i6.C8yTranslatePipe, name: "translate" }, { kind: "pipe", type: i4.AsyncPipe, name: "async" }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.7", ngImport: i0, type: NavigatorNodeComponent, decorators: [{
            type: Component,
            args: [{ selector: 'c8y-navigator-node', template: "<ng-container *ngIf=\"node.component\">\n  <ng-container *ngComponentOutlet=\"node.component; injector: node.injector\"></ng-container>\n</ng-container>\n\n<div\n  class=\"slot\"\n  *ngIf=\"!node.component\"\n  [hidden]=\"node.hidden\"\n  (dragstart)=\"node.dragStart($event)\"\n  (dragend)=\"node.dragEnd($event)\"\n  (drop)=\"node.drop($event)\"\n  [draggable]=\"node.draggable\"\n  [ngClass]=\"{ dragged: node.dragged, disabled: node.loading }\"\n>\n  <ng-container>\n    <div\n      class=\"link\"\n      tabindex=\"-1\"\n      [routerLink]=\"node.canNavigate ? node.path : undefined\"\n      [ngClass]=\"{ active: isActive$ | async }\"\n    >\n      <ng-container *ngTemplateOutlet=\"navicon\"></ng-container>\n      <button\n        class=\"btn-clean\"\n        title=\"{{ node.translateLabel ? (node.label | translate) : node.label }}\"\n        [attr.aria-expanded]=\"node.hasChildren ? node.open : null\"\n        type=\"button\"\n        draggable=\"false\"\n        (dragover)=\"node.canDrop && $event.preventDefault()\"\n        (dragenter)=\"node.canDrop && node.dragEnter($event)\"\n        (dragleave)=\"node.canDrop && node.dragLeave($event)\"\n        [attr.data-cy]=\"node.label\"\n        [attr.id]=\"isRoot ? node.id : undefined\"\n        (click)=\"click(node.canNavigate ? 'link' : 'expander', $event)\"\n        [ngClass]=\"{\n          'root-link': isRoot,\n          open: node.open && node.hasChildren,\n          parent: node.hasChildren,\n          'dragged-hover': node.draggedHover && !node.dragged\n        }\"\n      >\n        <ng-container *ngTemplateOutlet=\"inner\"></ng-container>\n      </button>\n    </div>\n  </ng-container>\n\n  <div\n    class=\"children panel-expand expand\"\n    *ngIf=\"node.children.length\"\n    [collapse]=\"!node.open\"\n    [isAnimated]=\"true\"\n  >\n    <c8y-navigator-node\n      *ngFor=\"let childNode of node.children\"\n      [node]=\"childNode\"\n      (nodeClick)=\"nodeClick.emit($event)\"\n    ></c8y-navigator-node>\n  </div>\n</div>\n\n<!-- icon -->\n<ng-template #navicon>\n  <!-- loader -->\n  <i\n    class=\"icon-spin loadingIndicator\"\n    [c8yIcon]=\"'circle-o-notch'\"\n    style=\"{{ isRoot ? 'padding-left: 16px;' : null }}\"\n    *ngIf=\"node.loading && !isRoot\"\n  ></i>\n  <ng-container #icon></ng-container>\n</ng-template>\n\n<ng-template #inner>\n  <!--title  -->\n  <span>{{ node.translateLabel ? (node.label | translate) : node.label }}</span>\n\n  <!--expander  -->\n  <i\n    class=\"expander\"\n    [c8yIcon]=\"'chevron-down'\"\n    [attr.aria-label]=\"expandTitle\"\n    role=\"button\"\n    *ngIf=\"node.hasChildren\"\n    (click)=\"click('expander', $event)\"\n    data-cy=\"c8y-navigator-node--expander\"\n  ></i>\n\n  <!--  Popover confirm  -->\n  <c8y-popover-confirm\n    triggers=\"focus\"\n    containerClass=\"navigator-popover\"\n  ></c8y-popover-confirm>\n</ng-template>\n" }]
        }], ctorParameters: function () { return [{ type: i1.Router }]; }, propDecorators: { iconSlot: [{
                type: ViewChild,
                args: ['icon', { read: ViewContainerRef, static: false }]
            }], node: [{
                type: Input
            }], isRoot: [{
                type: Input
            }], nodeClick: [{
                type: Output
            }], confirm: [{
                type: ViewChild,
                args: [PopoverConfirmComponent, { static: false }]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmF2aWdhdG9yLW5vZGUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vY29yZS9uYXZpZ2F0b3IvbmF2aWdhdG9yLW5vZGUuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vY29yZS9uYXZpZ2F0b3IvbmF2aWdhdG9yLW5vZGUuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsMkNBQTJDO0FBQzNDLE9BQU8sRUFDTCxTQUFTLEVBQ1QsWUFBWSxFQUNaLEtBQUssRUFFTCxNQUFNLEVBQ04sU0FBUyxFQUNULGdCQUFnQixFQUNqQixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ3hELE9BQU8sRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3hFLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLG9DQUFvQyxDQUFDO0FBQzdFLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ3BFLE9BQU8sRUFBZ0IsYUFBYSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDL0QsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLFdBQVcsQ0FBQzs7Ozs7Ozs7QUFReEM7O0dBRUc7QUFLSCxNQUFNLE9BQU8sc0JBQXNCO0lBNERqQyxZQUFvQixNQUFjO1FBQWQsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQTVDbEM7Ozs7Ozs7V0FPRztRQUNPLGNBQVMsR0FBeUIsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQVMvRDs7V0FFRztRQUNILGNBQVMsR0FBRyxJQUFJLE9BQU8sRUFBUSxDQUFDO1FBRWhDOztXQUVHO1FBQ0gsY0FBUyxHQUFHLEtBQUssQ0FDZixJ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bnRlbnQiOlsiLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aFxuaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBFdmVudEVtaXR0ZXIsXG4gIElucHV0LFxuICBPbkRlc3Ryb3ksXG4gIE91dHB1dCxcbiAgVmlld0NoaWxkLFxuICBWaWV3Q29udGFpbmVyUmVmXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQWN0aXZhdGlvbkVuZCwgUm91dGVyIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IFN1YmplY3QsIG1lcmdlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBkaXN0aW5jdFVudGlsQ2hhbmdlZCwgZmlsdGVyLCBtYXAsIHRhcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IFBvcG92ZXJDb25maXJtQ29tcG9uZW50IH0gZnJvbSAnLi4vbW9kYWwvcG9wb3Zlci1jb25maXJtLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBOYXZpZ2F0b3JJY29uQ29tcG9uZW50IH0gZnJvbSAnLi9uYXZpZ2F0b3ItaWNvbi5jb21wb25lbnQnO1xuaW1wb3J0IHsgQ2xpY2tPcHRpb25zLCBOYXZpZ2F0b3JOb2RlIH0gZnJvbSAnLi9uYXZpZ2F0b3Itbm9kZSc7XG5pbXBvcnQgeyBpc1VuZGVmaW5lZCB9IGZyb20gJ2xvZGFzaC1lcyc7XG5cbmV4cG9ydCBjb25zdCBlbnVtIENsaWNrRXZlbnRTb3VyY2Uge1xuICBJQ09OID0gJ2ljb24nLFxuICBFWFBBTkRFUiA9ICdleHBhbmRlcicsXG4gIExJTksgPSAnbGluaydcbn1cblxuLyoqXG4gKiBOYXZpZ2F0b3Igbm9kZSByZW5kZXJlci5cbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYzh5LW5hdmlnYXRvci1ub2RlJyxcbiAgdGVtcGxhdGVVcmw6ICcuL25hdmlnYXRvci1ub2RlLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBOYXZpZ2F0b3JOb2RlQ29tcG9uZW50IGltcGxlbWVudHMgT25EZXN0cm95IHtcbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIEBWaWV3Q2hpbGQoJ2ljb24nLCB7IHJlYWQ6IFZpZXdDb250YWluZXJSZWYsIHN0YXRpYzogZmFsc2UgfSkgaWNvblNsb3Q6IFZpZXdDb250YWluZXJSZWY7XG5cbiAgLyoqXG4gICAqIE5hdmlnYXRvciBub2RlLlxuICAgKi9cbiAgQElucHV0KCkgbm9kZTogTmF2aWdhdG9yTm9kZTtcblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBuYXZpZ2F0b3Igbm9kZSBpcyBhIHJvb3Qgbm9kZSAodG9wIG5vZGUgaW4gdGhlIGhpZXJhcmNoeSkuXG4gICAqL1xuICBASW5wdXQoKSBpc1Jvb3Q6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIEV2ZW50IGVtaXR0ZXIgcmVzcG9uc2libGUgZm9yIGJyb2FkY2FzdGluZyBvbmUgb2YgdGhlIGZvbGxvd2luZyBldmVudHM6IFwiaWNvblwiLCBcImV4cGFuZGVyXCIgb3IgXCJsaW5rXCIgYXMgc3RyaW5nIHZhbHVlLlxuICAgKlxuICAgKiBUaGUgdHlwZSBvZiBldmVudCBkZXBlbmRzIG9uIHdoZXJlIHlvdSBjbGljayBvbiB0aGUgbmF2aWdhdG9yIG5vZGU6XG4gICAqICogY2xpY2tpbmcgdGhlIGljb24gd2lsbCBicm9hZGNhc3QgdGhlIGV2ZW50IFwiaWNvblwiLFxuICAgKiAqIGNsaWNraW5nIHRoZSBleHBhbmRlciB3aWxsIGJyb2FkY2FzdCB0aGUgZXZlbnQgXCJleHBhbmRlclwiLFxuICAgKiAqIGNsaWNraW5nIHRoZSBsYWJlbCB3aWxsIGJyb2FkY2FzdCB0aGUgZXZlbnQgXCJsaW5rXCIuXG4gICAqL1xuICBAT3V0cHV0KCkgbm9kZUNsaWNrOiBFdmVudEVtaXR0ZXI8c3RyaW5nPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgQFZpZXdDaGlsZChQb3BvdmVyQ29uZmlybUNvbXBvbmVudCwgeyBzdGF0aWM6IGZhbHNlIH0pIGNvbmZpcm06IFBvcG92ZXJDb25maXJtQ29tcG9uZW50O1xuXG4gIHByaXZhdGUgdmlld0luaXRUaW1lb3V0O1xuXG4gIC8qKlxuICAgKiBBIHN1YmplY3QgdGhhdCBpcyB0cmlnZ2VyZWQgYXMgc29vbiBhcyB0aGUgbmF2aWdhdG9yIG5vZGUgaXMgaW5pdGlhbGl6ZWQuXG4gICAqL1xuICBub2RlSW5pdCQgPSBuZXcgU3ViamVjdDx2b2lkPigpO1xuXG4gIC8qKlxuICAgKiBBIG9ic2VydmFibGUgd2hpY2ggZW1pdHMsIGFzIHNvb24gYXMgdGhlIGFjdGl2ZSBzdGF0ZSBvZiB0aGUgbm9kZSBjaGFuZ2VzLlxuICAgKi9cbiAgaXNBY3RpdmUkID0gbWVyZ2UoXG4gICAgdGhpcy5ub2RlSW5pdCQsXG4gICAgdGhpcy5yb3V0ZXIuZXZlbnRzLnBpcGUoZmlsdGVyKGUgPT4gZSBpbnN0YW5jZW9mIEFjdGl2YXRpb25FbmQpKVxuICApLnBpcGUoXG4gICAgbWFwKCgpID0+IHtcbiAgICAgIGlmIChpc1VuZGVmaW5lZCh0aGlzLm5vZGUucGF0aCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMucm91dGVyLmlzQWN0aXZlKHRoaXMubm9kZS5wYXRoLCB0aGlzLm5vZGUucm91dGVyTGlua0V4YWN0KTtcbiAgICB9KSxcbiAgICBkaXN0aW5jdFVudGlsQ2hhbmdlZCgpLFxuICAgIHRhcChpc0FjdGl2ZSA9PiB7XG4gICAgICBpZiAoaXNBY3RpdmUpIHtcbiAgICAgICAgdGhpcy5leHBhbmRDb2xsYXBzZSh0cnVlKTtcbiAgICAgICAgdGhpcy5leHBhbmRSZWN1cnNpdmVQYXJlbnQodGhpcy5ub2RlLnBhcmVudHMpO1xuICAgICAgfVxuICAgIH0pXG4gICk7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSByb3V0ZXI6IFJvdXRlcikge31cblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIGlmICghdGhpcy5ub2RlLmNvbXBvbmVudCkge1xuICAgICAgdGhpcy52aWV3SW5pdFRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy51cGRhdGVJY29uKCk7XG4gICAgICAgIHRoaXMubm9kZS5jb25maXJtID0gdGhpcy5jb25maXJtO1xuICAgICAgICB0aGlzLm5vZGVJbml0JC5uZXh0KCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgZXhwYW5kZXIgdGl0bGUuXG4gICAqL1xuICBnZXQgZXhwYW5kVGl0bGUoKSB7XG4gICAgcmV0dXJuICF0aGlzLm5vZGUub3BlbiA/ICdFeHBhbmQnIDogJ0NvbGxhcHNlJztcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGljayBldmVudCBoYW5kbGVyLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZnJvbSBTb3VyY2Ugb2YgdGhlIGNsaWNrIGV2ZW50LlxuICAgKiBAcGFyYW0gZXZlbnQgRE9NIGV2ZW50LlxuICAgKi9cbiAgY2xpY2soZnJvbTogJ2ljb24nIHwgJ2V4cGFuZGVyJyB8ICdsaW5rJyA9ICdsaW5rJywgJGV2ZW50PzogTW91c2VFdmVudCkge1xuICAgIGxldCBvcGVuOiBib29sZWFuO1xuICAgIHN3aXRjaCAoZnJvbSkge1xuICAgICAgY2FzZSBDbGlja0V2ZW50U291cmNlLkVYUEFOREVSOlxuICAgICAgICBpZiAoJGV2ZW50KSB7XG4gICAgICAgICAgJGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIG9wZW4gPSAhdGhpcy5ub2RlLm9wZW47XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBDbGlja0V2ZW50U291cmNlLklDT046XG4gICAgICBjYXNlIENsaWNrRXZlbnRTb3VyY2UuTElOSzpcbiAgICAgICAgb3BlbiA9IHRoaXMucm91dGVyLmlzQWN0aXZlKHRoaXMubm9kZS5wYXRoLCB0aGlzLm5vZGUucm91dGVyTGlua0V4YWN0KVxuICAgICAgICAgID8gdHJ1ZVxuICAgICAgICAgIDogIXRoaXMubm9kZS5vcGVuO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgdGhpcy5oYW5kbGVFeHBhbmRDb2xsYXBzZShvcGVuLCBmcm9tLCAkZXZlbnQpO1xuICAgIHRoaXMubm9kZUNsaWNrLmVtaXQoZnJvbSk7XG4gIH1cblxuICAvKipcbiAgICogRXhwYW5kcyBvciBjb2xsYXBzZXMgdGhlIG5hdmlnYXRvciBub2RlIGFuZCBpdHMgY2hpbGRyZW4gcmVjdXJzaXZlbHkuXG4gICAqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gb3BlbiBPcGVuIG9yIGNsb3NlIHRoZSBub2RlLlxuICAgKiBAcGFyYW0ge0NsaWNrT3B0aW9uc30gZm9yTm9kZSBDbGljayBvcHRpb25zLlxuICAgKi9cbiAgZXhwYW5kQ29sbGFwc2Uob3BlbiwgZm9yTm9kZTogQ2xpY2tPcHRpb25zID0ge30pIHtcbiAgICB0aGlzLm5vZGUub3BlbiA9IG9wZW47XG4gICAgZm9yTm9kZS5vcGVuID0gb3BlbjtcbiAgICB0aGlzLm5vZGUuY2xpY2soZm9yTm9kZSk7XG4gIH1cblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMudmlld0luaXRUaW1lb3V0KTtcblxuICAgIGlmICh0aGlzLm5vZGUpIHtcbiAgICAgIHRoaXMubm9kZS5kZXN0cm95KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV4cGFuZHMgdGhlIHBhcmVudCBub2RlcyByZWN1cnNpdmVseS5cbiAgICogQHBhcmFtIG5vZGVzIFRoZSBub2RlcyB0aGF0IHNob3VsZCBiZSB0cmllZCB0byBnZXQgb3BlbmVkLlxuICAgKiBAcGFyYW0gY2xpY2tPcHRpb24gVGhlIGNsaWNrIG9wdGlvbnMgdG8gcGVyZm9ybSBvbiB0aGUgcGFyZW50IG5vZGVzLlxuICAgKi9cbiAgZXhwYW5kUmVjdXJzaXZlUGFyZW50KG5vZGVzOiBOYXZpZ2F0b3JOb2RlW10sIGNsaWNrT3B0aW9uOiBDbGlja09wdGlvbnMgPSB7IGV4cGFuZGVyOiB0cnVlIH0pIHtcbiAgICBub2Rlcy5mb3JFYWNoKHBhcmVudE5vZGUgPT4ge1xuICAgICAgaWYgKCFwYXJlbnROb2RlLm9wZW4pIHtcbiAgICAgICAgcGFyZW50Tm9kZS5vcGVuID0gdHJ1ZTtcbiAgICAgICAgcGFyZW50Tm9kZS5jbGljayhjbGlja09wdGlvbik7XG4gICAgICB9XG4gICAgICB0aGlzLmV4cGFuZFJlY3Vyc2l2ZVBhcmVudChwYXJlbnROb2RlLnBhcmVudHMsIGNsaWNrT3B0aW9uKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlRXhwYW5kQ29sbGFwc2Uob3BlbiwgZnJvbSwgJGV2ZW50KSB7XG4gICAgaWYgKFxuICAgICAgb3BlbiA9PT0gdGhpcy5ub2RlLm9wZW4gfHxcbiAgICAgICh0aGlzLm5vZGUucGF0aCAmJiAhb3BlbiAmJiBmcm9tICE9PSBDbGlja0V2ZW50U291cmNlLkVYUEFOREVSKVxuICAgICkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmV4cGFuZENvbGxhcHNlKG9wZW4sIHsgW2Zyb21dOiB0cnVlLCAkZXZlbnQgfSk7XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZUljb24oKSB7XG4gICAgaWYgKHRoaXMubm9kZS5pY29uVGVtcGxhdGUpIHtcbiAgICAgIHRoaXMudXBkYXRlSWNvblRlbXBsYXRlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudXBkYXRlSWNvbkNvbXBvbmVudCgpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlSWNvbkNvbXBvbmVudCgpIHtcbiAgICBsZXQgY29tcG9uZW50VHlwZSA9IE5hdmlnYXRvckljb25Db21wb25lbnQ7XG4gICAgaWYgKHRoaXMubm9kZSAmJiB0aGlzLm5vZGUuaWNvbkNvbXBvbmVudCkge1xuICAgICAgY29tcG9uZW50VHlwZSA9IHRoaXMubm9kZS5pY29uQ29tcG9uZW50O1xuICAgIH1cbiAgICB0aGlzLmljb25TbG90LmNsZWFyKCk7XG4gICAgY29uc3QgY29tcG9uZW50UmVmID0gdGhpcy5pY29uU2xvdC5jcmVhdGVDb21wb25lbnQoY29tcG9uZW50VHlwZSwge1xuICAgICAgaW5qZWN0b3I6IHRoaXMubm9kZS5pbmplY3RvclxuICAgIH0pO1xuICAgIGNvbXBvbmVudFJlZi5pbnN0YW5jZS5ub2RlID0gdGhpcy5ub2RlO1xuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVJY29uVGVtcGxhdGUoKSB7XG4gICAgdGhpcy5pY29uU2xvdC5jbGVhcigpO1xuICAgIHRoaXMuaWNvblNsb3QuY3JlYXRlRW1iZWRkZWRWaWV3KHRoaXMubm9kZS5pY29uVGVtcGxhdGUsIHVuZGVmaW5lZCwge1xuICAgICAgaW5qZWN0b3I6IHRoaXMubm9kZS5pbmplY3RvclxuICAgIH0pO1xuICB9XG59XG4iLCI8bmctY29udGFpbmVyICpuZ0lmPVwibm9kZS5jb21wb25lbnRcIj5cbiAgPG5nLWNvbnRhaW5lciAqbmdDb21wb25lbnRPdXRsZXQ9XCJub2RlLmNvbXBvbmVudDsgaW5qZWN0b3I6IG5vZGUuaW5qZWN0b3JcIj48L25nLWNvbnRhaW5lcj5cbjwvbmctY29udGFpbmVyPlxuXG48ZGl2XG4gIGNsYXNzPVwic2xvdFwiXG4gICpuZ0lmPVwiIW5vZGUuY29tcG9uZW50XCJcbiAgW2hpZGRlbl09XCJub2RlLmhpZGRlblwiXG4gIChkcmFnc3RhcnQpPVwibm9kZS5kcmFnU3RhcnQoJGV2ZW50KVwiXG4gIChkcmFnZW5kKT1cIm5vZGUuZHJhZ0VuZCgkZXZlbnQpXCJcbiAgKGRyb3ApPVwibm9kZS5kcm9wKCRldmVudClcIlxuICBbZHJhZ2dhYmxlXT1cIm5vZGUuZHJhZ2dhYmxlXCJcbiAgW25nQ2xhc3NdPVwieyBkcmFnZ2VkOiBub2RlLmRyYWdnZWQsIGRpc2FibGVkOiBub2RlLmxvYWRpbmcgfVwiXG4+XG4gIDxuZy1jb250YWluZXI+XG4gICAgPGRpdlxuICAgICAgY2xhc3M9XCJsaW5rXCJcbiAgICAgIHRhYmluZGV4PVwiLTFcIlxuICAgICAgW3JvdXRlckxpbmtdPVwibm9kZS5jYW5OYXZpZ2F0ZSA/IG5vZGUucGF0aCA6IHVuZGVmaW5lZFwiXG4gICAgICBbbmdDbGFzc109XCJ7IGFjdGl2ZTogaXNBY3RpdmUkIHwgYXN5bmMgfVwiXG4gICAgPlxuICAgICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cIm5hdmljb25cIj48L25nLWNvbnRhaW5lcj5cbiAgICAgIDxidXR0b25cbiAgICAgICAgY2xhc3M9XCJidG4tY2xlYW5cIlxuICAgICAgICB0aXRsZT1cInt7IG5vZGUudHJhbnNsYXRlTGFiZWwgPyAobm9kZS5sYWJlbCB8IHRyYW5zbGF0ZSkgOiBub2RlLmxhYmVsIH19XCJcbiAgICAgICAgW2F0dHIuYXJpYS1leHBhbmRlZF09XCJub2RlLmhhc0NoaWxkcmVuID8gbm9kZS5vcGVuIDogbnVsbFwiXG4gICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICBkcmFnZ2FibGU9XCJmYWxzZVwiXG4gICAgICAgIChkcmFnb3Zlcik9XCJub2RlLmNhbkRyb3AgJiYgJGV2ZW50LnByZXZlbnREZWZhdWx0KClcIlxuICAgICAgICAoZHJhZ2VudGVyKT1cIm5vZGUuY2FuRHJvcCAmJiBub2RlLmRyYWdFbnRlcigkZXZlbnQpXCJcbiAgICAgICAgKGRyYWdsZWF2ZSk9XCJub2RlLmNhbkRyb3AgJiYgbm9kZS5kcmFnTGVhdmUoJGV2ZW50KVwiXG4gICAgICAgIFthdHRyLmRhdGEtY3ldPVwibm9kZS5sYWJlbFwiXG4gICAgICAgIFthdHRyLmlkXT1cImlzUm9vdCA/IG5vZGUuaWQgOiB1bmRlZmluZWRcIlxuICAgICAgICAoY2xpY2spPVwiY2xpY2sobm9kZS5jYW5OYXZpZ2F0ZSA/ICdsaW5rJyA6ICdleHBhbmRlcicsICRldmVudClcIlxuICAgICAgICBbbmdDbGFzc109XCJ7XG4gICAgICAgICAgJ3Jvb3QtbGluayc6IGlzUm9vdCxcbiAgICAgICAgICBvcGVuOiBub2RlLm9wZW4gJiYgbm9kZS5oYXNDaGlsZHJlbixcbiAgICAgICAgICBwYXJlbnQ6IG5vZGUuaGFzQ2hpbGRyZW4sXG4gICAgICAgICAgJ2RyYWdnZWQtaG92ZXInOiBub2RlLmRyYWdnZWRIb3ZlciAmJiAhbm9kZS5kcmFnZ2VkXG4gICAgICAgIH1cIlxuICAgICAgPlxuICAgICAgICA8bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwiaW5uZXJcIj48L25nLWNvbnRhaW5lcj5cbiAgICAgIDwvYnV0dG9uPlxuICAgIDwvZGl2PlxuICA8L25nLWNvbnRhaW5lcj5cblxuICA8ZGl2XG4gICAgY2xhc3M9XCJjaGlsZHJlbiBwYW5lbC1leHBhbmQgZXhwYW5kXCJcbiAgICAqbmdJZj1cIm5vZGUuY2hpbGRyZW4ubGVuZ3RoXCJcbiAgICBbY29sbGFwc2VdPVwiIW5vZGUub3BlblwiXG4gICAgW2lzQW5pbWF0ZWRdPVwidHJ1ZVwiXG4gID5cbiAgICA8Yzh5LW5hdmlnYXRvci1ub2RlXG4gICAgICAqbmdGb3I9XCJsZXQgY2hpbGROb2RlIG9mIG5vZGUuY2hpbGRyZW5cIlxuICAgICAgW25vZGVdPVwiY2hpbGROb2RlXCJcbiAgICAgIChub2RlQ2xpY2spPVwibm9kZUNsaWNrLmVtaXQoJGV2ZW50KVwiXG4gICAgPjwvYzh5LW5hdmlnYXRvci1ub2RlPlxuICA8L2Rpdj5cbjwvZGl2PlxuXG48IS0tIGljb24gLS0+XG48bmctdGVtcGxhdGUgI25hdmljb24+XG4gIDwhLS0gbG9hZGVyIC0tPlxuICA8aVxuICAgIGNsYXNzPVwiaWNvbi1zcGluIGxvYWRpbmdJbmRpY2F0b3JcIlxuICAgIFtjOHlJY29uXT1cIidjaXJjbGUtby1ub3RjaCdcIlxuICAgIHN0eWxlPVwie3sgaXNSb290ID8gJ3BhZGRpbmctbGVmdDogMTZweDsnIDogbnVsbCB9fVwiXG4gICAgKm5nSWY9XCJub2RlLmxvYWRpbmcgJiYgIWlzUm9vdFwiXG4gID48L2k+XG4gIDxuZy1jb250YWluZXIgI2ljb24+PC9uZy1jb250YWluZXI+XG48L25nLXRlbXBsYXRlPlxuXG48bmctdGVtcGxhdGUgI2lubmVyPlxuICA8IS0tdGl0bGUgIC0tPlxuICA8c3Bhbj57eyBub2RlLnRyYW5zbGF0ZUxhYmVsID8gKG5vZGUubGFiZWwgfCB0cmFuc2xhdGUpIDogbm9kZS5sYWJlbCB9fTwvc3Bhbj5cblxuICA8IS0tZXhwYW5kZXIgIC0tPlxuICA8aVxuICAgIGNsYXNzPVwiZXhwYW5kZXJcIlxuICAgIFtjOHlJY29uXT1cIidjaGV2cm9uLWRvd24nXCJcbiAgICBbYXR0ci5hcmlhLWxhYmVsXT1cImV4cGFuZFRpdGxlXCJcbiAgICByb2xlPVwiYnV0dG9uXCJcbiAgICAqbmdJZj1cIm5vZGUuaGFzQ2hpbGRyZW5cIlxuICAgIChjbGljayk9XCJjbGljaygnZXhwYW5kZXInLCAkZXZlbnQpXCJcbiAgICBkYXRhLWN5PVwiYzh5LW5hdmlnYXRvci1ub2RlLS1leHBhbmRlclwiXG4gID48L2k+XG5cbiAgPCEtLSAgUG9wb3ZlciBjb25maXJtICAtLT5cbiAgPGM4eS1wb3BvdmVyLWNvbmZpcm1cbiAgICB0cmlnZ2Vycz1cImZvY3VzXCJcbiAgICBjb250YWluZXJDbGFzcz1cIm5hdmlnYXRvci1wb3BvdmVyXCJcbiAgPjwvYzh5LXBvcG92ZXItY29uZmlybT5cbjwvbmctdGVtcGxhdGU+XG4iXX0=
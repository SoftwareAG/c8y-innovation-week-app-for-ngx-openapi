import { retryWhen, scan, tap, delay } from 'rxjs/operators';
export function retryWithDelay(delayTime, count = 1) {
    return input => input.pipe(retryWhen(errors => errors.pipe(scan((acc, error) => ({ count: acc.count + 1, error }), {
        count: 0,
        error: undefined
    }), tap(current => {
        if (current.count > count) {
            throw current.error;
        }
    }), delay(delayTime))));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmV0cnktd2l0aC1kZWxheS5vcGVyYXRvci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL2NvcmUvY29tbW9uL3JldHJ5LXdpdGgtZGVsYXkub3BlcmF0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRTdELE1BQU0sVUFBVSxjQUFjLENBQUksU0FBaUIsRUFBRSxLQUFLLEdBQUcsQ0FBQztJQUM1RCxPQUFPLEtBQUssQ0FBQyxFQUFFLENBQ2IsS0FBSyxDQUFDLElBQUksQ0FDUixTQUFTLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FDakIsTUFBTSxDQUFDLElBQUksQ0FDVCxJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLEdBQUcsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUU7UUFDdEQsS0FBSyxFQUFFLENBQUM7UUFDUixLQUFLLEVBQUUsU0FBZ0I7S0FDeEIsQ0FBQyxFQUNGLEdBQUcsQ0FBQyxPQUFPLENBQUMsRUFBRTtRQUNaLElBQUksT0FBTyxDQUFDLEtBQUssR0FBRyxLQUFLLEVBQUU7WUFDekIsTUFBTSxPQUFPLENBQUMsS0FBSyxDQUFDO1NBQ3JCO0lBQ0gsQ0FBQyxDQUFDLEVBQ0YsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUNqQixDQUNGLENBQ0YsQ0FBQztBQUNOLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNb25vVHlwZU9wZXJhdG9yRnVuY3Rpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IHJldHJ5V2hlbiwgc2NhbiwgdGFwLCBkZWxheSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuZXhwb3J0IGZ1bmN0aW9uIHJldHJ5V2l0aERlbGF5PFQ+KGRlbGF5VGltZTogbnVtYmVyLCBjb3VudCA9IDEpOiBNb25vVHlwZU9wZXJhdG9yRnVuY3Rpb248VD4ge1xuICByZXR1cm4gaW5wdXQgPT5cbiAgICBpbnB1dC5waXBlKFxuICAgICAgcmV0cnlXaGVuKGVycm9ycyA9PlxuICAgICAgICBlcnJvcnMucGlwZShcbiAgICAgICAgICBzY2FuKChhY2MsIGVycm9yKSA9PiAoeyBjb3VudDogYWNjLmNvdW50ICsgMSwgZXJyb3IgfSksIHtcbiAgICAgICAgICAgIGNvdW50OiAwLFxuICAgICAgICAgICAgZXJyb3I6IHVuZGVmaW5lZCBhcyBhbnlcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB0YXAoY3VycmVudCA9PiB7XG4gICAgICAgICAgICBpZiAoY3VycmVudC5jb3VudCA+IGNvdW50KSB7XG4gICAgICAgICAgICAgIHRocm93IGN1cnJlbnQuZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSksXG4gICAgICAgICAgZGVsYXkoZGVsYXlUaW1lKVxuICAgICAgICApXG4gICAgICApXG4gICAgKTtcbn1cbiJdfQ==
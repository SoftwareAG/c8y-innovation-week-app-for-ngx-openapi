import { DEFAULT_CONFIG } from '../cockpit-config.model';
export class CockpitSetupStep {
    constructor(stepper, step, setup, appState, alert) {
        this.stepper = stepper;
        this.step = step;
        this.setup = setup;
        this.appState = appState;
        this.alert = alert;
        this.config = DEFAULT_CONFIG;
        this.pending = false;
    }
    async next() {
        this.pending = true;
        try {
            const newConfig = { ...this.setup.data$.value, ...this.config };
            await this.appState.updateCurrentApplicationConfig(newConfig);
            this.setup.stepCompleted(this.stepper.selectedIndex);
            this.setup.data$.next(newConfig);
            this.stepper.next();
        }
        catch (ex) {
            this.alert.addServerFailure(ex);
        }
        finally {
            this.pending = false;
        }
    }
    back() {
        this.stepper.previous();
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29ja3BpdC1zZXR1cC1zdGVwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vY29ja3BpdC1jb25maWcvc2V0dXAvY29ja3BpdC1zZXR1cC1zdGVwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sRUFBaUIsY0FBYyxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFFeEUsTUFBTSxPQUFnQixnQkFBZ0I7SUFJcEMsWUFDUyxPQUFtQixFQUNoQixJQUFhLEVBQ2IsS0FBcUIsRUFDckIsUUFBeUIsRUFDekIsS0FBbUI7UUFKdEIsWUFBTyxHQUFQLE9BQU8sQ0FBWTtRQUNoQixTQUFJLEdBQUosSUFBSSxDQUFTO1FBQ2IsVUFBSyxHQUFMLEtBQUssQ0FBZ0I7UUFDckIsYUFBUSxHQUFSLFFBQVEsQ0FBaUI7UUFDekIsVUFBSyxHQUFMLEtBQUssQ0FBYztRQVIvQixXQUFNLEdBQWtCLGNBQWMsQ0FBQztRQUN2QyxZQUFPLEdBQUcsS0FBSyxDQUFDO0lBUWIsQ0FBQztJQUVKLEtBQUssQ0FBQyxJQUFJO1FBQ1IsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7UUFDcEIsSUFBSTtZQUNGLE1BQU0sU0FBUyxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDaEUsTUFBTSxJQUFJLENBQUMsUUFBUSxDQUFDLDhCQUE4QixDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQzlELElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDckQsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ2pDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUM7U0FDckI7UUFBQyxPQUFPLEVBQUUsRUFBRTtZQUNYLElBQUksQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDakM7Z0JBQVM7WUFDUixJQUFJLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztTQUN0QjtJQUNILENBQUM7SUFFRCxJQUFJO1FBQ0YsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUMxQixDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDZGtTdGVwIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL3N0ZXBwZXInO1xuaW1wb3J0IHsgQXBwU3RhdGVTZXJ2aWNlLCBBbGVydFNlcnZpY2UsIEM4eVN0ZXBwZXIsIFNldHVwQ29tcG9uZW50IH0gZnJvbSAnQGM4eS9uZ3gtY29tcG9uZW50cyc7XG5pbXBvcnQgeyBDb2NrcGl0Q29uZmlnLCBERUZBVUxUX0NPTkZJRyB9IGZyb20gJy4uL2NvY2twaXQtY29uZmlnLm1vZGVsJztcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIENvY2twaXRTZXR1cFN0ZXAge1xuICBjb25maWc6IENvY2twaXRDb25maWcgPSBERUZBVUxUX0NPTkZJRztcbiAgcGVuZGluZyA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyBzdGVwcGVyOiBDOHlTdGVwcGVyLFxuICAgIHByb3RlY3RlZCBzdGVwOiBDZGtTdGVwLFxuICAgIHByb3RlY3RlZCBzZXR1cDogU2V0dXBDb21wb25lbnQsXG4gICAgcHJvdGVjdGVkIGFwcFN0YXRlOiBBcHBTdGF0ZVNlcnZpY2UsXG4gICAgcHJvdGVjdGVkIGFsZXJ0OiBBbGVydFNlcnZpY2VcbiAgKSB7fVxuXG4gIGFzeW5jIG5leHQoKSB7XG4gICAgdGhpcy5wZW5kaW5nID0gdHJ1ZTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbmV3Q29uZmlnID0geyAuLi50aGlzLnNldHVwLmRhdGEkLnZhbHVlLCAuLi50aGlzLmNvbmZpZyB9O1xuICAgICAgYXdhaXQgdGhpcy5hcHBTdGF0ZS51cGRhdGVDdXJyZW50QXBwbGljYXRpb25Db25maWcobmV3Q29uZmlnKTtcbiAgICAgIHRoaXMuc2V0dXAuc3RlcENvbXBsZXRlZCh0aGlzLnN0ZXBwZXIuc2VsZWN0ZWRJbmRleCk7XG4gICAgICB0aGlzLnNldHVwLmRhdGEkLm5leHQobmV3Q29uZmlnKTtcbiAgICAgIHRoaXMuc3RlcHBlci5uZXh0KCk7XG4gICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgIHRoaXMuYWxlcnQuYWRkU2VydmVyRmFpbHVyZShleCk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMucGVuZGluZyA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGJhY2soKSB7XG4gICAgdGhpcy5zdGVwcGVyLnByZXZpb3VzKCk7XG4gIH1cbn1cbiJdfQ==